"use strict";(self.webpackChunkFLEET=self.webpackChunkFLEET||[]).push([[3196],{50014:(e,t,s)=>{s.d(t,{A:()=>d});var i=s(65043),n=s(70579);const a=function(e){const{onClick:t,data:s,isActive:i}=e,{title:a,icon:d}=s;return(0,n.jsx)("div",{onClick:t,className:"card same-card mx-2 bg-white col-xl-2 col-lg-4 cold-md-4 col-sm-6 ".concat(i?"active-tab":""),style:{height:"160px",width:"160px",border:i?"1px solid #4C9AFF":"1px solid #E6E6E6"},children:(0,n.jsx)("div",{className:"card-body d-flex align-items-center",children:(0,n.jsxs)("div",{className:"d-flex flex-column align-items-center w-100 pb-2",children:[d&&(0,n.jsx)("span",{className:"card-text text-primary fs-1 mb-2",children:d}),(0,n.jsx)("h6",{className:"card-text text-primary text-center fs-4",children:a})]})})})};const d=function(e){const{tabs:t=[]}=e,[s,d]=(0,i.useState)(t[0]);return(0,n.jsxs)("div",{className:"container-fluid",children:[(0,n.jsx)("div",{className:"tabs row w-100",children:t.map(((e,t)=>(0,n.jsx)(a,{data:e,isActive:s===e,onClick:()=>{d(e)}},t)))}),s&&(0,n.jsx)("div",{children:s.component})]})}},3196:(e,t,s)=>{s.r(t),s.d(t,{default:()=>v});var i=s(65043),n=s(9866),a=s(50014),d=s(60184),r=s(38628),o=s(64196),l=s(2364),c=s(35514);s(33723),s(53536);var m=s(73216),u=s(74117),p=(s(23764),s(42457)),h=s(70579);const x=e=>{let{isEditTrue:t,setIsEditTrue:s}=e;const{t:n}=(0,u.Bd)(),[a,d]=(0,i.useState)([]),[x,v]=(0,i.useState)([]),[f,g]=(0,i.useState)([]),y=(0,m.Zp)(),{id:j}=(0,m.g)(),[b,k]=(0,i.useState)({name:"",permission:{}}),[w,N]=(0,i.useState)([]),[A,E]=(0,i.useState)(null),T=(e,t,s)=>{let i=[...f];const n={...i.find((e=>e._id===s)).permission};n[t]=!!e;const a=i.findIndex((e=>e._id===s));i[a].permission=n,g(i)},C=(e,t,s,i)=>{const n=f.map((n=>{if(n._id===s){const s=n.subModules.map((s=>{if(s.id===i){const i={...s.permission};return i[t]=e,{...s,permission:i}}return s}));return{...n,subModules:s}}return n}));g(n)},[_,D]=(0,i.useState)(!1);(0,i.useEffect)((()=>{if(-1!==t){const e=a.filter(((e,s)=>s===t));k({name:e.name,permission:e.permission}),console.log(e)}}),[]),(0,i.useEffect)((()=>{(async()=>{try{const e=await c.A.listModule(),t={add:!1,view:!1,modify:!1,delete:!1},s=[...e.data].map((e=>{const s=[...e.subModules].map((e=>({...e,permission:t})));return{...e,permission:t,subModules:s}}));g(s),console.log({newData:s})}catch(e){console.error("Error fetching template data:",e)}})()}),[]);const[M,F]=(0,i.useState)(),S=a.map((e=>e.name));console.log("this is group data state ",S);return(0,i.useEffect)((()=>{(async()=>{try{const e=await c.A.getTemplates();if(j){const t=await c.A.listModule(),s=e.data.data.find((e=>e._id===j));k(s),F(s.name);const i=t.data.map((e=>{const t=s.permission.find((t=>t.moduleId===e._id));return t&&(e.permission={add:null===t||void 0===t?void 0:t.add,view:null===t||void 0===t?void 0:t.view,modify:null===t||void 0===t?void 0:t.modify,delete:null===t||void 0===t?void 0:t.delete}),e}));g(i),v(s.permission.filter((e=>!(!e.delete&&!e.view&&!e.modify&&!e.add))).map((e=>e.moduleId)))}d(e.data.data),N(e.data.data.map((e=>({value:e._id,label:e.name}))))}catch(e){console.error("Error fetching template data:",e)}})()}),[]),console.log("is error : ",_),(0,h.jsx)("div",{children:(0,h.jsxs)(r.A,{children:[(0,h.jsx)(r.A.Header,{children:(0,h.jsx)(r.A.Title,{children:n("permission")})}),(0,h.jsxs)("div",{className:"d-flex justify-content-between m-2 mt-4 p-3 mb-0 pb-0",children:[(0,h.jsx)("div",{children:(0,h.jsx)("input",{value:b.name,name:"groupname",type:"text",className:"p-2",onChange:e=>(e=>{D(!1);const{value:t}=e.target;k((e=>({...e,name:t})))})(e),style:{marginRight:"1rem",border:"#D3D3D3 1px solid",borderRadius:"0.3rem",width:"15rem"},placeholder:n("featureTemplateName")})}),(0,h.jsxs)("div",{className:"d-flex justify-content-center",style:{width:"25rem"},children:[(0,h.jsx)(l.Ay,{options:w,placeholder:n("selectFeatureTemplate"),styles:{control:e=>({...e,width:"18rem"})},onChange:e=>{const t=a.find((t=>t._id===e.value));E(t)},children:" "})," ",(0,h.jsx)("button",{className:"btn btn-primary",style:{marginLeft:"1rem",padding:"7px 16px",marginRight:"1rem"},onClick:()=>{if(!A)return;const e=f.map((e=>{const t=A.permission.find((t=>t.moduleId===e._id));return t&&(e.permission={add:null===t||void 0===t?void 0:t.add,view:null===t||void 0===t?void 0:t.view,modify:null===t||void 0===t?void 0:t.modify,delete:null===t||void 0===t?void 0:t.delete}),e}));g(e),v(e.filter((e=>{var t,s,i,n;return!((null===(t=e.permission)||void 0===t||!t.delete)&&(null===(s=e.permission)||void 0===s||!s.view)&&(null===(i=e.permission)||void 0===i||!i.modify)&&(null===(n=e.permission)||void 0===n||!n.add))})).map((e=>e._id))),console.log("Data copied successfully")},children:n("copy")})]})]}),(0,h.jsx)("div",{className:"ms-4 pt-0 mt-0",children:_&&(0,h.jsx)("span",{className:"text-danger text-sm pt-0 mt-0",style:{marginBottom:"1rem"},children:"feature template name is required"})}),(0,h.jsxs)(r.A.Body,{className:"d-flex",children:[(0,h.jsx)("div",{style:{flex:.4,maxHeight:"50vh",overflow:"auto",border:"1px solid #D3D3D3  ",borderRadius:"0.5rem"},children:(0,h.jsxs)(o.A,{children:[(0,h.jsx)("thead",{style:{position:"sticky",top:0,background:"white"},children:(0,h.jsx)("tr",{children:(0,h.jsx)("th",{scope:"col",children:n("module")})})}),(0,h.jsx)("tbody",{children:f.map(((e,t)=>e&&e.title?(0,h.jsx)(i.Fragment,{children:(0,h.jsx)("tr",{children:(0,h.jsxs)("td",{children:[(0,h.jsx)("input",{type:"checkbox",className:"form-check-input",style:{marginRight:"0.2rem"},name:"create",checked:x.includes(e._id),onChange:t=>((e,t)=>{v(e?e=>[...e,t]:e=>e.filter((e=>e!==t)))})(t.target.checked,e._id)}),(0,h.jsx)("span",{style:{marginRight:"1.7rem"},children:n(e.title)})]})})},e._id):null))})]})}),(0,h.jsx)("div",{style:{flex:1,maxHeight:"50vh",overflow:"auto",border:"1px solid #D3D3D3",borderRadius:"0.5rem",marginLeft:"0.2rem"},children:(0,h.jsxs)(o.A,{children:[(0,h.jsx)("thead",{id:"feature_template",style:{position:"sticky",top:0,background:"white"},children:(0,h.jsxs)("tr",{children:[(0,h.jsx)("th",{scope:"col",className:"col-4",style:{width:"150px"},children:n("subModules")}),(0,h.jsx)("th",{scope:"col",children:n("add")}),(0,h.jsx)("th",{scope:"col",children:n("view")}),(0,h.jsx)("th",{scope:"col",children:n("modify")}),(0,h.jsx)("th",{scope:"col",children:n("delete")})]})}),(0,h.jsx)("tbody",{className:"feature_template_table",children:x.length>0&&x.map(((e,t)=>{var s,n,a,d;const r=f.find((t=>t._id===e));return r?(0,h.jsxs)(i.Fragment,{children:[(0,h.jsxs)("tr",{children:[(0,h.jsxs)("td",{className:"col-2",style:{width:"130px"},children:[" ",r.title]}),(0,h.jsx)("td",{children:(0,h.jsx)("input",{type:"checkbox",checked:null===(s=r.permission)||void 0===s?void 0:s.add,onChange:t=>T(t.target.checked,t.target.name,e),className:"form-check-input",name:"add"})}),(0,h.jsx)("td",{children:(0,h.jsx)("input",{type:"checkbox",checked:null===(n=r.permission)||void 0===n?void 0:n.view,className:"form-check-input",onChange:t=>T(t.target.checked,t.target.name,e),name:"view"})}),(0,h.jsx)("td",{children:(0,h.jsx)("input",{type:"checkbox",checked:null===(a=r.permission)||void 0===a?void 0:a.modify,className:"form-check-input",onChange:t=>T(t.target.checked,t.target.name,e),name:"modify"})}),(0,h.jsx)("td",{children:(0,h.jsx)("input",{type:"checkbox",checked:null===(d=r.permission)||void 0===d?void 0:d.delete,className:"form-check-input",onChange:t=>T(t.target.checked,t.target.name,e),name:"delete"})})]}),r.subModules.map(((t,s)=>{var i,n,a,d;return(0,h.jsxs)("tr",{children:[(0,h.jsxs)("td",{className:"col-2",children:[" ",t.title]}),(0,h.jsx)("td",{children:(0,h.jsx)("input",{type:"checkbox",checked:null===(i=t.permission)||void 0===i?void 0:i.add,onChange:t=>C(t.target.checked,t.target.name,e,s),className:"form-check-input",name:"add"})}),(0,h.jsx)("td",{children:(0,h.jsx)("input",{type:"checkbox",checked:null===(n=t.permission)||void 0===n?void 0:n.view,onChange:t=>C(t.target.checked,t.target.name,e,s),className:"form-check-input",name:"view"})}),(0,h.jsx)("td",{children:(0,h.jsx)("input",{type:"checkbox",checked:null===(a=t.permission)||void 0===a?void 0:a.modify,onChange:t=>C(t.target.checked,t.target.name,e,s),className:"form-check-input",name:"modify"})}),(0,h.jsx)("td",{children:(0,h.jsx)("input",{type:"checkbox",checked:null===(d=t.permission)||void 0===d?void 0:d.delete,onChange:t=>C(t.target.checked,t.target.name,e,s),className:"form-check-input",name:"delete"})})]},s)}))]},t):null}))})]})})]}),(0,h.jsx)("div",{className:"d-flex justify-content-end  p-3",children:(0,h.jsxs)("button",{className:"btn btn-primary",style:{marginLeft:"1rem",padding:"7px 16px"},onClick:async()=>{if(b.name){if(j){if(S.includes(b.name)&&b.name!==M)return void(0,p.U)("Feature Template name already exists")}else if(S.includes(b.name))return void(0,p.U)("Feature Template name already exists");try{D(!1),console.log(f,"data-;;");const e=f.reduce(((e,t)=>{var s,i,n,a;const d={moduleId:t._id,add:null===(s=t.permission)||void 0===s?void 0:s.add,view:null===(i=t.permission)||void 0===i?void 0:i.view,modify:null===(n=t.permission)||void 0===n?void 0:n.modify,delete:null===(a=t.permission)||void 0===a?void 0:a.delete};return e.push(d),t.subModules&&t.subModules.length>0&&!j&&t.subModules.forEach((t=>{var s,i,n,a;const d={moduleId:t.id,add:null===(s=t.permission)||void 0===s?void 0:s.add,view:null===(i=t.permission)||void 0===i?void 0:i.view,modify:null===(n=t.permission)||void 0===n?void 0:n.modify,delete:null===(a=t.permission)||void 0===a?void 0:a.delete};e.push(d)})),e}),[]),t={...b,permission:e};k((t=>({...t,permission:e})));const s=j?c.A.udpateTemplate:c.A.createTemplate;await s(t),v([]),console.log("Data saved successfully"),(0,p.V)("saved"),y("/groups")}catch(e){console.error("Error saving data:",e)}}else D(!0)},children:[" ",j?"Update":"Save"," "]})})]})})},v=()=>{const{t:e}=(0,u.Bd)(),t=(0,m.zy)(),{isEditTrue:s,setIsEditTrue:i}=JSON.parse(t.state);console.log(s,i);const r=[{title:"Permission",component:(0,h.jsx)(x,{isEditTrue:s,setIsEditTrue:i}),icon:(0,h.jsx)(d.x$1,{})}];return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(n.A,{mainTitle:e("permission"),pageTitle:e("permission"),parentTitle:e("Feature Templates")}),(0,h.jsx)(a.A,{tabs:r})]})}},35514:(e,t,s)=>{s.d(t,{A:()=>d,y:()=>a});s(99080);var i=s(88472),n=s(77154);(0,i.A)();const a=async e=>{try{console.log("page is here ",e);let t="/feature-template";void 0!==e&&(t+="?page=".concat(e,"&limit=",10));return(await n.A.get(t)).data}catch(t){return console.error("Error fetching templates:",t),{error:"Couldn't fetch User"}}},d={getTemplates:async e=>{try{return(await n.A.get("/feature-template",e)).data}catch(t){throw console.error("Error fetching modules:",t),t}},createTemplate:async e=>{try{console.log(e);return(await n.A.post("/feature-template",e)).data}catch(t){throw console.error("Error fetching modules:",t),t}},listModule:async e=>{try{return(await n.A.get("/modules",e)).data}catch(t){throw console.error("Error fetching modules:",t),t}},udpateTemplate:async e=>{try{return(await n.A.patch("/feature-template",e)).data}catch(t){throw console.error("Error fetching modules:",t),t}},deleteTemplate:async e=>{try{return(await n.A.delete("/feature-template/".concat(e))).data}catch(t){throw console.error("Error fetching modules:",t),t}}}}}]);
//# sourceMappingURL=3196.26e0a063.chunk.js.map