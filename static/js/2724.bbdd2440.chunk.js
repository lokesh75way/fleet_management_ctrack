"use strict";(self.webpackChunkFLEET=self.webpackChunkFLEET||[]).push([[2724],{99620:(e,a,t)=>{t.r(a),t.d(a,{default:()=>D});var s=t(65043),n=t(9866),l=t(53358),i=t(33723),c=t(44816),r=t(86856),o=(t(72213),t(50423)),d=t(47522),h=(t(19980),t(79904)),u=t.n(h),m=t(14282),p=t(70579);const v=e=>{const[a,t]=(0,s.useState)([]),[n,l]=(0,s.useState)([]),[i,c]=(0,s.useState)([]);(0,s.useEffect)((()=>{const a=null===e||void 0===e?void 0:e.companyVehicle.map((e=>{var a;const t=null===e||void 0===e||null===(a=e.vehicles)||void 0===a?void 0:a.map((e=>({label:null===e||void 0===e?void 0:e.vehicleName,value:null===e||void 0===e?void 0:e._id})));return{value:null===e||void 0===e?void 0:e._id,label:null===e||void 0===e?void 0:e.companyName,children:t}}));c([...a])}),[e.companyVehicle]),(0,s.useEffect)((()=>{let e=[];null===i||void 0===i||i.map((a=>{var t;return null===(t=a.children)||void 0===t?void 0:t.map((a=>e.push(a.value)))}));r(e)}),[i]);const r=a=>{t(a),e.setVehicleIds(a)};return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("div",{className:"checkboxTree",children:(0,p.jsx)(u(),{nodes:i,checked:a,expanded:n,onCheck:r,onExpand:e=>{l(e)},showNodeIcon:!1,icons:{expandOpen:(0,p.jsx)("i",{class:"fa-solid fa-minus"}),expandClose:(0,p.jsx)("i",{class:"fa-solid fa-plus"}),uncheck:(0,p.jsx)("i",{class:"fa-regular fa-square",style:{fontSize:"16px"}}),check:(0,p.jsx)("i",{class:"fa-solid fa-square-check",style:{fontSize:"16px"}}),halfCheck:(0,p.jsx)("i",{class:"fa-regular fa-square-minus",style:{fontSize:"16px"}})}})}),(0,p.jsx)("div",{className:"text-center  pt-2 ",children:(0,p.jsx)(m.A,{className:" mb-5",variant:"primary btn-md ",type:"submit",onClick:()=>{e.getVehiclesByIds(),e.handleToggleCardPositionHandler()},children:"Save Selection"})})]})};var x=t(272);const g=e=>{let{geoFences:a,handleToggleCardPositionHandler:t}=e;const[n,l]=(0,s.useState)([]),[i,c]=(0,s.useState)([]),[r,o]=(0,s.useState)([]);(0,s.useEffect)((()=>{const e=Object.entries(a).map((e=>{let[a,t]=e;return{value:a,label:a,children:t.map((e=>({label:e.name,value:e.id})))}}));o(e)}),[a]);return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("div",{className:"checkboxTree",children:(0,p.jsx)(u(),{nodes:r,checked:n,expanded:i,onCheck:e=>{l(e)},onExpand:e=>{c(e)},showNodeIcon:!1,icons:{expandOpen:(0,p.jsx)("i",{className:"fa-solid fa-minus"}),expandClose:(0,p.jsx)("i",{className:"fa-solid fa-plus"}),uncheck:(0,p.jsx)("i",{className:"fa-regular fa-square",style:{fontSize:"16px"}}),check:(0,p.jsx)("i",{className:"fa-solid fa-square-check",style:{fontSize:"16px"}}),halfCheck:(0,p.jsx)("i",{className:"fa-regular fa-square-minus",style:{fontSize:"16px"}})}})}),(0,p.jsx)("div",{className:"text-center  pt-2 ",children:(0,p.jsx)(m.A,{className:" mb-5",variant:"primary btn-md ",type:"submit",onClick:()=>{const e=n.map((e=>JSON.parse(e)));console.log(e),t()},children:"Save Selection"})})]})},f=e=>{const[a,t]=(0,s.useState)([]),[n,l]=(0,s.useState)([]),[i,c]=(0,s.useState)([]);console.log(e.drivers,"props.drivers"),(0,s.useEffect)((()=>{const a=Object.entries(e.drivers).map((e=>{const a=e[1].map((e=>({label:e.firstName,value:e.id})));return{value:e[0],label:e[0],children:a}}));c([...a])}),[e.drivers]);return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("div",{className:"checkboxTree",children:(0,p.jsx)(u(),{nodes:i,checked:a,expanded:n,onCheck:e=>{t(e)},onExpand:e=>{l(e)},showNodeIcon:!1,icons:{expandOpen:(0,p.jsx)("i",{class:"fa-solid fa-minus"}),expandClose:(0,p.jsx)("i",{class:"fa-solid fa-plus"}),uncheck:(0,p.jsx)("i",{class:"fa-regular fa-square",style:{fontSize:"16px"}}),check:(0,p.jsx)("i",{class:"fa-solid fa-square-check",style:{fontSize:"16px"}}),halfCheck:(0,p.jsx)("i",{class:"fa-regular fa-square-minus",style:{fontSize:"16px"}})}})}),(0,p.jsx)("div",{className:"text-center  pt-2 ",children:(0,p.jsx)(m.A,{className:" mb-5",variant:"primary btn-md ",type:"submit",onClick:()=>{const t=a.map((e=>JSON.parse(e)));console.log(t,"selctedObject"),e.handleToggleCardPositionHandler()},children:"Save Selection"})})]})};var j=t(42457),S=t(78247);const N=e=>{const{setVehicleStatus:a,vehicleCounts:t}=e,{running:n,idle:l,stopped:i,inactive:c,nodata:r,total:o}=t,[h,u]=(0,s.useState)("All"),[m,g]=(0,s.useState)([]),[f,N]=(0,s.useState)([]);(0,s.useEffect)((()=>{(async e=>{try{var a;const t=await(0,S.oq)(e);return void await N(null!==(a=null===t||void 0===t?void 0:t.data)&&void 0!==a?a:[])}catch(t){(0,j.U)("Some Error occured")}})()}),[h]);const k=JSON.parse(localStorage.getItem("userJsonData")).filter((e=>"vehicle"===e.designation)).map((e=>({id:e.id,name:e.vehicleName})));return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("div",{className:"vehicle_tracking-object",children:[(0,p.jsxs)("span",{className:"light fs-9 running ".concat("Running"===h&&"vehicle_tracking-active"),onClick:()=>{u("Running"),a("RUNNING")},children:[(0,p.jsx)("p",{children:n}),(0,p.jsx)("span",{children:"Running"})]}),(0,p.jsxs)("span",{pill:!0,className:"light fs-9 idle ".concat("Idle"===h&&"vehicle_tracking-active"),onClick:()=>{u("Idle"),a("IDLE")},children:[(0,p.jsx)("p",{children:l}),(0,p.jsx)("span",{children:"Idle"})]}),(0,p.jsxs)("span",{pill:!0,className:"light stopped fs-9 ".concat("Stopped"===h&&"vehicle_tracking-active"),onClick:()=>{u("Stopped"),a("STOP")},children:[(0,p.jsx)("p",{children:i}),(0,p.jsx)("span",{children:"Stopped"})]}),(0,p.jsxs)("span",{pill:!0,className:"light fs-9 inActive ".concat("Inactive"===h&&"vehicle_tracking-active"),onClick:()=>{u("Inactive"),a("INACTIVE")},children:[(0,p.jsx)("p",{children:c}),(0,p.jsx)("span",{children:"InActive"})]}),(0,p.jsxs)("span",{pill:!0,className:"light fs-9 noData ".concat("NoData"===h&&"vehicle_tracking-active"),onClick:()=>{u("NoData"),a("NODATA")},children:[(0,p.jsx)("p",{children:r}),(0,p.jsx)("span",{children:"NoData"})]}),(0,p.jsxs)("span",{className:"light fs-9 total ".concat("All"===h&&"vehicle_tracking-active"),onClick:()=>{u("All"),a("")},children:[(0,p.jsx)("p",{children:o}),(0,p.jsx)("span",{children:"Total"})]})]}),(0,p.jsx)("div",{className:"d-flex mt-4 mb-4",children:(0,p.jsx)(d.ReactSearchAutocomplete,{items:k,className:"w-100",styling:{height:"30px",marginRight:"10px",fontSize:"12px",color:"#4A4646"},onSearch:e=>{if(""===e){const e=(0,x.kw)(h);g(e)}},onSelect:e=>{const a=(0,x.kw)(h),t=Object.entries(a).filter((a=>a[1].filter((a=>a.id==e.id)).length>0)).reduce(((a,t)=>{let[s,n]=t;return n.map((t=>{t.vehicleName===e.name&&(a[s]=[t])})),a}),{});g(t)}})}),(0,p.jsx)(v,{companyVehicle:null!==f&&void 0!==f?f:[],setVehicleIds:e.setVehicleIds,vehicles:m,getVehiclesByIds:e.getVehiclesByIds,handleToggleCardPositionHandler:e.handleToggleCardPosition})]})},k=e=>{const[a,t]=(0,s.useState)("All"),[n,l]=(0,s.useState)([]),[i,c]=(0,s.useState)([]),[r,o]=(0,s.useState)([]),[h,u]=(0,s.useState)(!1),[m,v]=(0,s.useState)(!1),x=JSON.parse(localStorage.getItem("userJsonData")),[g,j]=(0,s.useState)([]),[S,N]=(0,s.useState)(x.filter((e=>"company"===e.role))),[k,C]=(0,s.useState)(x.filter((e=>"Driver"===e.designation))),y=k.filter((e=>"Allocated"===e.activityStatus)),b=k.filter((e=>"Not Allocated"===e.activityStatus));(0,s.useEffect)((()=>{const e=S.reduce(((e,a)=>{const t=x.filter((e=>"Driver"===e.designation&&e.parentCompany===a.userName));return t.length>0&&(e[a.userName]=t),e}),{});j(e)}),[S]),(0,s.useEffect)((()=>{const e=S.reduce(((e,t)=>{const s=x.filter((e=>"Driver"===e.designation&&e.parentCompany===t.userName&&("All"==a||e.activityStatus===a)));return s.length>0&&(e[t.userName]=s),e}),{});j(e)}),[a]);const A=k.length,I=x.filter((e=>"Driver"===e.designation)).map((e=>({id:e.id,name:e.firstName+" "+e.lastName})));return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("div",{className:"px-2 vehicle_tracking-object",children:[(0,p.jsxs)("span",{bg:"",pill:!0,className:"light fs-9  running ".concat("Allocated"===a?"vehicle_tracking-active":m&&"pe-none"),onClick:()=>t("Allocated"),children:[(0,p.jsx)("p",{children:y.length}),(0,p.jsx)("span",{children:"Allocated"})]}),(0,p.jsxs)("span",{bg:"",pill:!0,className:"light fs-9 idle ".concat("Not Allocated"===a?"vehicle_tracking-active":m&&"pe-none"),onClick:()=>t("Not Allocated"),children:[(0,p.jsx)("p",{children:b.length}),(0,p.jsx)("span",{children:"Not Allocated"})]}),(0,p.jsxs)("span",{bg:"",pill:!0,className:"light fs-9 total ".concat("Total"===a?"vehicle_tracking-active":m&&"pe-none"),onClick:()=>t("All"),children:[(0,p.jsx)("p",{children:A}),(0,p.jsx)("span",{children:"Total"})]})]}),(0,p.jsx)("div",{className:"d-flex mt-4 mb-4",children:(0,p.jsx)(d.ReactSearchAutocomplete,{items:I,className:"w-100",styling:{height:"30px",marginRight:"10px",fontSize:"12px",color:"#red"},onSearch:(e,a)=>{if(""===e){const e=S.reduce(((e,a)=>{const t=x.filter((e=>"Driver"===e.designation&&e.parentCompany===a.userName));return t.length>0&&(e[a.userName]=t),e}),{});j(e)}},onSelect:e=>{const a=e.id,t=S.reduce(((e,t)=>{const s=x.filter((e=>"Driver"===e.designation&&e.parentCompany===t.userName&&e.id===a));return s.length>0&&(e[t.userName]=s),e}),{});j(t)}})}),(0,p.jsx)(f,{drivers:g,handleToggleCardPositionHandler:e.handleToggleCardPosition},g)]})},C=e=>{const a=JSON.parse(localStorage.getItem("geofenceData")),[t,n]=(0,s.useState)(a),[l,i]=(0,s.useState)([]),[c,r]=(0,s.useState)(""),o=(t.filter((e=>e.company.toLowerCase().includes(c.toLowerCase()))),t.reduce(((e,a)=>(e[a.company]||(e[a.company]=[]),e[a.company].push(a),e)),{})),h=t.map((e=>({id:e.id,name:e.name})));return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("div",{className:"d-flex mt-4 mb-4",children:(0,p.jsx)(d.ReactSearchAutocomplete,{items:h,className:"w-100",styling:{height:"30px",marginRight:"10px",fontSize:"12px",color:"#red"},onSelect:e=>{const t=a.filter((a=>a.id===e.id));n(t)}})}),(0,p.jsx)("div",{className:"d-flex flex-column p-2",style:{marginTop:".5rem",overflowY:"scroll"},children:(0,p.jsx)(g,{geoFences:o,handleToggleCardPositionHandler:e.handleToggleCardPosition})})]})},y=e=>{let{tabData:a,handleToggleCardPosition:t,isOutside:s,setVehicleIds:n,getVehiclesByIds:l,setVehicleStatus:i,vehicleCounts:d}=e;const h={name:"Company1",drivers:[{name:"driver1",timeStamp:"22-02-2024 3:00 PM",status:"running"},{name:"driver2",timeStamp:"22-02-2024 3:00 PM",status:"idle"},{name:"driver3",timeStamp:"22-02-2024 3:00 PM",status:"inactive"},{name:"driver4",timeStamp:"22-02-2024 3:00 PM",status:"running"},{name:"driver5",timeStamp:"22-02-2024 3:00 PM",status:"stopped"},{name:"driver6",timeStamp:"22-02-2024 3:00 PM",status:"stopped"},{name:"driver7",timeStamp:"22-02-2024 3:00 PM"}],allocatedDriver:4,notAllocatedDriver:3,totalDriver:7},u=[N,k,C];return(0,p.jsx)(p.Fragment,{children:(0,p.jsxs)("div",{className:"default-tab outer-container ".concat(s?"toggleBarInside":"toggleBarOutside"),children:[(0,p.jsx)("button",{onClick:t,className:"driver_tracking_button",children:s?(0,p.jsx)(o.m6W,{}):(0,p.jsx)(o.OQo,{})}),(0,p.jsxs)(c.A.Container,{defaultActiveKey:a[0].name.toLowerCase(),children:[(0,p.jsx)(r.A,{as:"ul",className:"nav-tabs tracking_navTabs",children:a.map(((e,a)=>{const t=e.icon;return(0,p.jsx)(r.A.Item,{as:"li",children:(0,p.jsxs)(r.A.Link,{eventKey:e.name.toLowerCase(),children:[(0,p.jsx)(t,{className:"tab-icon"}),e.name]})},a)}))}),(0,p.jsx)(c.A.Content,{className:"p-2 py-4",style:{background:"#f5f5f5",overflow:"scroll",height:"100vh"},children:a.map(((e,a)=>{const s=u[a];return(0,p.jsx)(c.A.Pane,{eventKey:e.name.toLowerCase(),children:(0,p.jsx)(s,{data:h,handleToggleCardPosition:t,setVehicleIds:n,getVehiclesByIds:l,setVehicleStatus:i,vehicleCounts:d})},a)}))})]})]})})};var b=t(60397),A=t(60184),I=t(6720),T=t(74117);const D=()=>{const{t:e}=(0,T.Bd)(),{currentPosition:a,setCurrentPosition:t}=(0,s.useContext)(i.D),[c,r]=(0,s.useState)(!0),o=[{name:"Object",icon:b.ETQ},{name:"Driver",icon:A.x$1},{name:"Geofence",icon:I.vVi}],[d,h]=(0,s.useState)([]),[u,m]=(0,s.useState)(""),[v,x]=(0,s.useState)([]),[g,f]=(0,s.useState)({}),[N,k]=(0,s.useState)({}),C=()=>{(async e=>{try{var a,t,s;const n=await(0,S.Up)(null!==e&&void 0!==e?e:"",u);return x(null!==(a=null===n||void 0===n?void 0:n.data)&&void 0!==a?a:[]),f(null===n||void 0===n||null===(t=n.data)||void 0===t?void 0:t.count),void k(null===n||void 0===n||null===(s=n.data)||void 0===s?void 0:s.centerCoordinate)}catch(n){(0,j.U)("Some Error occured")}})(d.map((e=>"id=".concat(e,"&"))).join(""))};return(0,s.useEffect)((()=>{let e;return d.length&&(C(),e=setInterval((()=>{C()}),12e4)),()=>{clearInterval(e)}}),[d]),(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(n.A,{mainTitle:e("vehicleTracking"),pageTitle:e("vehicleTracking"),parentTitle:e("tracking")}),(0,p.jsx)("div",{className:"backdrop ".concat(c?"d-none":"d-block"),onClick:()=>r(!0)}),(0,p.jsx)("div",{className:"p-2",children:(0,p.jsx)(l.A,{data:[{lat:30.7099475,lng:76.6900474},{lat:30.7333,lng:76.7794}],trackingData:v,centerCoordinate:N})}),(0,p.jsx)(y,{tabData:o,setVehicleIds:h,getVehiclesByIds:C,vehicleIds:d,setVehicleStatus:m,vehicleCounts:g,handleToggleCardPosition:()=>{r(!c)},isOutside:c})]})}}}]);
//# sourceMappingURL=2724.bbdd2440.chunk.js.map