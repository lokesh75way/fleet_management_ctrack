"use strict";(self.webpackChunkFLEET=self.webpackChunkFLEET||[]).push([[5163],{45794:(e,a,s)=>{s.d(a,{A:()=>r});var t=s(65043),n=s(80228),l=s(51403),i=s(3778),c=s(70579);function r(e){let{geojson:a,setGeojson:s}=e;const r=(0,t.useRef)(null);(0,t.useEffect)((()=>{var e;0===(null===(e=r.current)||void 0===e?void 0:e.getLayers().length)&&a&&n.geoJSON(a).eachLayer((e=>{var a,s,t;(e instanceof n.Polyline||e instanceof n.Polygon||e instanceof n.Marker)&&(null!==e&&void 0!==e&&null!==(a=e.feature)&&void 0!==a&&a.properties.radius&&r.current?new n.Circle(e.feature.geometry.coordinates.slice().reverse(),{radius:null===(s=e.feature)||void 0===s?void 0:s.properties.radius}).addTo(r.current):null===(t=r.current)||void 0===t||t.addLayer(e))}))}),[a]);const o=()=>{var e;const a=null===(e=r.current)||void 0===e?void 0:e.toGeoJSON();console.log(a),"FeatureCollection"===(null===a||void 0===a?void 0:a.type)&&s(a)};return(0,c.jsx)(l.m,{ref:r,children:(0,c.jsx)(i.M,{position:"topright",onEdited:o,onCreated:o,onDeleted:o,draw:{rectangle:!1,circle:!0,polyline:!0,polygon:!0,marker:!0,circlemarker:!1}})})}},53358:(e,a,s)=>{s.d(a,{A:()=>o});s(65043),s(33723),s(72213);var t=s(70579);s(84391);var n=s(99419),l=s(12023),i=s(76036),c=s(13318),r=s(62559);s(45794);const o=e=>{let{data:a}=e;return(0,t.jsx)("div",{style:{display:"flex",height:"85vh"},children:(0,t.jsx)("div",{style:{width:"100%"},children:(0,t.jsxs)(n.W,{center:[25.2233,55.2869],zoom:14,zoomControl:!1,children:[(0,t.jsx)(l.e,{attribution:'\xa9 <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"http://{s}.tile.osm.org/{z}/{x}/{y}.png"}),(0,t.jsxs)(i.p,{styles:{background:"red"},position:[25.2233,55.2869],children:[(0,t.jsx)(c.z,{children:"Dubai Trade Center"}),(0,t.jsx)(r.m,{children:"Dubai Trade Center"})]})]})})})}},98649:(e,a,s)=>{s.r(a),s.d(a,{default:()=>A});var t=s(65043),n=s(9866),l=s(53358),i=s(33723),c=s(44816),r=s(86856),o=s(10457),d=s(14282),m=(s(72213),s(50423)),h=(s(51359),s(15075),s(47522)),p=(s(19980),s(79904)),u=s.n(p),x=s(70579);const g=e=>{const[a,s]=(0,t.useState)([]),[n,l]=(0,t.useState)([]),[i,c]=(0,t.useState)([]);(0,t.useEffect)((()=>{const a=Object.entries(e.vehicles).map((e=>{const a=e[1].map((e=>({label:e.vehicleName,value:e.id})));return{value:e[0],label:e[0],children:a}}));c([...a])}),[e.vehicles]);return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("div",{className:"checkboxTree",children:(0,x.jsx)(u(),{nodes:i,checked:a,expanded:n,onCheck:e=>{s(e)},onExpand:e=>{l(e)},showNodeIcon:!1,icons:{expandOpen:(0,x.jsx)("i",{class:"fa-solid fa-minus"}),expandClose:(0,x.jsx)("i",{class:"fa-solid fa-plus"}),uncheck:(0,x.jsx)("i",{class:"fa-regular fa-square",style:{fontSize:"16px"}}),check:(0,x.jsx)("i",{class:"fa-solid fa-square-check",style:{fontSize:"16px"}}),halfCheck:(0,x.jsx)("i",{class:"fa-regular fa-square-minus",style:{fontSize:"16px"}})}})}),(0,x.jsx)("div",{className:"text-center  pt-2 ",children:(0,x.jsx)(d.A,{className:" mb-5",variant:"primary btn-md ",type:"submit",onClick:()=>{const s=a.map((e=>JSON.parse(e)));console.log(s),e.handleToggleCardPositionHandler()},children:"Save Selection"})})]})};var v=s(272);const f=e=>{let{geoFences:a,handleToggleCardPositionHandler:s}=e;const[n,l]=(0,t.useState)([]),[i,c]=(0,t.useState)([]),[r,o]=(0,t.useState)([]);(0,t.useEffect)((()=>{const e=Object.entries(a).map((e=>{let[a,s]=e;return{value:a,label:a,children:s.map((e=>({label:e.name,value:e.id})))}}));o(e)}),[a]);return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("div",{className:"checkboxTree",children:(0,x.jsx)(u(),{nodes:r,checked:n,expanded:i,onCheck:e=>{l(e)},onExpand:e=>{c(e)},showNodeIcon:!1,icons:{expandOpen:(0,x.jsx)("i",{className:"fa-solid fa-minus"}),expandClose:(0,x.jsx)("i",{className:"fa-solid fa-plus"}),uncheck:(0,x.jsx)("i",{className:"fa-regular fa-square",style:{fontSize:"16px"}}),check:(0,x.jsx)("i",{className:"fa-solid fa-square-check",style:{fontSize:"16px"}}),halfCheck:(0,x.jsx)("i",{className:"fa-regular fa-square-minus",style:{fontSize:"16px"}})}})}),(0,x.jsx)("div",{className:"text-center  pt-2 ",children:(0,x.jsx)(d.A,{className:" mb-5",variant:"primary btn-md ",type:"submit",onClick:()=>{const e=n.map((e=>JSON.parse(e)));console.log(e),s()},children:"Save Selection"})})]})},j=e=>{const a=(0,v.r_)(),{Running:s,Idle:n,Stopped:l,Inactive:i,nodata:c,total:r}=a,[o,d]=(0,t.useState)("All"),[m,p]=(0,t.useState)([]);(0,t.useEffect)((()=>{const e=(0,v.kw)(o);p(e)}),[o]);const u=JSON.parse(localStorage.getItem("userJsonData")).filter((e=>"vehicle"===e.designation)).map((e=>({id:e.id,name:e.vehicleName})));return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)("div",{className:"vehicle_tracking-object",children:[(0,x.jsxs)("span",{className:"light fs-9 running ".concat("Running"===o&&"vehicle_tracking-active"),onClick:()=>d("Running"),children:[(0,x.jsx)("p",{children:s}),(0,x.jsx)("span",{children:"Running"})]}),(0,x.jsxs)("span",{pill:!0,className:"light fs-9 idle ".concat("Idle"===o&&"vehicle_tracking-active"),onClick:()=>d("Idle"),children:[(0,x.jsx)("p",{children:n}),(0,x.jsx)("span",{children:"Idle"})]}),(0,x.jsxs)("span",{pill:!0,className:"light stopped fs-9 ".concat("Stopped"===o&&"vehicle_tracking-active"),onClick:()=>d("Stopped"),children:[(0,x.jsx)("p",{children:l}),(0,x.jsx)("span",{children:"Stopped"})]}),(0,x.jsxs)("span",{pill:!0,className:"light fs-9 inActive ".concat("Inactive"===o&&"vehicle_tracking-active"),onClick:()=>d("Inactive"),children:[(0,x.jsx)("p",{children:i}),(0,x.jsx)("span",{children:"InActive"})]}),(0,x.jsxs)("span",{pill:!0,className:"light fs-9 noData ".concat("NoData"===o&&"vehicle_tracking-active"),onClick:()=>d("NoData"),children:[(0,x.jsx)("p",{children:c}),(0,x.jsx)("span",{children:"NoData"})]}),(0,x.jsxs)("span",{className:"light fs-9 total ".concat("All"===o&&"vehicle_tracking-active"),onClick:()=>d("All"),children:[(0,x.jsx)("p",{children:r}),(0,x.jsx)("span",{children:"Total"})]})]}),(0,x.jsx)("div",{className:"d-flex mt-4 mb-4",children:(0,x.jsx)(h.ReactSearchAutocomplete,{items:u,className:"w-100",styling:{height:"30px",marginRight:"10px",fontSize:"12px",color:"#4A4646"},onSearch:e=>{if(""===e){const e=(0,v.kw)(o);p(e)}},onSelect:e=>{const a=(0,v.kw)(o);console.log(a);const s=Object.entries(a).filter((a=>a[1].filter((a=>a.id==e.id)).length>0)).reduce(((a,s)=>{let[t,n]=s;return n.map((s=>{s.vehicleName===e.name&&(a[t]=[s])})),a}),{});p(s)}})}),(0,x.jsx)(g,{vehicles:m,handleToggleCardPositionHandler:e.handleToggleCardPosition})]})},N=e=>{const[a,s]=(0,t.useState)("All"),[n,l]=(0,t.useState)([]),[i,c]=(0,t.useState)([]),[r,m]=(0,t.useState)([]),[p,u]=(0,t.useState)(!1),[g,v]=(0,t.useState)(!1),f=JSON.parse(localStorage.getItem("userJsonData")),[j,N]=(0,t.useState)(f.filter((e=>"company"===e.role))),[k,S]=(0,t.useState)(f.filter((e=>"Driver"===e.designation))),y=k.filter((e=>"Allocated"===e.activityStatus)),b=k.filter((e=>"Not Allocated"===e.activityStatus)),C=k.length;console.log(k);const A=e=>{console.log(n),l((a=>{const s=[...a];return s[e]=!s[e],s}))};(0,t.useEffect)((()=>{if("All"!==a){if(N(f.filter((e=>"company"===e.role))),u(!0),"Allocated"===a){const e=y.map((e=>e.parentCompany)).filter(((e,a,s)=>s.indexOf(e)===a));N(j.filter((a=>e.some((e=>e===a.userName)))))}if("Not Allocated"===a){const e=b.map((e=>e.parentCompany)).filter(((e,a,s)=>s.indexOf(e)===a));N(j.filter((a=>e.some((e=>e===a.userName)))))}}else u(!1)}),[a]);const T=f.filter((e=>"Driver"===e.designation)).map((e=>({id:e.id,name:e.firstName+" "+e.lastName})));return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)("div",{className:"px-2 vehicle_tracking-object",children:[(0,x.jsxs)("span",{bg:"",pill:!0,className:"light fs-9  running ".concat("Allocated"===a?"vehicle_tracking-active":g&&"pe-none"),onClick:()=>s("Allocated"),children:[(0,x.jsx)("p",{children:y.length}),(0,x.jsx)("span",{children:"Allocated"})]}),(0,x.jsxs)("span",{bg:"",pill:!0,className:"light fs-9 idle ".concat("Not Allocated"===a?"vehicle_tracking-active":g&&"pe-none"),onClick:()=>s("Not Allocated"),children:[(0,x.jsx)("p",{children:b.length}),(0,x.jsx)("span",{children:"Not Allocated"})]}),(0,x.jsxs)("span",{bg:"",pill:!0,className:"light fs-9 total ".concat("Total"===a?"vehicle_tracking-active":g&&"pe-none"),onClick:()=>s("Total"),children:[(0,x.jsx)("p",{children:C}),(0,x.jsx)("span",{children:"Total"})]})]}),(0,x.jsx)("div",{className:"d-flex mt-4 mb-4",children:(0,x.jsx)(h.ReactSearchAutocomplete,{items:T,className:"w-100",styling:{position:"absolute",zIndex:999},onSearch:(e,a)=>{s("All"),v(!1),u(!1),S(f.filter((e=>"Driver"===e.designation))),N(f.filter((e=>"company"===e.role)))},onSelect:e=>{s("All"),u(!0),v(!0);var a=f.filter((a=>"Driver"===a.designation&&a.id===e.id)),t=j.filter((e=>e.userName===a[0].parentCompany));S(a),N(t)}})}),(0,x.jsx)("div",{className:"d-flex flex-column bg-white p-2",style:{border:" 1px solid white",marginTop:".5rem",height:"65vh",overflowY:"scroll"},children:j.map(((e,s)=>{var t=[];return 0===i.length&&j.map((e=>i.push([])&&n.push(!1))),p?"All"===a?t=k:"Allocated"===a?t=y.filter((a=>a.parentCompany===e.userName)):"Not Allocated"===a?t=b.filter((a=>a.parentCompany===e.userName)):"Total"===a&&(t=f.filter((a=>"Driver"===a.designation&&a.parentCompany===e.userName))):t=f.filter((a=>"Driver"===a.designation&&a.parentCompany===e.userName)),(0,x.jsx)(o.A,{className:"accordion accordion-primary",defaultActiveKey:"0",children:(0,x.jsxs)(o.A.Item,{className:"accordion-item",eventKey:"$/{i}",children:[(0,x.jsxs)(o.A.Header,{className:"accordian-header rounded-sm",children:[(0,x.jsx)("div",{className:"form-check custom-checkbox bs_exam_topper_all",style:{marginRight:"10px"},onClick:e=>e.stopPropagation(),children:(0,x.jsx)("input",{type:"checkbox",className:"form-check-input",id:"customCheckBox".concat(s),onChange:()=>((e,a,s,t)=>{var l=[...i];n[t]?(l[t]=[],c(l)):s.map((e=>l[t].push(e.id))),console.log(l)})(e.id,0,t,s),onClick:()=>A(s),checked:n[s],required:!0})}),e.userName]}),0===t.length?(0,x.jsx)(o.A.Body,{className:"p-2 text-center fs-4 heading ",children:"No Record Found"}):t.map(((e,a)=>(0,x.jsx)(o.A.Body,{className:"accordian-body",eventKey:"".concat(s),children:(0,x.jsxs)("div",{onClick:()=>{m(r.concat(e.id))},className:"d-flex align-items-center border-bottom heading driver-select-object p-2",children:[(0,x.jsx)("div",{className:"form-check custom-checkbox ms-3 me-3 bs_exam_topper",children:(0,x.jsx)("input",{type:"checkbox",className:"form-check-input",onChange:()=>((e,a)=>{const s=[...i];if(s[a].includes(e)){const t=s[a].indexOf(e);s[a].splice(t,1),2===s[a].length&&A(a)}else s[a].push(e),3===s[a].length&&A(a);console.log(s),c(s)})(e.id,s),checked:i[s].includes(e.id),required:!0})}),(0,x.jsxs)("span",{className:"fs-4 ms-2",children:[e.firstName," ",e.lastName]})]},a)})))]},s)})}))}),(0,x.jsx)("div",{className:"mt-3 text-center",children:(0,x.jsx)(d.A,{className:"btn-md",variant:"primary",children:"Save Selection"})})]})},k=e=>{const a=JSON.parse(localStorage.getItem("geofenceData")),[s,n]=(0,t.useState)(a),[l,i]=(0,t.useState)([]),[c,r]=(0,t.useState)(""),o=(s.filter((e=>e.company.toLowerCase().includes(c.toLowerCase()))),s.reduce(((e,a)=>(e[a.company]||(e[a.company]=[]),e[a.company].push(a),e)),{}));return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("div",{className:"d-flex mt-4 mb-4",children:(0,x.jsx)(h.ReactSearchAutocomplete,{onSearch:e=>{console.log("Search Query:",e),r(e)},className:"w-100",placeholder:"Search by company name",styling:{height:"30px",marginRight:"10px",fontSize:"12px",color:"#red"}})}),(0,x.jsx)("div",{className:"d-flex flex-column bg-white p-2",style:{border:" 1px solid white",marginTop:".5rem",height:"65vh",overflowY:"scroll"},children:(0,x.jsx)(f,{geoFences:o,handleToggleCardPositionHandler:e.handleToggleCardPosition})})]})},S=e=>{let{tabData:a,handleToggleCardPosition:s,isOutside:t}=e;const n={name:"Company1",drivers:[{name:"driver1",timeStamp:"22-02-2024 3:00 PM",status:"running"},{name:"driver2",timeStamp:"22-02-2024 3:00 PM",status:"idle"},{name:"driver3",timeStamp:"22-02-2024 3:00 PM",status:"inactive"},{name:"driver4",timeStamp:"22-02-2024 3:00 PM",status:"running"},{name:"driver5",timeStamp:"22-02-2024 3:00 PM",status:"stopped"},{name:"driver6",timeStamp:"22-02-2024 3:00 PM",status:"stopped"},{name:"driver7",timeStamp:"22-02-2024 3:00 PM"}],allocatedDriver:4,notAllocatedDriver:3,totalDriver:7},l=[j,N,k];return(0,x.jsx)(x.Fragment,{children:(0,x.jsxs)("div",{className:"default-tab outer-container ".concat(t?"toggleBarInside":"toggleBarOutside"),children:[(0,x.jsx)("button",{onClick:s,className:"driver_tracking_button",children:t?(0,x.jsx)(m.m6W,{}):(0,x.jsx)(m.OQo,{})}),(0,x.jsxs)(c.A.Container,{defaultActiveKey:a[0].name.toLowerCase(),children:[(0,x.jsx)(r.A,{as:"ul",className:"nav-tabs tracking_navTabs",children:a.map(((e,a)=>{const s=e.icon;return(0,x.jsx)(r.A.Item,{as:"li",children:(0,x.jsxs)(r.A.Link,{eventKey:e.name.toLowerCase(),children:[(0,x.jsx)(s,{className:"tab-icon"}),e.name]})},a)}))}),(0,x.jsx)(c.A.Content,{className:"p-2 py-4",style:{background:"#f5f5f5"},children:a.map(((e,a)=>{const t=l[a];return(0,x.jsx)(c.A.Pane,{eventKey:e.name.toLowerCase(),children:(0,x.jsx)(t,{data:n,handleToggleCardPosition:s})},a)}))})]})]})})};var y=s(60397),b=s(60184),C=s(6720);const A=()=>{const{currentPosition:e,setCurrentPosition:a}=(0,t.useContext)(i.D),[s,c]=(0,t.useState)(!0),r=[{name:"Object",icon:y.ETQ},{name:"Driver",icon:b.x$1},{name:"Geofence",icon:C.vVi}];return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(n.A,{mainTitle:"Vehicle Tracking",pageTitle:"Vehicle Tracking",parentTitle:"Tracking"}),(0,x.jsx)("div",{className:"backdrop ".concat(s?"d-none":"d-block"),onClick:()=>c(!0)}),(0,x.jsx)("div",{className:"p-2",children:(0,x.jsx)(l.A,{data:[{lat:30.7099475,lng:76.6900474},{lat:30.7333,lng:76.7794}]})}),(0,x.jsx)(S,{tabData:r,handleToggleCardPosition:()=>{c(!s)},isOutside:s})]})}}}]);
//# sourceMappingURL=5163.02b7e227.chunk.js.map