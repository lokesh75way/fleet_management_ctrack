"use strict";(self.webpackChunkFLEET=self.webpackChunkFLEET||[]).push([[1849],{25107:(e,a,l)=>{l.d(a,{A:()=>v});var s=l(65043),t=l(42297),r=l(44978),n=l(73216),o=l(75714),i=l(28261),c=l(94692),d=l(34713),m=l(45350),u=l(42880),h=l(70579);const v=e=>{let{branchIds:a,companyId:l,groupId:v,ref:x,onChange:p,value:g,defaultValue:f,customStyles:b,isDisabled:j,isMulti:y,name:N}=e;const[I,C]=(0,s.useState)(g),{page:A,setPage:S}=(0,c.A)(),{can:T}=(0,m.A)(),{pathname:w}=(0,n.zy)(),{data:F,fetchNextPage:L,hasNextPage:E,isFetching:V,isFetchingNextPage:D}=(0,o.q)({queryKey:["vehicles",a,l,v],queryFn:e=>{let{pageParam:s}=e;return S(s),(0,d.lp)(s,10,{branchIds:Array.isArray(a)?a.join(","):a,companyId:l,groupId:v})},initialPageParam:1,getNextPageParam:(e,a)=>{var l;return null!==(l=e.data)&&void 0!==l&&l.length?A+1:null},enabled:T("vehicle","view"),staleTime:1/0}),{refetch:G}=(0,i.I)({queryKey:["vehicle",f],queryFn:()=>(async e=>{let a=e;const l=[];Array.isArray(e)||(a=[e]);for(let s of a){const e=await(0,d.nz)(s);l.push(e)}return l})(f),enabled:!1,staleTime:1/0}),P=(0,s.useMemo)((()=>{let e=[];return null===F||void 0===F||F.pages.forEach((a=>{a.data.forEach((a=>{e.push({label:null===a||void 0===a?void 0:a.vehicleName,value:null===a||void 0===a?void 0:a._id})}))})),e}),[F]);(0,s.useEffect)((()=>{g&&g.length?C(g):C(void 0)}),[JSON.stringify(g)]),(0,s.useEffect)((()=>{(async()=>{if(f&&!g)if(Array.isArray(f)){if(!f.length)return;const a=P.filter((e=>f.some((a=>e.value===a))));if(a.length===f.length)return C(a),void p(a);try{const{data:e}=await G();if(e){const a=null===e||void 0===e?void 0:e.map((e=>({label:e.vehicleName,value:e._id})));C(a),p(a)}}catch(e){console.error("Error fetching vehicle details:",e)}}else{const a=P.find((e=>f===e.value));if(a)return C(a),void p(a);try{const{data:e}=await G();if(e&&e.length){const a={label:null===e||void 0===e?void 0:e[0].vehicleName,value:null===e||void 0===e?void 0:e[0]._id};C(a),p(a)}}catch(e){console.error("Error fetching vehicle details:",e)}}else C(g)})()}),[JSON.stringify(f),w,JSON.stringify(g)]);return(0,h.jsx)(t.Ay,{options:P,value:I,onChange:p,styles:b,ref:x,name:N,placeholder:(0,r.t)("selectVehicles"),isDisabled:j||!T("vehicle","view"),isClearable:!0,onMenuScrollToBottom:async e=>{e.target.scrollHeight-e.target.scrollTop===e.target.clientHeight&&!V&&E&&!D&&L()},menuShouldScrollIntoView:!1,isLoading:V,components:{LoadingIndicator:u.A},isMulti:y})}},24725:(e,a,l)=>{l.d(a,{A:()=>o});var s=l(65043),t=l(42297),r=l(50377),n=l(70579);const o=e=>{let{onChange:a,value:l,customStyles:o,ref:i,isDisabled:c,name:d}=e;const[m,u]=(0,s.useState)([]),[h,v]=(0,s.useState)(l);return(0,s.useEffect)((()=>{(async()=>{const e=(await(0,r.j9)()).data.map((e=>({label:null===e||void 0===e?void 0:e.firstName,value:null===e||void 0===e?void 0:e._id})));u(e)})()}),[]),(0,s.useEffect)((()=>{const e=m.find((e=>e.value===l));v(e)}),[l,m]),(0,n.jsx)(t.Ay,{options:m,value:h,onChange:e=>a(e),styles:o,ref:i,name:d})}},61849:(e,a,l)=>{l.r(a),l.d(a,{default:()=>w});var s=l(65043),t=l(44816),r=l(86856),n=l(24858),o=l(18403),i=l(73216),c=l(35475),d=l(31899),m=l.n(d),u=l(42297),h=(l(9531),l(87460)),v=(l(43),l(28334)),x=l(74805),p=l(24725),g=l(74117),f=l(92548),b=l(95474),j=l(4437),y=l(25107),N=l(70579);const I=e=>{let{Title:a,editData:l,setEditData:t,register:r,setValue:o,getValues:d,handleSubmit:I,onSubmit:C,errors:A,control:S,clearErrors:T}=e;const{t:w}=(0,g.Bd)(),[F,L]=(0,s.useState)(!1),[E,V]=(0,s.useState)(),[D,G]=(0,s.useState)([]),P=(0,i.Zp)(),q=(0,i.zy)(),[k,H]=(0,s.useState)(),[K,M]=(0,s.useState)(),[_,B]=(0,s.useState)(),O={control:e=>({...e,padding:".25rem 0 "})},{id:z}=(0,i.g)();return(0,s.useEffect)((()=>{if(z){const e=q.state[0];G(e)}}),[z]),(0,s.useEffect)((()=>{D&&z?(o("startLocation",null===D||void 0===D?void 0:D.startLocation),o("reachLocation",null===D||void 0===D?void 0:D.reachLocation),o("distance",null===D||void 0===D?void 0:D.distance),o("fuelConsumption",null===D||void 0===D?void 0:D.fuelConsumption),o("tripStatus",(null===D||void 0===D?void 0:D.tripStatus)||h.av[0].value),o("driver",null===D||void 0===D?void 0:D.driver)):(o("startTime",new Date),o("reachTime",new Date),o("tripStatus",h.av[0].value))}),[D,z]),(0,N.jsx)(N.Fragment,{children:(0,N.jsxs)("div",{className:"p-4",children:[(0,N.jsxs)("div",{className:"row",style:{width:"70%",margin:"auto"},children:[(0,N.jsxs)("div",{className:"col-xl-6 mb-3 ",children:[(0,N.jsxs)("label",{className:"form-label",children:[w("businessGroup")," ",(0,N.jsx)("span",{className:"text-danger",children:"*"})]}),(0,N.jsx)(n.xI,{name:"businessGroupId",control:S,rules:{required:!0},render:e=>{let{field:{onChange:a,value:l,name:s,ref:t}}=e;return(0,N.jsx)(f.A,{onChange:e=>{d("businessGroupId")!=e.value&&(o("businessGroupId",e.value),o("businessGroupName",e.label),o("companyId",""),o("branchId",""),H(null),M(null))},defaultValue:l,customStyles:O,name:s})}}),(0,N.jsx)(v.A,{errorName:A.businessGroupId})]}),(0,N.jsxs)("div",{className:"col-xl-6 mb-3 ",children:[(0,N.jsxs)("label",{className:"form-label",children:[w("company")," ",(0,N.jsx)("span",{className:"text-danger",children:"*"})]}),(0,N.jsx)(n.xI,{name:"companyId",control:S,rules:{required:!0},render:e=>{let{field:{onChange:a,value:l,name:s,ref:t}}=e;return(0,N.jsx)(b.A,{groupId:d("businessGroupId"),onChange:e=>{d("companyId")!=e.value&&(o("companyId",e.value),o("branchId",""),H(e),M(null))},defaultValue:l,value:k,customStyles:O,name:s})}}),(0,N.jsx)(v.A,{errorName:A.companyId})]}),(0,N.jsxs)("div",{className:"col-xl-6 mb-3 ",children:[(0,N.jsx)("label",{className:"form-label",children:w("branch")}),(0,N.jsx)(n.xI,{name:"branchId",control:S,render:e=>{let{field:{onChange:a,value:l,name:s,ref:t}}=e;return(0,N.jsx)(j.A,{companyId:d("companyId"),groupId:d("businessGroupId"),onChange:e=>{o("branchId",null===e||void 0===e?void 0:e.value),M(e)},defaultValue:l,value:K,customStyles:O,isDisabled:!1,name:s})}})]}),(0,N.jsxs)("div",{className:"col-xl-6 mb-3 ",children:[(0,N.jsxs)("label",{className:"form-label",children:[w("vehicleName"),(0,N.jsx)("span",{className:"text-danger",children:"*"})]}),(0,N.jsx)(n.xI,{name:"vehicleId",control:S,rules:{required:!0},render:e=>{let{field:{onChange:a,value:l,name:s,ref:t}}=e;return(0,N.jsx)(y.A,{companyId:d("companyId"),groupId:d("businessGroupId"),onChange:e=>{o("vehicleId",null===e||void 0===e?void 0:e.value),B(e)},defaultValue:l,value:_,customStyles:O,isDisabled:!1,name:s})}})]}),(0,N.jsxs)("div",{className:"col-xl-6 mb-3",children:[(0,N.jsxs)("div",{className:"d-flex flex-column",children:[(0,N.jsxs)("label",{htmlFor:"exampleFormControlInput3",className:"form-label",children:[w("startTime")," ",(0,N.jsx)("span",{className:"text-danger",children:"*"})]}),(0,N.jsx)(n.xI,{name:"startTime",control:S,render:e=>{let{value:a,name:l}=e;return(0,N.jsx)(m(),{selected:d("startTime")||new Date,className:"form-control customDateHeight",onChange:e=>o("startTime",e)})}})]}),(0,N.jsx)(v.A,{errorName:A.startTime})]}),(0,N.jsxs)("div",{className:"col-xl-6 mb-3",children:[(0,N.jsxs)("label",{htmlFor:"exampleFormControlInput3",className:"form-label",children:[w("startLocation")," ",(0,N.jsx)("span",{className:"text-danger",children:"*"})]}),(0,N.jsx)(x.A,{type:"text",register:r,label:"Start Location",name:"startLocation",placeholder:""}),(0,N.jsx)("br",{}),(0,N.jsx)(v.A,{errorName:A.startLocation})]}),(0,N.jsxs)("div",{className:"col-xl-6 mb-3",children:[(0,N.jsxs)("div",{className:"d-flex flex-column",children:[(0,N.jsxs)("label",{htmlFor:"exampleFormControlInput3",className:"form-label",children:[w("reachTime")," ",(0,N.jsx)("span",{className:"text-danger",children:"*"})]}),(0,N.jsx)(n.xI,{name:"reachTime",control:S,render:e=>{let{value:a,name:l}=e;return(0,N.jsx)(m(),{selected:d("reachTime")||new Date,className:"form-control customDateHeight",onChange:e=>o("reachTime",e)})}}),(0,N.jsx)("br",{})]}),(0,N.jsx)(v.A,{errorName:A.reachTime})]}),(0,N.jsxs)("div",{className:"col-xl-6 mb-3",children:[(0,N.jsxs)("label",{htmlFor:"exampleFormControlInput3",className:"form-label",children:[w("reachLocation")," ",(0,N.jsx)("span",{className:"text-danger",children:"*"})]}),(0,N.jsx)(x.A,{type:"text",register:r,label:"Reach Location",name:"reachLocation",placeholder:""}),(0,N.jsx)(v.A,{errorName:A.reachLocation})]}),(0,N.jsxs)("div",{className:"col-xl-6 mb-3",children:[(0,N.jsx)("label",{htmlFor:"exampleFormControlInput3",className:"form-label",children:w("distance")}),(0,N.jsx)(x.A,{type:"number",register:r,label:"Distance",name:"distance",placeholder:""})]}),(0,N.jsxs)("div",{className:"col-xl-6 mb-3",children:[(0,N.jsx)("label",{htmlFor:"exampleFormControlInput3",className:"form-label",children:w("fuelConsumption")}),(0,N.jsx)(x.A,{type:"number",register:r,label:"Fuel Consumption",name:"fuelConsumption",placeholder:""})]}),(0,N.jsxs)("div",{className:"col-xl-6 mb-3",children:[(0,N.jsxs)("label",{htmlFor:"exampleFormControlInput3",className:"form-label",children:[w("driver")," ",(0,N.jsx)("span",{className:"text-danger",children:"*"})]}),(0,N.jsx)(n.xI,{name:"driver",control:S,rules:{required:!0},render:e=>{let{field:{onChange:a,value:l,name:s,ref:t}}=e;return(0,N.jsx)(p.A,{onChange:e=>{o("driver",e.value),o("driverName",e.label)},value:l,customStyles:O,ref:t,name:s})}}),(0,N.jsx)(v.A,{errorName:A.driver})]}),(0,N.jsxs)("div",{className:"col-xl-6 mb-3",children:[(0,N.jsx)("label",{className:"form-label",children:w("tripStatus")}),(0,N.jsx)(n.xI,{name:"tripStatus",control:S,render:e=>{let{field:{onChange:a,value:l,name:s,ref:t}}=e;return(0,N.jsx)(u.Ay,{onChange:e=>{o("tripStatus",e.value),V(e.value),a(e.value)},options:h.av,ref:t,name:s,styles:O,defaultValue:h.av.find((e=>e.value===d("tripStatus"))),value:h.av.find((e=>e.value===l))})}})]})]}),(0,N.jsxs)("div",{style:{width:"100%",display:"flex",justifyContent:"center",margin:"2rem 0"},children:[(0,N.jsx)("button",{type:"submit",onClick:()=>{I(C)},className:"btn btn-primary me-1",children:"Submit"}),(0,N.jsx)(c.N_,{to:"#",onClick:()=>{L(!1),P(-1)},className:"btn btn-danger light ms-1",children:"Cancel"})]})]})})};var C=l(70228),A=l(23577),S=l(42457),T=l(40399);const w=()=>{const[e,a]=(0,s.useState)(0),l=(0,i.Zp)(),c=["Trip"],d=[I],{register:m,setValue:u,getValues:h,handleSubmit:v,clearErrors:x,formState:{errors:p},control:f}=(c.length,(0,n.mN)({resolver:(0,o.t)(C.M0)})),{id:b}=(0,i.g)(),{t:j}=(0,g.Bd)(),y=async e=>{if(b)try{return await(0,A.pj)(b,e),(0,S.V)("Trip Updated!"),void l("/settings/classifyTrips")}catch(a){console.log(a),(0,S.U)("Some error occured !!")}else try{await(0,A.C$)(e),(0,S.V)("New Trip Created!"),l("/settings/classifyTrips"),console.log("Submit botn",e)}catch(s){console.log("Error",s),(0,S.U)("Some error occured !!")}};return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(T.A,{mainTitle:j("trip"),pageTitle:j(b?"edit":"create"),parentTitle:j("classifyTrip")}),(0,N.jsx)("div",{className:"m-2 p-2",children:(0,N.jsx)(n.Op,{children:(0,N.jsx)("form",{onSubmit:v(y),children:(0,N.jsx)("div",{className:"default-tab",children:(0,N.jsxs)(t.A.Container,{defaultActiveKey:c[0].toLowerCase(),children:[(0,N.jsx)(r.A,{as:"ul",className:"nav-tabs",children:c.map(((l,s)=>(0,N.jsx)(r.A.Item,{as:"li",children:(0,N.jsx)(r.A.Link,{style:{padding:".5rem 2rem"},eventKey:l.toLowerCase(),active:s===e,onClick:()=>a(s),children:l})},s)))}),(0,N.jsx)(t.A.Content,{className:"pt-4",children:c.map(((a,l)=>{const s=d[l];return(0,N.jsx)(t.A.Pane,{eventKey:a.toLowerCase(),active:l===e,children:(0,N.jsx)(s,{data:c,control:f,setValue:u,register:m,getValues:h,errors:p,handleSubmit:v,onSubmit:y})},l)}))})]})})})})})]})}},23577:(e,a,l)=>{l.d(a,{BG:()=>o,C$:()=>r,nH:()=>t,pj:()=>n});var s=l(77154);(0,l(94505).A)();const t=async function(){let e=arguments.length>1?arguments[1]:void 0,a=arguments.length>2?arguments[2]:void 0,l=arguments.length>3?arguments[3]:void 0,t=arguments.length>4?arguments[4]:void 0,r="/trips?page=".concat(arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,"&limit=10");r+=a&&l&&t?"&driverId=".concat(a,"&start=").concat(l,"&end=").concat(t):"&status=".concat(e);const n=await s.A.get(r);return{data:n.data.data.data,totalLength:n.data.data.count}},r=async e=>s.A.post("/trips",e),n=async(e,a)=>s.A.patch("/trips/".concat(e),a),o=async e=>s.A.delete("/trips/".concat(e))}}]);
//# sourceMappingURL=1849.5795ca70.chunk.js.map