"use strict";(self.webpackChunkFLEET=self.webpackChunkFLEET||[]).push([[87],{68459:(e,a,s)=>{s.d(a,{A:()=>i});var l=s(78109),r=s(74563),t=(s(7695),s(55759)),n=s(97804),o=s(47337);const i=e=>{let{onChange:a,value:s,customStyles:i,branchids:d,ref:u,isDisabled:c,name:m}=e;const[v,h]=(0,l.useState)([]),[p,x]=(0,l.useState)(s),{page:f}=(0,n.A)();return(0,l.useEffect)((()=>{(async()=>{const e=(await(0,t.kw)(f,d||void 0)).data.map((e=>({label:null===e||void 0===e?void 0:e.vehicleName,value:null===e||void 0===e?void 0:e._id})));h(e)})()}),[f,d]),(0,l.useEffect)((()=>{if(s&&Array.isArray(s)){const e=v.filter((e=>s.some((a=>a===e.value))));x(e)}else x(s)}),[s,v,d]),(0,o.jsx)(r.Ay,{options:v,value:p,onChange:e=>a(e),styles:i,ref:u,name:m,isMulti:!0})}},30087:(e,a,s)=>{s.r(a),s.d(a,{default:()=>k});var l=s(78109),r=s(67236),t=s(36145),n=s(93576),o=s(86554),i=(s(1682),s(32343)),d=s(85389),u=s(74563),c=s(75542),m=s(91197),v=(s(96004),s(65687)),h=(s(7804),s(86151)),p=s(60306),x=s(34571),f=s(70529),b=s(43097),j=s(92704),y=s(93153),N=s(68892),g=s(88107),S=s(63226),I=s(4860),A=(s(8668),s(68459)),w=s(20460),C=s(31029),U=s(70076),D=s(47337);const E=e=>{let{handleNext:a,register:s,setValue:t,onSubmit:n,handleSubmit:i,getValues:E,errors:_,control:T,formData:V}=e;const[k,G]=(0,l.useState)(""),[O,P]=(0,l.useState)(),[F,B]=(0,l.useState)(""),[L,M]=(0,l.useState)([]),[q,R]=(0,l.useState)([]),[K,W]=(0,l.useState)([]),{checkRole:Z,checkUser:$}=(0,v.A)(),[z,J]=(0,l.useState)(),[X,Y]=(0,l.useState)(0),[H,Q]=(0,l.useState)(0),[ee,ae]=(0,l.useState)(!0),[se,le]=(0,l.useState)([]),[re,te]=(0,l.useState)(!1),[ne,oe]=(0,l.useState)(!1),[ie,de]=(0,l.useState)(!0),[ue,ce]=(0,l.useState)(!1),[me,ve]=(0,l.useState)(null),[he,pe]=(0,l.useState)(null),[xe,fe]=(0,l.useState)([]),be=JSON.parse(localStorage.getItem("userDetails")),{t:je}=(0,x.Bd)(),ye={control:e=>({...e,padding:"0.25rem 0 "})};console.log("errors",_),(0,l.useEffect)((()=>{de(!0),(async()=>{const e=await(0,j.GX)(),a=await(0,y.C1)(),s=await(0,N.e3)();if(e.error)(0,f.U)(e.error);else{const a=e.data;M(a);const s=a.map((e=>{var a,s;return{label:null===e||void 0===e||null===(a=e.businessGroupId)||void 0===a?void 0:a.groupName,value:null===e||void 0===e||null===(s=e.businessGroupId)||void 0===s?void 0:s._id}}));Ue(s)}if(a.error)(0,f.U)(a.error);else{const e=a.data.data.data;e.map((e=>{var a,s;return{label:null===(a=e.companyId)||void 0===a?void 0:a.companyName,value:null===(s=e.companyId)||void 0===s?void 0:s._id}}));R(e)}if(s.error)(0,f.U)(s.error);else{const e=s.data.data,a=e.map((e=>({label:e.branchName,value:e._id})));W(e),ke(a)}de(!1)})()}),[]),(0,l.useEffect)((()=>{(async()=>{const e=await(0,p.y)();if(e.error)(0,f.U)(e.error);else{const a=e.data.data.map((e=>({label:e.name,value:e._id})));le(a)}})()}),[]);const Ne=Z(),{id:ge}=(0,r.g)(),Se=localStorage.getItem("loginDetails-name");let Ie;Ie="SUPER_ADMIN"===Ne?h.filter((e=>"company"===e.role)).map((e=>({label:e.userName,value:e._id}))):h.filter((e=>"company"===e.role&&e.parent===Se)).map((e=>({label:e.userName,value:e._id})));const[Ae,we]=(0,l.useState)([]),[Ce,Ue]=(0,l.useState)([]),[De,Ee]=(0,l.useState)([]),[_e,Te]=(0,l.useState)([]),[Ve,ke]=(0,l.useState)([]),[Ge,Oe]=(0,l.useState)([]),[Pe,Fe]=(0,l.useState)(),[Be,Le]=(0,l.useState)([]),[Me,qe]=(0,l.useState)(),[Re,Ke]=(0,l.useState)(!1),[We,Ze]=(0,l.useState)(!1),{location:$e,error:ze}=(0,U.A)(),[Je,Xe]=(0,l.useState)([]);return(0,l.useEffect)((()=>{var e,a,s,l,r,n,o,i;"COMPANY"===be.user.role&&(t("businessGroupId",null===be||void 0===be||null===(e=be.user.businessGroupId[0])||void 0===e?void 0:e._id),t("businessUser",null===be||void 0===be||null===(a=be.user.businessGroupId[0])||void 0===a?void 0:a._id),ve(null===be||void 0===be||null===(s=be.user.businessGroupId[0])||void 0===s?void 0:s._id),Ke(!0),t("parentCompany",null===be||void 0===be||null===(l=be.user.companyId[0])||void 0===l?void 0:l._id),pe(null===be||void 0===be||null===(r=be.user.companyId[0])||void 0===r?void 0:r._id),Ze(!0));"BUSINESS_GROUP"===be.user.role&&(ve(null===be||void 0===be||null===(n=be.user.businessGroupId)||void 0===n?void 0:n._id),t("businessUser",null===be||void 0===be||null===(o=be.user)||void 0===o||null===(i=o.businessGroupId[0])||void 0===i?void 0:i._id),Ke(!0))}),[]),(0,l.useEffect)((()=>{var e,a,s,l,r,n,o,i;V&&ge&&(t("businessUser",null===V||void 0===V||null===(e=V[0])||void 0===e?void 0:e.businessGroupId),t("companyId",null===V||void 0===V||null===(a=V[0])||void 0===a?void 0:a.companyId),t("branchIds",null===V||void 0===V||null===(s=V[0])||void 0===s?void 0:s.branchIds),t("vehicleIds",null===V||void 0===V||null===(l=V[0])||void 0===l?void 0:l.vehicleIds),t("email",null===V||void 0===V||null===(r=V[0])||void 0===r?void 0:r.email),t("userName",null===V||void 0===V||null===(n=V[0])||void 0===n?void 0:n.userName),t("mobileNumber",null===V||void 0===V||null===(o=V[0])||void 0===o?void 0:o.mobileNumber),t("country",V[0].country),P({name:V[0].country}),t("state",V[0].state||""),G({name:V[0].state||""}),t("featureTemplateId",null===V||void 0===V||null===(i=V[0])||void 0===i?void 0:i.featureTemplateId),t("unitOfDistance",null===V||void 0===V?void 0:V[0].unitOfDistance))}),[V,ge]),ie?(0,D.jsx)("div",{children:"Loading..."}):(0,D.jsxs)("div",{className:"p-4",children:[(0,D.jsxs)("div",{className:"row",style:{width:"85%",margin:"auto"},children:[(0,D.jsx)("div",{children:ze&&(0,D.jsx)("p",{children:ze})}),(0,D.jsxs)("div",{className:"col-xl-3 mb-3",children:[(0,D.jsx)("label",{className:"form-label",children:je("businessGroup")}),(0,D.jsx)(o.xI,{name:"businessUser",control:T,rules:{required:!0},render:e=>{let{field:{onChange:a,value:s,name:l,ref:r}}=e;return(0,D.jsx)(I.A,{onChange:async e=>{t("businessUser",e.value),ve(e.value),pe(null)},value:s,customStyles:ye,ref:r,isDisabled:Re,name:l},me)}})]}),(0,D.jsxs)("div",{className:"col-xl-3 mb-3",children:[(0,D.jsx)("label",{className:"form-label",children:je("company")}),(0,D.jsx)(o.xI,{name:"companyId",control:T,rules:{required:!0},render:e=>{let{field:{onChange:a,value:s,name:l,ref:r}}=e;return(0,D.jsx)(S.A,{onChange:async e=>{t("companyId",e.value),pe(e.value)},groupId:me,value:s,customStyles:ye,name:l,ref:r,isDisabled:We},me)}})]}),(0,D.jsxs)("div",{className:"col-xl-3 mb-3",children:[(0,D.jsx)("label",{className:"form-label",children:je("branch")}),(0,D.jsx)(o.xI,{name:"branchIds",control:T,rules:{required:!0},render:e=>{let{field:{onChange:a,value:s,name:l,ref:r}}=e;return(0,D.jsx)(g.A,{onChange:e=>{const a=e.map((e=>e.value));t("branchIds",a),fe(a)},value:s,customStyles:ye,ref:r,companyId:he,name:l,isDisabled:!he})}}),!E("Branch")&&(0,D.jsx)(c.A,{errorName:_.parent})]}),(0,D.jsxs)("div",{className:"col-xl-3 mb-3",children:[(0,D.jsx)("label",{className:"form-label",children:je("vehicle")}),(0,D.jsx)(o.xI,{name:"vehicleIds",control:T,rules:{required:!0},render:e=>{let{field:{onChange:a,value:s,name:l,ref:r}}=e;return(0,D.jsx)(A.A,{onChange:e=>{const a=e.map((e=>e.value));t("vehicleIds",a)},value:s,branchids:xe,customStyles:ye,ref:r,name:l})}}),!E("Branch")&&(0,D.jsx)(c.A,{errorName:_.parent})]}),(0,D.jsxs)("div",{className:"col-xl-3 mb-3",children:[(0,D.jsxs)("label",{htmlFor:"exampleFormControlInput3",className:"form-label",children:[je("email")," ",(0,D.jsx)("span",{className:"text-danger",children:"*"})]}),(0,D.jsx)(m.A,{type:"email",register:s,label:"Email",className:"form-control",name:"email",defaultValue:Ae[0]?Ae[0].email:"",placeholder:""}),(0,D.jsx)(c.A,{errorName:_.email})]}),(0,D.jsxs)("div",{className:"col-xl-3 mb-3 ",children:[(0,D.jsxs)("label",{className:"form-label",children:[je("username")," ",(0,D.jsx)("span",{className:"text-danger",children:"*"})]}),(0,D.jsx)(m.A,{type:"text",register:s,label:"User Name",name:"userName",placeholder:"",defaultValue:Ae[0]?Ae[0].userName:""}),(0,D.jsx)(c.A,{errorName:_.userName})]}),(0,D.jsxs)("div",{className:"col-xl-3 mb-3 ",children:[(0,D.jsxs)("label",{className:"form-label",children:[je("mobileNumber")," ",(0,D.jsx)("span",{className:"text-danger",children:"*"})]}),(0,D.jsx)(m.A,{type:"text",register:s,label:"Mobile Number",name:"mobileNumber",min:"0",onInput:e=>{const a=Math.max(0,e.target.value);e.target.value=a<1?"":a},placeholder:"",defaultValue:Ae[0]?Ae[0].mobileNumber:""}),(0,D.jsx)(c.A,{errorName:_.mobileNumber})]}),(0,D.jsx)(C.A,{register:s,setValue:t,errors:_,getValues:E,locationData:$e,dValues:null===V||void 0===V?void 0:V[0],id:ge,showCity:!1}),!ge&&(0,D.jsxs)(D.Fragment,{children:[(0,D.jsxs)("div",{className:"col-xl-3 mb-3 ",children:[(0,D.jsxs)("label",{className:"form-label",children:[je("password")," ",(0,D.jsx)("span",{className:"text-danger",children:"*"})]}),(0,D.jsxs)("div",{className:"position-relative",children:[(0,D.jsx)(m.A,{type:re?"text":"password",register:s,label:"Password",name:"password",placeholder:"",defaultValue:Ae[0]?Ae[0].password:""}),(0,D.jsx)("span",{className:"showPasswordIcon",onClick:()=>{te(!re)},children:re?(0,D.jsx)(b.mI_,{}):(0,D.jsx)(b.ZT8,{})})]}),(0,D.jsx)(c.A,{errorName:_.password})]}),(0,D.jsxs)("div",{className:"col-xl-3 mb-3 ",children:[(0,D.jsxs)("label",{className:"form-label",children:[je("confirmPassword")," ",(0,D.jsx)("span",{className:"text-danger",children:"*"})]}),(0,D.jsxs)("div",{className:"position-relative",children:[(0,D.jsx)(m.A,{type:ne?"text":"password",register:s,label:"Confirm Password",name:"confirmPassword",placeholder:"",defaultValue:Ae[0]?Ae[0].confirmPassword:""}),(0,D.jsx)("span",{className:"showPasswordIcon",onClick:()=>{oe(!ne)},children:ne?(0,D.jsx)(b.mI_,{}):(0,D.jsx)(b.ZT8,{})})]}),(0,D.jsx)(c.A,{errorName:_.confirmPassword})]})," "]}),(0,D.jsxs)("div",{className:"col-xl-3 mb-3 ",children:[(0,D.jsxs)("label",{className:"form-label",children:[je("featureTemplate")," ",(0,D.jsx)("span",{className:"text-danger",children:"*"})]}),(0,D.jsx)(o.xI,{name:"featureTemplateId",control:T,rules:{required:!0},render:e=>{let{field:a}=e;return(0,D.jsx)(u.Ay,{onChange:e=>{J(e),t("featureTemplateId",e.value)},options:se,ref:a.ref,name:a.name,styles:ye,value:se.find((e=>e.value===a.value))})}}),!E("featureTemplateId")&&(0,D.jsx)(c.A,{errorName:_.featureTemplateId})]}),(0,D.jsxs)("div",{className:"col-xl-3 mb-3",children:[(0,D.jsxs)("label",{htmlFor:"exampleFormControlInput6",className:"form-label",children:[je("unitOfDistance"),(0,D.jsx)("span",{className:"text-danger",children:"*"})]}),(0,D.jsx)(o.xI,{name:"unitOfDistance",control:T,render:e=>{let{field:{onChange:a,value:s,name:l,ref:r}}=e;return(0,D.jsx)(u.Ay,{onChange:e=>{t("unitOfDistance",e.value),J(e.value)},options:w.jZ,ref:r,name:l,styles:ye,value:{label:E("unitOfDistance"),value:E("unitOfDistance")}})}}),!E("unitOfDistance")&&(0,D.jsx)(c.A,{errorName:_.unitOfDistance})]})]}),(0,D.jsx)("div",{style:{width:"100%",display:"flex",justifyContent:"center",margin:"2rem 0"},children:(0,D.jsxs)(d.A,{type:"submit",onClick:i(n),style:{width:"10%"},children:[" ",je("submit")]})})]})};var _=s(53252),T=s(44988),V=s(60351);const k=e=>{let{Title:a,editData:s,setEditData:d}=e;const{id:u}=(0,r.g)(),{t:c}=(0,x.Bd)(),[m,h]=(0,l.useState)(0),{checkRole:p,checkUserName:b}=(0,v.A)(),j=(p(),b()),y=[c("account")],N=[E],g=(y.length,(0,r.Zp)()),S=(0,r.zy)(),{formData:I}=S.state||{},{register:A,formState:{errors:w},setValue:C,getValues:U,control:k,handleSubmit:G}=(0,o.mN)({resolver:(0,_.t)(u?T.I2:T.it)});console.log(w,"erroe:-");const O=async e=>{if(e.businessUser&&(e.businessGroupId=e.businessUser),e.parentCompany&&(e.companyId=e.parentCompany),e.Branch&&(console.log(e.Branch),e.branchId=e.Branch),u)try{const a=await(0,V.TK)(u,e);a.error?(0,f.U)(a.error):(e._id=a._id,(0,f.V)("User updated successfully !!"),g("/user"))}catch(a){(0,f.U)("Something Went Wrong")}else try{e.role="USER",e.parent=j,e.type="STAFF";const a=await(0,V.kg)(e);a.error?(0,f.U)(a.error):(e._id=a._id,(0,f.V)("User created successfully !!"),g("/user"))}catch(a){(0,f.U)("Something Went Wrong")}};return(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(i.A,{mainTitle:"User",pageTitle:u?"Edit":"Create",parentTitle:"User"}),(0,D.jsx)("div",{className:"m-2 p-2",children:(0,D.jsx)(o.Op,{children:(0,D.jsx)("form",{onSubmit:G(O),children:(0,D.jsx)("div",{className:"default-tab",children:(0,D.jsxs)(t.A.Container,{defaultActiveKey:y[0].toLowerCase(),children:[(0,D.jsx)(n.A,{as:"ul",className:"nav-tabs",children:y.map(((e,a)=>(0,D.jsx)(n.A.Item,{as:"li",children:(0,D.jsx)(n.A.Link,{style:{padding:".5rem 2rem"},eventKey:e.toLowerCase(),active:a===m,onClick:()=>h(a),children:e})},a)))}),(0,D.jsx)(t.A.Content,{className:"pt-4",children:y.map(((e,a)=>{const s=N[a];return(0,D.jsx)(t.A.Pane,{eventKey:e.toLowerCase(),active:a===m,children:(0,D.jsx)(s,{data:y,control:k,setValue:C,register:A,getValues:U,errors:w,onSubmit:O,handleSubmit:G,formData:I})},a)}))})]})})})})})]})}},60306:(e,a,s)=>{s.d(a,{A:()=>n,y:()=>t});var l=s(95441),r=s(74763);(0,l.A)();const t=async e=>{try{let a="/feature-template";void 0!==e&&(a+=`?page=${e}&limit=10`);return(await r.A.get(a)).data}catch(a){return console.error("Error fetching templates:",a),{error:"Couldn't fetch User"}}},n={getTemplates:async e=>{try{return(await r.A.get("/feature-template",e)).data}catch(a){throw console.error("Error fetching modules:",a),a}},createTemplate:async e=>{try{return(await r.A.post("/feature-template",e)).data}catch(a){throw console.error("Error fetching modules:",a),a}},listModule:async e=>{try{return(await r.A.get("/modules",e)).data}catch(a){throw console.error("Error fetching modules:",a),a}},udpateTemplate:async e=>{try{return(await r.A.patch("/feature-template",e)).data}catch(a){throw console.error("Error fetching modules:",a),a}},deleteTemplate:async e=>{try{return(await r.A.delete(`/feature-template/${e}`)).data}catch(a){throw console.error("Error fetching modules:",a),a}}}}}]);
//# sourceMappingURL=87.7d3fe4c1.chunk.js.map