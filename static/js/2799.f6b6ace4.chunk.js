"use strict";(self.webpackChunkFLEET=self.webpackChunkFLEET||[]).push([[2799],{1411:(e,a,s)=>{s.d(a,{A:()=>i});var l=s(65043),r=s(42297),t=(s(86359),s(78247)),n=s(94692),o=s(70579);const i=e=>{let{onChange:a,value:s,customStyles:i,branchids:d,ref:c,isDisabled:u,name:m}=e;const[h,v]=(0,l.useState)([]),[x,p]=(0,l.useState)(s),{page:b}=(0,n.A)();return(0,l.useEffect)((()=>{(async()=>{const e=(await(0,t.kw)(b,d||void 0)).data.map((e=>({label:null===e||void 0===e?void 0:e.vehicleName,value:null===e||void 0===e?void 0:e._id})));v(e)})()}),[b,d]),(0,l.useEffect)((()=>{if(s&&Array.isArray(s)){const e=h.filter((e=>s.some((a=>a===e.value))));p(e)}else p(s)}),[s,h,d]),(0,o.jsx)(r.Ay,{options:h,value:x,onChange:e=>a(e),styles:i,ref:c,name:m,isMulti:!0})}},22799:(e,a,s)=>{s.r(a),s.d(a,{default:()=>k});var l=s(65043),r=s(73216),t=s(44816),n=s(86856),o=s(24858),i=(s(9531),s(9866)),d=s(14282),c=s(42297),u=s(23764),m=s(69367),h=s(13052),v=s(59167),x=(s(72213),s(86151)),p=(s(272),s(35514)),b=s(74117),f=s(42457),j=s(89698),N=s(13931),y=s(42617),g=s(66948),S=s(85539),I=s(12954),w=s(52294),A=(s(83700),s(1411)),C=s(15075),U=s(70579);const E=e=>{let{handleNext:a,register:s,setValue:t,onSubmit:n,handleSubmit:i,getValues:E,errors:_,control:D,formData:T}=e;const[k,V]=(0,l.useState)(""),[O,G]=(0,l.useState)(),[P,F]=(0,l.useState)(""),[B,L]=(0,l.useState)([]),[M,q]=(0,l.useState)([]),[R,H]=(0,l.useState)([]),{checkRole:K,checkUser:W}=(0,v.A)(),[Z,z]=(0,l.useState)(),[J,Q]=(0,l.useState)(0),[Y,X]=(0,l.useState)(0),[$,ee]=(0,l.useState)(!0),[ae,se]=(0,l.useState)([]),[le,re]=(0,l.useState)(!1),[te,ne]=(0,l.useState)(!1),[oe,ie]=(0,l.useState)(!0),[de,ce]=(0,l.useState)(!1),[ue,me]=(0,l.useState)(null),[he,ve]=(0,l.useState)(null),[xe,pe]=(0,l.useState)([]),be=JSON.parse(localStorage.getItem("userDetails")),{t:fe}=(0,b.Bd)(),je={control:e=>({...e,padding:"0.25rem 0 "})};(0,l.useEffect)((()=>{ie(!0),(async()=>{const e=await(0,N.f)(),a=await(0,y.C1)(),s=await(0,g.e3)();if(e.error)(0,f.U)(e.error);else{const a=e.data;L(a);const s=a.map((e=>{var a,s;return{label:null===e||void 0===e||null===(a=e.businessGroupId)||void 0===a?void 0:a.groupName,value:null===e||void 0===e||null===(s=e.businessGroupId)||void 0===s?void 0:s._id}}));Ce(s)}if(a.error)(0,f.U)(a.error);else{const e=a.data.data.data;e.map((e=>{var a,s;return{label:null===(a=e.companyId)||void 0===a?void 0:a.companyName,value:null===(s=e.companyId)||void 0===s?void 0:s._id}}));q(e)}if(s.error)(0,f.U)(s.error);else{const e=s.data.data,a=e.map((e=>({label:e.branchName,value:e._id})));H(e),ke(a)}ie(!1)})()}),[]),(0,l.useEffect)((()=>{(async()=>{const e=await(0,p.y)();if(e.error)(0,f.U)(e.error);else{const a=e.data.data.map((e=>({label:e.name,value:e._id})));se(a)}})()}),[]);const Ne=K(),{id:ye}=(0,r.g)(),ge=localStorage.getItem("loginDetails-name");let Se;Se="SUPER_ADMIN"===Ne?x.filter((e=>"company"===e.role)).map((e=>({label:e.userName,value:e._id}))):x.filter((e=>"company"===e.role&&e.parent===ge)).map((e=>({label:e.userName,value:e._id})));const[Ie,we]=(0,l.useState)([]),[Ae,Ce]=(0,l.useState)([]),[Ue,Ee]=(0,l.useState)([]),[_e,De]=(0,l.useState)([]),[Te,ke]=(0,l.useState)([]),[Ve,Oe]=(0,l.useState)([]),[Ge,Pe]=(0,l.useState)(),[Fe,Be]=(0,l.useState)([]),[Le,Me]=(0,l.useState)(),[qe,Re]=(0,l.useState)(!1),[He,Ke]=(0,l.useState)(!1),[We,Ze]=(0,l.useState)([]);return(0,l.useEffect)((()=>{var e,a,s,l,r,n,o,i;"COMPANY"===be.user.role&&(t("businessGroupId",null===be||void 0===be||null===(e=be.user.businessGroupId[0])||void 0===e?void 0:e._id),t("businessUser",null===be||void 0===be||null===(a=be.user.businessGroupId[0])||void 0===a?void 0:a._id),me(null===be||void 0===be||null===(s=be.user.businessGroupId[0])||void 0===s?void 0:s._id),Re(!0),t("parentCompany",null===be||void 0===be||null===(l=be.user.companyId[0])||void 0===l?void 0:l._id),ve(null===be||void 0===be||null===(r=be.user.companyId[0])||void 0===r?void 0:r._id),Ke(!0));"BUSINESS_GROUP"===be.user.role&&(me(null===be||void 0===be||null===(n=be.user.businessGroupId)||void 0===n?void 0:n._id),t("businessUser",null===be||void 0===be||null===(o=be.user)||void 0===o||null===(i=o.businessGroupId[0])||void 0===i?void 0:i._id),Re(!0))}),[]),(0,l.useEffect)((()=>{var e,a,s,l,r,n,o,i;T&&ye&&(t("businessUser",null===T||void 0===T||null===(e=T[0])||void 0===e?void 0:e.businessGroupId),t("companyId",null===T||void 0===T||null===(a=T[0])||void 0===a?void 0:a.companyId),t("branchIds",null===T||void 0===T||null===(s=T[0])||void 0===s?void 0:s.branchIds),t("vehicleIds",null===T||void 0===T||null===(l=T[0])||void 0===l?void 0:l.vehicleIds),t("email",null===T||void 0===T||null===(r=T[0])||void 0===r?void 0:r.email),t("userName",null===T||void 0===T||null===(n=T[0])||void 0===n?void 0:n.userName),t("mobileNumber",null===T||void 0===T||null===(o=T[0])||void 0===o?void 0:o.mobileNumber),t("country",T[0].country),G({name:T[0].country}),t("state",T[0].state||""),V({name:T[0].state||""}),t("featureTemplateId",null===T||void 0===T||null===(i=T[0])||void 0===i?void 0:i.featureTemplateId),t("unitOfDistance",null===T||void 0===T?void 0:T[0].unitOfDistance))}),[T,ye]),oe?(0,U.jsx)("div",{children:"Loading..."}):(0,U.jsxs)("div",{className:"p-4",children:[(0,U.jsxs)("div",{className:"row",style:{width:"70%",margin:"auto"},children:[(0,U.jsxs)("div",{className:"col-xl-6 mb-3",children:[(0,U.jsx)("label",{className:"form-label",children:fe("businessGroup")}),(0,U.jsx)(o.xI,{name:"businessUser",control:D,rules:{required:!0},render:e=>{let{field:{onChange:a,value:s,name:l,ref:r}}=e;return(0,U.jsx)(w.A,{onChange:async e=>{t("businessUser",e.value),me(e.value),ve(null)},value:s,customStyles:je,ref:r,isDisabled:qe,name:l},ue)}})]}),(0,U.jsxs)("div",{className:"col-xl-6 mb-3",children:[(0,U.jsx)("label",{className:"form-label",children:fe("company")}),(0,U.jsx)(o.xI,{name:"companyId",control:D,rules:{required:!0},render:e=>{let{field:{onChange:a,value:s,name:l,ref:r}}=e;return(0,U.jsx)(I.A,{onChange:async e=>{t("companyId",e.value),ve(e.value)},groupId:ue,value:s,customStyles:je,name:l,ref:r,isDisabled:He},ue)}})]}),(0,U.jsxs)("div",{className:"col-xl-6 mb-3",children:[(0,U.jsx)("label",{className:"form-label",children:fe("branch")}),(0,U.jsx)(o.xI,{name:"branchIds",control:D,rules:{required:!0},render:e=>{let{field:{onChange:a,value:s,name:l,ref:r}}=e;return(0,U.jsx)(S.A,{onChange:e=>{const a=e.map((e=>e.value));t("branchIds",a),pe(a)},value:s,customStyles:je,ref:r,companyId:he,name:l,isDisabled:!he})}}),!E("Branch")&&(0,U.jsx)(u.A,{errorName:_.parent})]}),(0,U.jsxs)("div",{className:"col-xl-6 mb-3",children:[(0,U.jsx)("label",{className:"form-label",children:fe("vehicle")}),(0,U.jsx)(o.xI,{name:"vehicleIds",control:D,rules:{required:!0},render:e=>{let{field:{onChange:a,value:s,name:l,ref:r}}=e;return(0,U.jsx)(A.A,{onChange:e=>{const a=e.map((e=>e.value));t("vehicleIds",a)},value:s,branchids:xe,customStyles:je,ref:r,name:l})}}),!E("Branch")&&(0,U.jsx)(u.A,{errorName:_.parent})]}),(0,U.jsxs)("div",{className:"col-xl-6 mb-3",children:[(0,U.jsxs)("label",{htmlFor:"exampleFormControlInput3",className:"form-label",children:[fe("email")," ",(0,U.jsx)("span",{className:"text-danger",children:"*"})]}),(0,U.jsx)(m.A,{type:"email",register:s,label:"Email",className:"form-control",name:"email",defaultValue:Ie[0]?Ie[0].email:"",placeholder:""}),(0,U.jsx)(u.A,{errorName:_.email})]}),(0,U.jsxs)("div",{className:"col-xl-6 mb-3 ",children:[(0,U.jsxs)("label",{className:"form-label",children:[fe("username")," ",(0,U.jsx)("span",{className:"text-danger",children:"*"})]}),(0,U.jsx)(m.A,{type:"text",register:s,label:"User Name",name:"userName",placeholder:"",defaultValue:Ie[0]?Ie[0].userName:""}),(0,U.jsx)(u.A,{errorName:_.userName})]}),(0,U.jsxs)("div",{className:"col-xl-6 mb-3 ",children:[(0,U.jsxs)("label",{className:"form-label",children:[fe("mobileNumber")," ",(0,U.jsx)("span",{className:"text-danger",children:"*"})]}),(0,U.jsx)(m.A,{type:"text",register:s,label:"Mobile Number",name:"mobileNumber",min:"0",onInput:e=>{const a=Math.max(0,e.target.value);e.target.value=a<1?"":a},placeholder:"",defaultValue:Ie[0]?Ie[0].mobileNumber:""}),(0,U.jsx)(u.A,{errorName:_.mobileNumber})]}),(0,U.jsxs)("div",{className:"col-xl-6 mb-3",children:[(0,U.jsxs)("label",{className:"form-label",children:[fe("country"),(0,U.jsx)("span",{className:"text-danger",children:"*"})]}),(0,U.jsx)(h.b3,{onChange:e=>{V({name:""}),Q(e.id),t("country",e.name),ee(!1)},containerClassName:"bg-white",inputClassName:"border border-white customSelectHeight",placeHolder:"Select Country",defaultValue:O}),!E("country")&&(0,U.jsx)(u.A,{errorName:_.country})]}),(0,U.jsxs)("div",{className:"".concat($?"col-xl-6 mb-3 pe-none":"col-xl-6 mb-3"),children:[(0,U.jsx)("label",{className:"form-label",children:fe("state")}),(0,U.jsx)("div",{style:{background:"white"},children:(0,U.jsx)(h.QO,{countryid:J,onChange:e=>{X(e.id),t("state",e.name)},containerClassName:"bg-white",inputClassName:"border border-white customSelectHeight",placeHolder:"Select State",defaultValue:k})}),!E("state")&&(0,U.jsx)(u.A,{errorName:_.state})]}),!ye&&(0,U.jsxs)(U.Fragment,{children:[(0,U.jsxs)("div",{className:"col-xl-6 mb-3 ",children:[(0,U.jsxs)("label",{className:"form-label",children:[fe("password")," ",(0,U.jsx)("span",{className:"text-danger",children:"*"})]}),(0,U.jsxs)("div",{className:"position-relative",children:[(0,U.jsx)(m.A,{type:le?"text":"password",register:s,label:"Password",name:"password",placeholder:"",defaultValue:Ie[0]?Ie[0].password:""}),(0,U.jsx)("span",{className:"showPasswordIcon",onClick:()=>{re(!le)},children:le?(0,U.jsx)(j.mI_,{}):(0,U.jsx)(j.ZT8,{})})]}),(0,U.jsx)(u.A,{errorName:_.password})]}),(0,U.jsxs)("div",{className:"col-xl-6 mb-3 ",children:[(0,U.jsxs)("label",{className:"form-label",children:[fe("confirmPassword")," ",(0,U.jsx)("span",{className:"text-danger",children:"*"})]}),(0,U.jsxs)("div",{className:"position-relative",children:[(0,U.jsx)(m.A,{type:te?"text":"password",register:s,label:"Confirm Password",name:"confirmPassword",placeholder:"",defaultValue:Ie[0]?Ie[0].confirmPassword:""}),(0,U.jsx)("span",{className:"showPasswordIcon",onClick:()=>{ne(!te)},children:te?(0,U.jsx)(j.mI_,{}):(0,U.jsx)(j.ZT8,{})})]}),(0,U.jsx)(u.A,{errorName:_.confirmPassword})]})," "]}),(0,U.jsxs)("div",{className:"col-xl-6 mb-3 ",children:[(0,U.jsxs)("label",{className:"form-label",children:[fe("featureTemplate")," ",(0,U.jsx)("span",{className:"text-danger",children:"*"})]}),(0,U.jsx)(o.xI,{name:"featureTemplateId",control:D,rules:{required:!0},render:e=>{let{field:a}=e;return(0,U.jsx)(c.Ay,{onChange:e=>{z(e),t("featureTemplateId",e.value)},options:ae,ref:a.ref,name:a.name,styles:je,value:ae.find((e=>e.value===a.value))})}}),!E("featureTemplateId")&&(0,U.jsx)(u.A,{errorName:_.featureTemplateId})]}),(0,U.jsxs)("div",{className:"col-xl-6 mb-3",children:[(0,U.jsxs)("label",{htmlFor:"exampleFormControlInput6",className:"form-label",children:[fe("unitOfDistance"),(0,U.jsx)("span",{className:"text-danger",children:"*"})]}),(0,U.jsx)(o.xI,{name:"unitOfDistance",control:D,render:e=>{let{field:{onChange:a,value:s,name:l,ref:r}}=e;return(0,U.jsx)(c.Ay,{onChange:e=>{t("unitOfDistance",e.value),z(e.value)},options:C.jZ,ref:r,name:l,styles:je,value:{label:E("unitOfDistance"),value:E("unitOfDistance")}})}}),!E("unitOfDistance")&&(0,U.jsx)(u.A,{errorName:_.unitOfDistance})]})]}),(0,U.jsx)("div",{style:{width:"100%",display:"flex",justifyContent:"center",margin:"2rem 0"},children:(0,U.jsxs)(d.A,{type:"submit",onClick:i(n),style:{width:"10%"},children:[" ",fe("submit")]})})]})};var _=s(18403),D=s(87742),T=s(78919);const k=e=>{let{Title:a,editData:s,setEditData:d}=e;const{id:c}=(0,r.g)(),{t:u}=(0,b.Bd)(),[m,h]=(0,l.useState)(0),{checkRole:x,checkUserName:p}=(0,v.A)(),j=(x(),p()),N=[u("account")],y=[E],g=(N.length,(0,r.Zp)()),S=(0,r.zy)(),{formData:I}=S.state||{},{register:w,formState:{errors:A},setValue:C,getValues:k,control:V,handleSubmit:O}=(0,o.mN)({resolver:(0,_.t)(c?D.I2:D.it)});console.log(A,"erroe:-");const G=async e=>{if(e.businessUser&&(e.businessGroupId=e.businessUser),e.parentCompany&&(e.companyId=e.parentCompany),e.Branch&&(console.log(e.Branch),e.branchId=e.Branch),c)try{const a=await(0,T.TK)(c,e);a.error?(0,f.U)(a.error):(e._id=a._id,(0,f.V)("User updated successfully !!"),g("/user"))}catch(a){(0,f.U)("Something Went Wrong")}else try{e.role="USER",e.parent=j,e.type="STAFF";const a=await(0,T.kg)(e);a.error?(0,f.U)(a.error):(e._id=a._id,(0,f.V)("User created successfully !!"),g("/user"))}catch(a){(0,f.U)("Something Went Wrong")}};return(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(i.A,{mainTitle:"User",pageTitle:c?"Edit":"Create",parentTitle:"User"}),(0,U.jsx)("div",{className:"m-2 p-2",children:(0,U.jsx)(o.Op,{children:(0,U.jsx)("form",{onSubmit:O(G),children:(0,U.jsx)("div",{className:"default-tab",children:(0,U.jsxs)(t.A.Container,{defaultActiveKey:N[0].toLowerCase(),children:[(0,U.jsx)(n.A,{as:"ul",className:"nav-tabs",children:N.map(((e,a)=>(0,U.jsx)(n.A.Item,{as:"li",children:(0,U.jsx)(n.A.Link,{style:{padding:".5rem 2rem"},eventKey:e.toLowerCase(),active:a===m,onClick:()=>h(a),children:e})},a)))}),(0,U.jsx)(t.A.Content,{className:"pt-4",children:N.map(((e,a)=>{const s=y[a];return(0,U.jsx)(t.A.Pane,{eventKey:e.toLowerCase(),active:a===m,children:(0,U.jsx)(s,{data:N,control:V,setValue:C,register:w,getValues:k,errors:A,onSubmit:G,handleSubmit:O,formData:I})},a)}))})]})})})})})]})}},35514:(e,a,s)=>{s.d(a,{A:()=>n,y:()=>t});var l=s(88472),r=s(77154);(0,l.A)();const t=async e=>{try{let a="/feature-template";void 0!==e&&(a+="?page=".concat(e,"&limit=",10));return(await r.A.get(a)).data}catch(a){return console.error("Error fetching templates:",a),{error:"Couldn't fetch User"}}},n={getTemplates:async e=>{try{return(await r.A.get("/feature-template",e)).data}catch(a){throw console.error("Error fetching modules:",a),a}},createTemplate:async e=>{try{return(await r.A.post("/feature-template",e)).data}catch(a){throw console.error("Error fetching modules:",a),a}},listModule:async e=>{try{return(await r.A.get("/modules",e)).data}catch(a){throw console.error("Error fetching modules:",a),a}},udpateTemplate:async e=>{try{return(await r.A.patch("/feature-template",e)).data}catch(a){throw console.error("Error fetching modules:",a),a}},deleteTemplate:async e=>{try{return(await r.A.delete("/feature-template/".concat(e))).data}catch(a){throw console.error("Error fetching modules:",a),a}}}}}]);
//# sourceMappingURL=2799.f6b6ace4.chunk.js.map