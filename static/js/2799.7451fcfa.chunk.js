"use strict";(self.webpackChunkFLEET=self.webpackChunkFLEET||[]).push([[2799],{22799:(e,a,s)=>{s.r(a),s.d(a,{default:()=>E});var l=s(65043),r=s(73216),t=s(44816),n=s(86856),o=s(24858),i=(s(9531),s(9866)),d=s(14282),c=s(42297),u=s(23764),m=s(69367),h=s(13052),p=s(59167),v=(s(72213),s(86151)),x=(s(272),s(35514)),b=s(74117),f=s(42457),j=s(89698),g=s(13931),N=s(42617),y=s(66948),S=(s(85539),s(12954)),w=s(52294),I=s(83700),A=s(70579);const C=e=>{let{handleNext:a,register:s,setValue:t,onSubmit:n,handleSubmit:i,getValues:C,errors:U,control:_,formData:T}=e;const[E,k]=(0,l.useState)(""),[V,G]=(0,l.useState)(),[P,D]=(0,l.useState)(""),[B,F]=(0,l.useState)([]),[L,M]=(0,l.useState)([]),[O,R]=(0,l.useState)([]),{checkRole:q,checkUser:H}=(0,p.A)(),[K,W]=(0,l.useState)(),[Z,z]=(0,l.useState)(0),[J,Q]=(0,l.useState)(0),[Y,X]=(0,l.useState)(!0),[$,ee]=(0,l.useState)([]),[ae,se]=(0,l.useState)(!1),[le,re]=(0,l.useState)(!1),[te,ne]=(0,l.useState)(!0),[oe,ie]=(0,l.useState)(!1),[de,ce]=(0,l.useState)(null),[ue,me]=(0,l.useState)(null),he=JSON.parse(localStorage.getItem("userDetails")),{t:pe}=(0,b.Bd)(),ve={control:e=>({...e,padding:"0.25rem 0 "})};(0,l.useEffect)((()=>{ne(!0),(async()=>{const e=await(0,g.f)(),a=await(0,N.C1)(),s=await(0,y.e3)();if(e.error)(0,f.U)(e.error);else{const a=e.data;F(a);const s=a.map((e=>{var a,s;return{label:null===e||void 0===e||null===(a=e.businessGroupId)||void 0===a?void 0:a.groupName,value:null===e||void 0===e||null===(s=e.businessGroupId)||void 0===s?void 0:s._id}}));Se(s)}if(a.error)(0,f.U)(a.error);else{const e=a.data.data.data;e.map((e=>{var a,s;return{label:null===(a=e.companyId)||void 0===a?void 0:a.companyName,value:null===(s=e.companyId)||void 0===s?void 0:s._id}}));M(e)}if(s.error)(0,f.U)(s.error);else{const e=s.data.data,a=e.map((e=>({label:e.branchName,value:e._id})));R(e),_e(a)}ne(!1)})()}),[]),(0,l.useEffect)((()=>{(async()=>{const e=await(0,x.y)();if(e.error)(0,f.U)(e.error);else{const a=e.data.data.map((e=>({label:e.name,value:e._id})));ee(a)}})()}),[]);const xe=q(),{id:be}=(0,r.g)(),fe=localStorage.getItem("loginDetails-name");let je;je="SUPER_ADMIN"===xe?v.filter((e=>"company"===e.role)).map((e=>({label:e.userName,value:e._id}))):v.filter((e=>"company"===e.role&&e.parent===fe)).map((e=>({label:e.userName,value:e._id})));const[ge,Ne]=(0,l.useState)([]),[ye,Se]=(0,l.useState)([]),[we,Ie]=(0,l.useState)([]),[Ae,Ce]=(0,l.useState)([]),[Ue,_e]=(0,l.useState)([]),[Te,Ee]=(0,l.useState)([]),[ke,Ve]=(0,l.useState)(),[Ge,Pe]=(0,l.useState)([]),[De,Be]=(0,l.useState)(),[Fe,Le]=(0,l.useState)(!1),[Me,Oe]=(0,l.useState)(!1),[Re,qe]=(0,l.useState)([]);return(0,l.useEffect)((()=>{var e,a,s,l,r,n,o,i,d;"COMPANY"===he.user.role&&(t("businessGroupId",null===he||void 0===he||null===(e=he.user.businessGroupId[0])||void 0===e?void 0:e._id),t("businessUser",null===he||void 0===he||null===(a=he.user.businessGroupId[0])||void 0===a?void 0:a._id),ce(null===he||void 0===he||null===(s=he.user.businessGroupId[0])||void 0===s?void 0:s._id),Le(!0),t("parentCompany",null===he||void 0===he||null===(l=he.user.companyId[0])||void 0===l?void 0:l._id),me(null===he||void 0===he||null===(r=he.user.companyId[0])||void 0===r?void 0:r._id),Oe(!0),console.log("parentCompany",null===he||void 0===he||null===(n=he.user.businessGroupId[0])||void 0===n?void 0:n._id));"BUSINESS_GROUP"===he.user.role&&(ce(null===he||void 0===he||null===(o=he.user.businessGroupId)||void 0===o?void 0:o._id),t("businessUser",null===he||void 0===he||null===(i=he.user)||void 0===i||null===(d=i.businessGroupId[0])||void 0===d?void 0:d._id),console.log(he.user.businessGroupId[0]._id,"dsggsgs"),Le(!0))}),[]),(0,l.useEffect)((()=>{var e,a,s,l,r,n,o,i;T&&be&&(t("businessUser",null===T||void 0===T||null===(e=T[0])||void 0===e?void 0:e.businessGroupId),t("companyId",null===T||void 0===T||null===(a=T[0])||void 0===a?void 0:a.companyId),t("branchIds",null===T||void 0===T||null===(s=T[0])||void 0===s||null===(l=s.branchIds[0])||void 0===l?void 0:l._id),t("email",null===T||void 0===T||null===(r=T[0])||void 0===r?void 0:r.email),t("userName",null===T||void 0===T||null===(n=T[0])||void 0===n?void 0:n.userName),t("mobileNumber",null===T||void 0===T||null===(o=T[0])||void 0===o?void 0:o.mobileNumber),t("country",T[0].country),G({name:T[0].country}),t("state",T[0].state||""),k({name:T[0].state||""}),t("featureTemplateId",null===T||void 0===T||null===(i=T[0])||void 0===i?void 0:i.featureTemplateId))}),[T,be]),te?(0,A.jsx)("div",{children:"Loading..."}):(0,A.jsxs)("div",{className:"p-4",children:[(0,A.jsxs)("div",{className:"row",style:{width:"70%",margin:"auto"},children:[(0,A.jsxs)("div",{className:"col-xl-6 mb-3",children:[(0,A.jsx)("label",{className:"form-label",children:pe("businessGroup")}),(0,A.jsx)(o.xI,{name:"businessUser",control:_,rules:{required:!0},render:e=>{let{field:{onChange:a,value:s,name:l,ref:r}}=e;return(0,A.jsx)(w.A,{onChange:async e=>{t("businessUser",e.value),ce(e.value),me(null)},value:s,customStyles:ve,ref:r,isDisabled:Fe,name:l},de)}})]}),(0,A.jsxs)("div",{className:"col-xl-6 mb-3",children:[(0,A.jsx)("label",{className:"form-label",children:pe("company")}),(0,A.jsx)(o.xI,{name:"parentCompany",control:_,rules:{required:!0},render:e=>{let{field:{onChange:a,value:s,name:l,ref:r}}=e;return(0,A.jsx)(S.A,{onChange:async e=>{t("parentCompany",e.value),me(e.value)},groupId:de,value:s,customStyles:ve,name:l,ref:r,isDisabled:Me},de)}})]}),(0,A.jsxs)("div",{className:"col-xl-6 mb-3",children:[(0,A.jsx)("label",{className:"form-label",children:pe("branch")}),(0,A.jsx)(o.xI,{name:"Branch",control:_,rules:{required:!0},render:e=>{let{field:{onChange:a,value:s,name:l,ref:r}}=e;return(0,A.jsx)(I.A,{companyId:ue,onChange:e=>{t("Branch",e.value),t("branchIds",e.value)},value:s,customStyles:ve,ref:r,isDisabled:!ue,name:l},ue)}}),!C("Branch")&&(0,A.jsx)(u.A,{errorName:U.parent})]}),(0,A.jsxs)("div",{className:"col-xl-6 mb-3",children:[(0,A.jsxs)("label",{htmlFor:"exampleFormControlInput3",className:"form-label",children:[pe("email")," ",(0,A.jsx)("span",{className:"text-danger",children:"*"})]}),(0,A.jsx)(m.A,{type:"email",register:s,label:"Email",className:"form-control",name:"email",defaultValue:ge[0]?ge[0].email:"",placeholder:""}),(0,A.jsx)(u.A,{errorName:U.email})]}),(0,A.jsxs)("div",{className:"col-xl-6 mb-3 ",children:[(0,A.jsxs)("label",{className:"form-label",children:[pe("username")," ",(0,A.jsx)("span",{className:"text-danger",children:"*"})]}),(0,A.jsx)(m.A,{type:"text",register:s,label:"User Name",name:"userName",placeholder:"",defaultValue:ge[0]?ge[0].userName:""}),(0,A.jsx)(u.A,{errorName:U.userName})]}),(0,A.jsxs)("div",{className:"col-xl-6 mb-3 ",children:[(0,A.jsxs)("label",{className:"form-label",children:[pe("mobileNumber")," ",(0,A.jsx)("span",{className:"text-danger",children:"*"})]}),(0,A.jsx)(m.A,{type:"text",register:s,label:"Mobile Number",name:"mobileNumber",min:"0",onInput:e=>{const a=Math.max(0,e.target.value);e.target.value=a<1?"":a},placeholder:"",defaultValue:ge[0]?ge[0].mobileNumber:""}),(0,A.jsx)(u.A,{errorName:U.mobileNumber})]}),(0,A.jsxs)("div",{className:"col-xl-6 mb-3",children:[(0,A.jsxs)("label",{className:"form-label",children:[pe("country"),(0,A.jsx)("span",{className:"text-danger",children:"*"})]}),(0,A.jsx)(h.b3,{onChange:e=>{k({name:""}),z(e.id),t("country",e.name),X(!1)},containerClassName:"bg-white",inputClassName:"border border-white customSelectHeight",placeHolder:"Select Country",defaultValue:V}),!C("country")&&(0,A.jsx)(u.A,{errorName:U.country})]}),(0,A.jsxs)("div",{className:"".concat(Y?"col-xl-6 mb-3 pe-none":"col-xl-6 mb-3"),children:[(0,A.jsx)("label",{className:"form-label",children:pe("state")}),(0,A.jsx)("div",{style:{background:"white"},children:(0,A.jsx)(h.QO,{countryid:Z,onChange:e=>{Q(e.id),t("state",e.name)},containerClassName:"bg-white",inputClassName:"border border-white customSelectHeight",placeHolder:"Select State",defaultValue:E})}),!C("state")&&(0,A.jsx)(u.A,{errorName:U.state})]}),!be&&(0,A.jsxs)(A.Fragment,{children:[(0,A.jsxs)("div",{className:"col-xl-6 mb-3 ",children:[(0,A.jsxs)("label",{className:"form-label",children:[pe("password")," ",(0,A.jsx)("span",{className:"text-danger",children:"*"})]}),(0,A.jsxs)("div",{className:"position-relative",children:[(0,A.jsx)(m.A,{type:ae?"text":"password",register:s,label:"Password",name:"password",placeholder:"",defaultValue:ge[0]?ge[0].password:""}),(0,A.jsx)("span",{className:"showPasswordIcon",onClick:()=>{se(!ae)},children:ae?(0,A.jsx)(j.mI_,{}):(0,A.jsx)(j.ZT8,{})})]}),(0,A.jsx)(u.A,{errorName:U.password})]}),(0,A.jsxs)("div",{className:"col-xl-6 mb-3 ",children:[(0,A.jsxs)("label",{className:"form-label",children:[pe("confirmPassword")," ",(0,A.jsx)("span",{className:"text-danger",children:"*"})]}),(0,A.jsxs)("div",{className:"position-relative",children:[(0,A.jsx)(m.A,{type:le?"text":"password",register:s,label:"Confirm Password",name:"confirmPassword",placeholder:"",defaultValue:ge[0]?ge[0].confirmPassword:""}),(0,A.jsx)("span",{className:"showPasswordIcon",onClick:()=>{re(!le)},children:le?(0,A.jsx)(j.mI_,{}):(0,A.jsx)(j.ZT8,{})})]}),(0,A.jsx)(u.A,{errorName:U.confirmPassword})]})," "]}),(0,A.jsxs)("div",{className:"col-xl-6 mb-3 ",children:[(0,A.jsxs)("label",{className:"form-label",children:[pe("featureTemplate")," ",(0,A.jsx)("span",{className:"text-danger",children:"*"})]}),(0,A.jsx)(o.xI,{name:"featureTemplateId",control:_,rules:{required:!0},render:e=>{let{field:a}=e;return(0,A.jsx)(c.Ay,{onChange:e=>{W(e),t("featureTemplateId",e.value)},options:$,ref:a.ref,name:a.name,styles:ve,value:$.find((e=>e.value===a.value))})}}),!C("featureTemplateId")&&(0,A.jsx)(u.A,{errorName:U.featureTemplateId})]}),(0,A.jsx)("div",{className:"col-xl-6 mb-3 "})]}),(0,A.jsx)("div",{style:{width:"100%",display:"flex",justifyContent:"center",margin:"2rem 0"},children:(0,A.jsxs)(d.A,{type:"submit",onClick:i(n),style:{width:"10%"},children:[" ",pe("submit")]})})]})};var U=s(18403),_=s(87742),T=s(78919);const E=e=>{let{Title:a,editData:s,setEditData:d}=e;const{t:c}=(0,b.Bd)(),[u,m]=(0,l.useState)(0),{checkRole:h,checkUserName:v}=(0,p.A)(),x=(h(),v()),j=[c("account")],g=[C],N=(j.length,(0,r.Zp)()),y=(0,r.zy)(),{formData:S}=y.state||{};console.log(S,"datahgf:-");const{register:w,formState:{errors:I},setValue:E,getValues:k,control:V,handleSubmit:G}=(0,o.mN)({resolver:(0,U.t)(_.it)}),P=async e=>{if(console.log(e,"this is data"),e.businessUser&&(e.businessGroupId=e.businessUser),e.parentCompany&&(e.companyId=e.parentCompany),e.Branch&&(console.log(e.Branch),e.branchId=e.Branch),D)try{const a=await(0,T.TK)(D,e);console.log("this is response",a),a.error?(0,f.U)(a.error):(e._id=a._id,(0,f.V)("User updated successfully !!"),N("/user"))}catch(a){(0,f.U)("Something Went Wrong")}else try{e.role="USER",e.parent=x,e.type="STAFF";const a=await(0,T.kg)(e);console.log("this is response",a),a.error?(0,f.U)(a.error):(e._id=a._id,(0,f.V)("User created successfully !!"),N("/user"))}catch(a){(0,f.U)("Something Went Wrong")}},{id:D}=(0,r.g)();return(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(i.A,{mainTitle:"User",pageTitle:D?"Edit":"Create",parentTitle:"User"}),(0,A.jsx)("div",{className:"m-2 p-2",children:(0,A.jsx)(o.Op,{children:(0,A.jsx)("form",{onSubmit:G(P),children:(0,A.jsx)("div",{className:"default-tab",children:(0,A.jsxs)(t.A.Container,{defaultActiveKey:j[0].toLowerCase(),children:[(0,A.jsx)(n.A,{as:"ul",className:"nav-tabs",children:j.map(((e,a)=>(0,A.jsx)(n.A.Item,{as:"li",children:(0,A.jsx)(n.A.Link,{style:{padding:".5rem 2rem"},eventKey:e.toLowerCase(),active:a===u,onClick:()=>m(a),children:e})},a)))}),(0,A.jsx)(t.A.Content,{className:"pt-4",children:j.map(((e,a)=>{const s=g[a];return(0,A.jsx)(t.A.Pane,{eventKey:e.toLowerCase(),active:a===u,children:(0,A.jsx)(s,{data:j,control:V,setValue:E,register:w,getValues:k,errors:I,onSubmit:P,handleSubmit:G,formData:S})},a)}))})]})})})})})]})}},35514:(e,a,s)=>{s.d(a,{A:()=>n,y:()=>t});var l=s(88472),r=s(77154);(0,l.A)();const t=async e=>{try{console.log("page is here ",e);let a="/feature-template";void 0!==e&&(a+="?page=".concat(e,"&limit=",10));return(await r.A.get(a)).data}catch(a){return console.error("Error fetching templates:",a),{error:"Couldn't fetch User"}}},n={getTemplates:async e=>{try{return(await r.A.get("/feature-template",e)).data}catch(a){throw console.error("Error fetching modules:",a),a}},createTemplate:async e=>{try{console.log(e);return(await r.A.post("/feature-template",e)).data}catch(a){throw console.error("Error fetching modules:",a),a}},listModule:async e=>{try{return(await r.A.get("/modules",e)).data}catch(a){throw console.error("Error fetching modules:",a),a}},udpateTemplate:async e=>{try{return(await r.A.patch("/feature-template",e)).data}catch(a){throw console.error("Error fetching modules:",a),a}},deleteTemplate:async e=>{try{return(await r.A.delete("/feature-template/".concat(e))).data}catch(a){throw console.error("Error fetching modules:",a),a}}}}}]);
//# sourceMappingURL=2799.7451fcfa.chunk.js.map