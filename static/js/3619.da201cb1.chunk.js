"use strict";(self.webpackChunkFLEET=self.webpackChunkFLEET||[]).push([[3619],{23619:(e,s,a)=>{a.r(s),a.d(s,{default:()=>S});var l=a(65043),r=a(42297),t=a(99419),n=a(12023),c=a(76036),o=a(13318),i=a(62559),d=a(15560),u=a(70579);const m=e=>{var s,a;let{geofenceHanlder:r,setValue:m,watch:x,getValues:h,errors:g}=e;const[p,v]=l.useState({type:"FeatureCollection",features:[]}),f=null!==(s=null===(a=x("location"))||void 0===a?void 0:a.length)&&void 0!==s?s:0;return(0,u.jsx)("div",{style:{display:"flex",height:"85vh",border:g.location?"3px solid #ff5e5e":null},children:(0,u.jsx)("div",{style:{width:"100%"},children:(0,u.jsxs)(t.W,{center:[25.2233,55.2869],zoom:14,zoomControl:!1,children:[(0,u.jsx)(n.e,{attribution:'\xa9 <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"http://{s}.tile.osm.org/{z}/{x}/{y}.png"}),(0,u.jsxs)(c.p,{styles:{background:"red"},position:[25.2233,55.2869],children:[(0,u.jsx)(o.z,{children:"Dubai Trade Center"}),(0,u.jsx)(i.m,{children:"Dubai Trade Center"})]}),(0,u.jsx)(d.A,{setValues:m,geofenceHanlder:r,watch:x,getValues:h},f)]})})})};var x=a(69367),h=a(24858),g=a(18403),p=a(87742),v=a(15075),f=a(14282),j=a(23764),b=a(42457),N=a(73216),y=a(7995),A=a(74117),C=a(12954);const S=()=>{const[e,s]=(0,l.useState)(null),[a,t]=(0,l.useState)(),[n,c]=(0,l.useState)(),[o,i]=(0,l.useState)(null),d=(0,N.Zp)(),{id:S}=(0,N.g)(),[I,w]=(0,l.useState)(),[k,V]=(0,l.useState)(!1),F=JSON.parse(localStorage.getItem("userDetails")),D={control:e=>({...e,padding:".25rem 0 "})};(0,l.useEffect)((()=>{"COMPANY"===F.user.role&&(L("businessGroupId",null===F||void 0===F?void 0:F.user.businessGroupId),i(null===F||void 0===F?void 0:F.user.businessGroupId),L("companyId",null===F||void 0===F?void 0:F.user.companyId),w(null===F||void 0===F?void 0:F.user.companyId),V(!0)),"BUSINESS_GROUP"===F.user.role&&(L("businessGroupId",null===F||void 0===F?void 0:F.user.businessGroupId),i(null===F||void 0===F?void 0:F.user.businessGroupId)),S&&(async()=>{if(S){const{data:e}=await(0,y.LN)(S);t(e),U(e),s(e.geofenceAccess)}})()}),[S]);const{register:G,formState:{errors:E},setValue:L,watch:O,getValues:P,control:T,handleSubmit:z,reset:U}=(0,h.mN)({resolver:(0,g.t)(p._8),defaultValues:{category:v.rF[0].value,tolerance:v.gY[0].value}}),B=e=>{s(e.target.value),L("geofenceAccess",e.target.value)},q=async e=>{try{if(S){const{success:s}=await(0,y.ck)(S,e);return void(s&&((0,b.V)("Geofence updated successfully!"),d("/settings/geofence")))}{const{success:s}=await(0,y.vo)(e);return void(s&&((0,b.V)("New Geofence Created!"),d("/settings/geofence")))}}catch(s){return console.log(s),void(0,b.U)("Some error occured !!")}},M=JSON.parse(localStorage.getItem("geofenceData")),R=null===M||void 0===M?void 0:M.filter((e=>e.id==S)),[Y,H]=(0,l.useState)(R),{t:J}=(0,A.Bd)();return(0,u.jsxs)("div",{children:[(0,u.jsx)("div",{style:{padding:"10px",backgroundColor:"#FFFDFD"},children:(0,u.jsxs)("h2",{style:{fontSize:"20px"},children:[J("geofenceDetail"),"l"]})}),(0,u.jsxs)("div",{className:"",style:{display:"flex",height:"88vh"},children:[(0,u.jsx)("div",{className:"col-md-3",style:{padding:"15px",boxShadow:"9px 0 4px rgba(0, 0, 0, 0.1)",backgroundColor:"#fff",overflow:"auto"},children:(0,u.jsx)(h.Op,{children:(0,u.jsxs)("form",{onSubmit:z(q),children:[(0,u.jsxs)("div",{className:"mb-2",children:[(0,u.jsxs)("label",{htmlFor:"company",className:"form-label",children:[J("company"),":",(0,u.jsx)("span",{className:"text-danger",children:"*"})]}),(0,u.jsx)(h.xI,{name:"company",control:T,rules:{required:!0},render:e=>{let{field:{onChange:s,value:a,name:l,ref:r}}=e;return(0,u.jsx)(C.A,{groupId:o,onChange:e=>{L("company",e.value),L("companyName",e.value),w(e.value)},value:a,customStyles:D,ref:r,isDisabled:k,name:l},o)}}),(0,u.jsx)(j.A,{errorName:E.company})]}),(0,u.jsxs)("div",{className:"mb-2",children:[(0,u.jsxs)("label",{htmlFor:"company",className:"form-label",children:[J("name"),":",(0,u.jsx)("span",{className:"text-danger",children:"*"})]}),(0,u.jsx)(x.A,{type:"text",label:"Name",register:G,name:"name"}),(0,u.jsx)(j.A,{errorName:E.name})]}),(0,u.jsxs)("div",{className:"mb-3",children:[(0,u.jsxs)("label",{className:"form-label",children:[J("category"),":",(0,u.jsx)("span",{className:"text-danger",children:"*"})]}),(0,u.jsx)(h.xI,{name:"category",control:T,rules:{required:!0},render:e=>{let{field:{onChange:s,value:a,name:l,ref:t}}=e;return(0,u.jsx)(r.Ay,{onChange:e=>{c(e.value),L("category",e.value)},options:v.rF,ref:t,name:l,styles:D,value:{value:a,label:a}})}}),!P("category")&&(0,u.jsx)(j.A,{errorName:E.category})]}),(0,u.jsxs)("div",{className:"mb-3",children:[(0,u.jsxs)("label",{className:"form-label",children:[J("geofenceAccess"),":",(0,u.jsx)("span",{className:"text-danger",children:"*"})]}),(0,u.jsxs)("div",{style:{display:"flex",flexDirection:"row",gap:"5rem"},children:[(0,u.jsxs)("div",{className:"form-check",children:[(0,u.jsx)("input",{type:"radio",className:"form-check-input",value:"PUBLIC",checked:"PUBLIC"===e,onChange:B}),(0,u.jsx)("label",{className:"form-check-label",children:J("public")})]}),(0,u.jsxs)("div",{className:"form-check",children:[(0,u.jsx)("input",{type:"radio",className:"form-check-input",value:"PRIVATE",checked:"PRIVATE"===e,onChange:B}),(0,u.jsx)("label",{className:"form-check-label",children:J("private")})]})]}),!P("geofenceAccess")&&(0,u.jsx)(j.A,{errorName:E.geofenceAccess})]}),(0,u.jsxs)("div",{className:"mb-3",children:[(0,u.jsxs)("label",{htmlFor:"contactNumber",className:"form-label",children:[J("contactNumber"),":",(0,u.jsx)("span",{className:"text-danger",children:"*"})]}),(0,u.jsx)(x.A,{type:"number",register:G,label:"Contact Number",name:"contactNumber",min:"0",onInput:e=>{const s=Math.max(0,e.target.value);e.target.value=s<1?"":s}}),(0,u.jsx)(j.A,{errorName:E.contactNumber})]}),(0,u.jsxs)("div",{className:"mb-3",children:[(0,u.jsxs)("label",{htmlFor:"address",className:"form-label",children:[J("address"),":"]}),(0,u.jsx)("textarea",{className:"form-control",...G("address"),label:"Address",name:"address"})]}),(0,u.jsxs)("div",{className:"mb-3",children:[(0,u.jsxs)("label",{className:"form-label",children:[J("tolerance"),":",(0,u.jsx)("span",{className:"text-danger",children:"*"})]}),(0,u.jsx)(h.xI,{name:"tolerance",control:T,rules:{required:!0},render:e=>{let{field:{onChange:s,value:a,name:l,ref:t}}=e;return(0,u.jsx)(r.Ay,{onChange:e=>{c(e.value),L("tolerance",e.value)},options:v.gY,ref:t,name:l,styles:D,value:{label:a,value:a}})}}),!P("tolerance")&&(0,u.jsx)(j.A,{errorName:E.tolerance})]}),(0,u.jsxs)("div",{className:"mb-3",children:[(0,u.jsxs)("label",{className:"form-label",children:[J("description"),":"]}),(0,u.jsx)("textarea",{className:"form-control",...G("description"),name:"description",label:"Description"})]}),!P("location")&&(0,u.jsx)(j.A,{errorName:E.location}),(0,u.jsx)("div",{style:{width:"100%",display:"flex",justifyContent:"center",margin:"2rem 0"},children:(0,u.jsxs)(f.A,{type:"submit",onClick:z(q),children:[" ",J("submit")]})})]})})}),(0,u.jsx)("div",{className:"col-md-9",style:{paddingLeft:"15px"},children:(0,u.jsx)(m,{setValue:L,watch:O,getValues:P,defaultValues:a,errors:E})})]})]})}},7995:(e,s,a)=>{a.d(s,{LN:()=>c,bx:()=>r,ck:()=>o,mG:()=>t,vo:()=>n});var l=a(77154);const r=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;return(await l.A.get("/geofences?page=".concat(e,"&limit=").concat(s))).data.data},t=async e=>{const{data:s}=await l.A.delete("/geofences/".concat(e));return s},n=async e=>{const{data:s}=await l.A.post("/geofences",e);return s},c=async e=>{const{data:s}=await l.A.get("/geofences/".concat(e));return s},o=async(e,s)=>{const{data:a}=await l.A.patch("/geofences/".concat(e),s);return a}}}]);
//# sourceMappingURL=3619.da201cb1.chunk.js.map