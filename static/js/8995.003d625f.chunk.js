"use strict";(self.webpackChunkFLEET=self.webpackChunkFLEET||[]).push([[8995],{48995:(e,a,s)=>{s.r(a),s.d(a,{default:()=>w});var l=s(65043),t=s(73216),n=s(35475),r=s(9866),i=s(6720),c=s(60184),o=s(51359),d=(s(71232),s(59167),s(10966)),m=s(70579);const h=e=>{let{onConfirmDelete:a,params:s,currentPage:l,itemsPerPage:t,tempValue:r,tempValue2:h,tableData:p,editDrawerOpen:u,setDataLength:g}=e;var x=p;const{can:b}=(0,d.S)(),f=b("branch","modify"),j=b("branch","delete");"All Companies"!==r&&(x=p.filter((e=>"branch"===e.role&&e.parentCompany===r))),"All Branches"!==h&&(x=p.filter((e=>"branch"===e.role&&e.parentBranch===h)));for(var v=[],N=0;N<x.length;N++){const e=x[N].userName;v[N]=x.filter((a=>a.parentBranch===e)).length}const y=(l-1)*t+1;return(0,m.jsx)(m.Fragment,{children:x.map(((e,s)=>{var l,t,r,d,h,p;return(0,m.jsxs)("tr",{children:[(0,m.jsx)("td",{children:(0,m.jsx)("span",{children:y+s})}),(0,m.jsx)("td",{children:(0,m.jsx)("span",{className:"text-primary",children:e.branchName})}),(0,m.jsx)("td",{children:(0,m.jsx)("span",{children:null!==(l=e.parentBranchId)&&void 0!==l&&l.branchName?null===(t=e.parentBranchId)||void 0===t?void 0:t.branchName:(0,m.jsx)("span",{className:"ps-4",children:"-"})})}),(0,m.jsx)("td",{children:(0,m.jsx)("span",{children:null!==(r=e.companyId)&&void 0!==r&&r.companyName?null===(d=e.companyId)||void 0===d?void 0:d.companyName:(0,m.jsx)("span",{className:"ps-4",children:"-"})})}),(0,m.jsx)("td",{children:(0,m.jsx)("span",{children:null!==(h=e.businessGroupId)&&void 0!==h&&h.groupName?null===(p=e.businessGroupId)||void 0===p?void 0:p.groupName:(0,m.jsx)("span",{className:"ps-4",children:"-"})})}),(0,m.jsx)("td",{children:(0,m.jsx)("span",{children:e.city})}),(0,m.jsx)("td",{children:(0,m.jsx)(n.N_,{to:"/branch/bid/".concat(e.id),className:"text-primary badge light border-0 badge-count",children:v[s]})}),(f||j)&&(0,m.jsx)("td",{children:(0,m.jsxs)("span",{className:"d-flex justify-content-center",children:[f&&(0,m.jsx)("span",{className:"cursor-pointer",onClick:()=>u(e._id),children:(0,m.jsx)(c.uO9,{style:{color:"green",fontSize:"1.2rem"}})}),j&&(0,m.jsx)(o.A,{className:"cursor-pointer ",onConfirmDelete:a,id:e._id,children:(0,m.jsx)(i.b6i,{style:{color:"red",fontSize:"1.2rem"}})})]})})]},s)}))})};var p=s(24858),u=(s(99482),s(74117)),g=s(58387),x=s(33723),b=s(66948),f=s(42457),j=s(94692),v=s(12954),N=(s(85539),s(272)),y=s(83700),C=s(92157),S=s.n(C);const w=()=>{const{isRtl:e}=(0,l.useContext)(x.D),{can:a,setUserPermission:s}=((0,g.$)({"fa-solid fa-angle-right":e,"fa-solid fa-angle-left":!e}),(0,g.$)({"fa-solid fa-angle-left":e,"fa-solid fa-angle-right":!e}),(0,d.S)()),{t:i}=(0,u.Bd)(),c=(0,t.Zp)(),[o,C]=((0,t.g)(),(0,l.useState)({value:"All Companies",label:"All Companies"})),[w,A]=(0,l.useState)({value:"All Branches",label:"All Branches"}),[B,D]=(0,l.useState)("All Companies"),[I,k]=(0,l.useState)("All Branches"),[_,P]=(0,l.useState)(document.querySelectorAll("#employee-tbl_wrapper tbody tr")),L={control:e=>({...e,marginRight:"1rem",marginLeft:"1rem",width:"15rem",height:"0.6rem",menuPortal:e=>({...e,zIndex:9999}),menu:e=>({...e,zIndex:9999})})},T=localStorage.getItem("loginDetails-name"),E=localStorage.getItem("role"),{control:V,setValue:O,getValues:J,watch:z}=(0,p.mN)(),F=JSON.parse(localStorage.getItem("userJsonData")).filter((e=>"branch"===e.role)),[G,q]=(0,l.useState)(null),[R,M]=(0,l.useState)([]),[$,H]=(0,l.useState)({id:0,reseller:"",contact:0,username:"",status:"",location:"",usergroup:"",branches:0}),[U,Z]=(0,l.useState)({label:"All Companies",value:"All Companies"}),[K,Q]=(0,l.useState)({label:"All Branches",value:"All Branches"}),[W,X]=(0,l.useState)([]),[Y,ee]=(0,l.useState)([]),[ae,se]=(0,l.useState)(null),[le,te]=(0,l.useState)(null),{page:ne,nextPage:re,prevPage:ie,goToPage:ce,setCount:oe,totalCount:de,setPage:me}=((0,N.Bc)(),(0,j.A)()),he=10*(ne-1),pe=(R.slice(he,he+10),async(e,a,l)=>{try{if(a){const{data:e,success:s}=await(0,b.e3)(void 0,a);M(e.data),oe(e.totalCount),ee(e.data)}else if(l){const{data:e,success:a}=await(0,b.e3)(void 0,void 0,l);M(e.data),oe(e.totalCount),ee(e.data)}else{var t;const{data:a,success:l}=await(0,b.e3)(e),n=JSON.parse(localStorage.getItem("permission"));s(null===n||void 0===n||null===(t=n[0])||void 0===t?void 0:t.permission),M(a.data),oe(a.totalCount)}}catch(n){console.log("Error in fetching data",n)}});(0,l.useEffect)((()=>{pe(ne)}),[ne]);Y.filter((e=>ae&&e.companyId._id===ae.value)).map((e=>({value:e._id,label:e.branchName}))),JSON.parse(localStorage.getItem("userJsonData"));return(0,l.useEffect)((()=>{if("admin"!==E)if("businessgroup"===E){const e=F.filter((e=>e.parentBusinessGroup===T));M(e)}else if("company"===E){const e=F.filter((e=>e.parentCompany===T));M(e)}}),[T,E,F]),(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(r.A,{mainTitle:"Branch",pageTitle:"Branch",parentTitle:"Home"}),(0,m.jsx)("div",{className:"container-fluid",children:(0,m.jsx)("div",{className:"row",children:(0,m.jsx)("div",{className:"col-xl-12",children:(0,m.jsx)("div",{className:"card",children:(0,m.jsx)("div",{className:"card-body p-0",children:(0,m.jsxs)("div",{className:"table-responsive active-projects style-1 ItemsCheckboxSec shorting",children:[(0,m.jsxs)("div",{className:"tbl-caption d-flex justify-content-between text-wrap align-items-center",children:[(0,m.jsx)("h4",{className:"heading mb-0",children:i("branches")}),(0,m.jsxs)("div",{className:"d-flex align-items-center",children:[(0,m.jsx)(n.N_,{className:"btn  btn-xxs","data-bs-toggle":"offcanvas",onClick:()=>{pe(),q(null),O("company",""),O("parent",""),Z({label:"All companies",value:"All companies"})},style:{background:"gray",border:"gray",color:"white"},children:"Clear"}),(0,m.jsx)(p.xI,{name:"company",control:V,rules:{required:!0},render:e=>{let{field:{onChange:a,value:s,name:l,ref:t}}=e;return(0,m.jsx)(v.A,{onChange:async e=>{var a;O("company",e.value),q(e.value),se(a=e),C(a),q(a.value),me(1),pe(1,a.value)},value:s||U,customStyles:L,name:l,ref:t,isDisabled:!1},G)}}),(0,m.jsx)(p.xI,{name:"parent",control:V,rules:{required:!0},render:e=>{let{field:{onChange:a,value:s,name:l,ref:t}}=e;return(0,m.jsx)(y.A,{onChange:e=>{var a;O("parent",e.value),te(a=e),A(a),me(1),pe(1,void 0,a.value)},companyId:G,value:s||K,customStyles:L,ref:t,name:l,isDisabled:!1},G)}}),a("branch","add")&&(0,m.jsxs)(n.N_,{to:"/branch/create",className:"btn btn-primary btn-sm ms-1",style:{paddingBlock:"9px"},"data-bs-toggle":"offcanvas",children:["+ ",i("addBranch")]})," "]})]}),(0,m.jsxs)("div",{id:"employee-tbl_wrapper",className:"dataTables_wrapper no-footer",children:[(0,m.jsxs)("table",{id:"empoloyees-tblwrapper",className:"table ItemsCheckboxSec dataTable no-footer mb-0",children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{children:i("id")}),(0,m.jsx)("th",{children:i("branchName")}),(0,m.jsx)("th",{children:i("parentBranch")}),(0,m.jsx)("th",{children:i("companyName")}),(0,m.jsx)("th",{children:i("businessGroup")}),(0,m.jsx)("th",{children:i("location")}),(0,m.jsx)("th",{children:i("childBranches")}),(a("branch","modify")||a("branch","delete"))&&(0,m.jsx)("th",{children:i("action")})]})}),(0,m.jsx)("tbody",{children:(0,m.jsx)(h,{tempValue:B,tempValue2:I,editData:$,tableData:R,currentPage:ne,itemsPerPage:10,onConfirmDelete:async e=>{await(0,b.SN)(e),(0,f.V)("Branch Deleted"),await pe()},editDrawerOpen:e=>{const a=R.filter((a=>a._id===e));c("edit/".concat(e),{state:a})},setEditData:H},R)})]}),(0,m.jsxs)("div",{className:"d-sm-flex text-center justify-content-between align-items-center",children:[(0,m.jsxs)("div",{className:"dataTables_info",children:[i("showing")," ",10*(ne-1)+1," ",i("to")," ",Math.min(10*ne,de)," ",i("of")," ",de," ",i("entries")]}),(0,m.jsx)("div",{className:"dataTables_paginate paging_simple_numbers",id:"example2_paginate",children:(0,m.jsx)(S(),{previousLabel:(0,m.jsx)("i",{className:"fa-solid fa-angle-left"}),nextLabel:(0,m.jsx)("i",{className:"fa-solid fa-angle-right"}),breakLabel:"...",pageCount:Math.ceil(de/10),marginPagesDisplayed:2,pageRangeDisplayed:5,onPageChange:e=>{let{selected:a}=e;ce(a+1)},containerClassName:"pagination",activeClassName:"active",pageClassName:"page-item",pageLinkClassName:"page-link",previousClassName:"page-item",previousLinkClassName:"page-link",nextClassName:"page-item",nextLinkClassName:"page-link"})})]})]})]})})})})})})]})}}}]);
//# sourceMappingURL=8995.003d625f.chunk.js.map