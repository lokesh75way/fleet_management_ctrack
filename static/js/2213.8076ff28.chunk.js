"use strict";(self.webpackChunkFLEET=self.webpackChunkFLEET||[]).push([[2213],{5614:(e,a,s)=>{s.d(a,{A:()=>l});s(78109);var r=s(47337);const l=e=>{let{height:a="100vh"}=e;return(0,r.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:a,marginTop:"-50px"},children:(0,r.jsx)("div",{class:"spinner-border",role:"status",children:(0,r.jsx)("span",{class:"sr-only",children:"Loading..."})})})}},32213:(e,a,s)=>{s.r(a),s.d(a,{default:()=>_});var r=s(78109),l=s(67236),t=s(36145),n=s(93576),o=s(86554),i=(s(1682),s(34571)),c=s(4900),d=s(67889),u=s(6986),m=s(36342),h=s(32343),x=s(85389),p=s(74563),f=s(43097),v=s(75542),j=s(91197),b=(s(7804),s(60306)),g=s(70529),y=s(92704),N=s(93153),A=s(68892),w=s(88107),I=s(63226),S=s(4860),C=s(68459),E=s(20460),T=s(31029),V=s(70076),F=s(47337);const U={control:e=>({...e,padding:"0.25rem 0 "})},D=e=>{let{register:a,setValue:s,onSubmit:t,handleSubmit:n,getValues:c,errors:d,control:u,watch:h,isFormSubmitting:D}=e;const[k,P]=(0,r.useState)([]),[L,G]=(0,r.useState)([]),[O,_]=(0,r.useState)([]),[q,M]=(0,r.useState)([]),[K,B]=(0,r.useState)(!1),[Z,Q]=(0,r.useState)(!1),[$,R]=(0,r.useState)(!0),[X,z]=(0,r.useState)([]),{t:H}=((0,m.d4)((e=>e.auth.user)),(0,i.Bd)());(0,r.useEffect)((()=>{R(!0),(async()=>{const e=await(0,y.GX)(),a=await(0,N.C1)(),s=await(0,A.e3)();if(e.error)(0,g.U)(e.error);else{const a=e.data;P(a);const s=a.map((e=>{var a,s;return{label:null===e||void 0===e||null===(a=e.businessGroupId)||void 0===a?void 0:a.groupName,value:null===e||void 0===e||null===(s=e.businessGroupId)||void 0===s?void 0:s._id}}));ae(s)}if(a.error)(0,g.U)(a.error);else{const e=a.data.data.data;e.map((e=>{var a,s;return{label:null===(a=e.companyId)||void 0===a?void 0:a.companyName,value:null===(s=e.companyId)||void 0===s?void 0:s._id}}));G(e)}if(s.error)(0,g.U)(s.error);else{const e=s.data.data,a=e.map((e=>({label:e.branchName,value:e._id})));_(e),oe(a)}R(!1)})()}),[]),(0,r.useEffect)((()=>{(async()=>{const e=await(0,b.y)();if(e.error)(0,g.U)(e.error);else{const a=e.data.data.map((e=>({label:e.name,value:e._id})));M(a)}})()}),[]);const{id:J}=(0,l.g)(),[W,Y]=(localStorage.getItem("loginDetails-name"),(0,r.useState)([])),[ee,ae]=(0,r.useState)([]),[se,re]=(0,r.useState)([]),[le,te]=(0,r.useState)([]),[ne,oe]=(0,r.useState)([]),{location:ie,error:ce}=(0,V.A)(),[de,ue]=(0,r.useState)(),[me,he]=(0,r.useState)();return $?(0,F.jsx)("div",{children:"Loading..."}):(0,F.jsxs)("div",{className:"p-4",children:[(0,F.jsxs)("div",{className:"row",style:{width:"85%",margin:"auto"},children:[(0,F.jsx)("div",{children:ce&&(0,F.jsx)("p",{children:ce})}),(0,F.jsxs)("div",{className:"col-xl-3 mb-3",children:[(0,F.jsx)("label",{className:"form-label",children:H("businessGroup")}),(0,F.jsx)(o.xI,{name:"businessGroupId",control:u,rules:{required:!0},render:e=>{let{field:{onChange:a,value:r,name:l,ref:t}}=e;return(0,F.jsx)(S.A,{onChange:async e=>{e.value!=c("businessGroupId")&&(s("businessGroupId",e.value),ue(null),s("companyId",""),he(null),s("branchIds",""))},defaultValue:r,customStyles:U,ref:t,name:l})}})]}),(0,F.jsxs)("div",{className:"col-xl-3 mb-3",children:[(0,F.jsx)("label",{className:"form-label",children:H("company")}),(0,F.jsx)(o.xI,{name:"companyId",control:u,rules:{required:!0},render:e=>{let{field:{value:a,name:r,ref:l}}=e;return(0,F.jsx)(I.A,{onChange:async e=>{e.value!=c("companyId")&&(s("companyId",e.value),ue(e),he(null),s("branchIds",""))},groupId:h("businessGroupId"),defaultValue:a,value:de,customStyles:U,name:r,ref:l})}})]}),(0,F.jsxs)("div",{className:"col-xl-3 mb-3",children:[(0,F.jsx)("label",{className:"form-label",children:H("branch")}),(0,F.jsx)(o.xI,{name:"branchIds",control:u,rules:{required:!0},render:e=>{let{field:{onChange:a,value:r,name:l,ref:t}}=e;return(0,F.jsx)(w.A,{onChange:e=>{const a=e.map((e=>e.value));s("branchIds",a),z(a)},defaultValue:r,customStyles:U,ref:t,companyId:h("companyId"),name:l,isDisabled:!(null!==de&&void 0!==de&&de.value)})}}),!c("Branch")&&(0,F.jsx)(v.A,{errorName:d.parent})]}),(0,F.jsxs)("div",{className:"col-xl-3 mb-3",children:[(0,F.jsx)("label",{className:"form-label",children:H("vehicle")}),(0,F.jsx)(o.xI,{name:"vehicleIds",control:u,rules:{required:!0},render:e=>{let{field:{onChange:a,value:r,name:l,ref:t}}=e;return(0,F.jsx)(C.A,{onChange:e=>{const a=e.map((e=>e.value));s("vehicleIds",a)},value:r,branchids:X,customStyles:U,ref:t,name:l})}}),!c("Branch")&&(0,F.jsx)(v.A,{errorName:d.parent})]}),(0,F.jsxs)("div",{className:"col-xl-3 mb-3",children:[(0,F.jsxs)("label",{htmlFor:"exampleFormControlInput3",className:"form-label",children:[H("email")," ",(0,F.jsx)("span",{className:"text-danger",children:"*"})]}),(0,F.jsx)(j.A,{type:"email",register:a,label:"Email",className:"form-control",name:"email",defaultValue:W[0]?W[0].email:"",placeholder:""}),(0,F.jsx)(v.A,{errorName:d.email})]}),(0,F.jsxs)("div",{className:"col-xl-3 mb-3 ",children:[(0,F.jsxs)("label",{className:"form-label",children:[H("username")," ",(0,F.jsx)("span",{className:"text-danger",children:"*"})]}),(0,F.jsx)(j.A,{type:"text",register:a,label:"User Name",name:"userName",placeholder:"",defaultValue:W[0]?W[0].userName:""}),(0,F.jsx)(v.A,{errorName:d.userName})]}),(0,F.jsxs)("div",{className:"col-xl-3 mb-3 ",children:[(0,F.jsxs)("label",{className:"form-label",children:[H("mobileNumber")," ",(0,F.jsx)("span",{className:"text-danger",children:"*"})]}),(0,F.jsx)(j.A,{type:"text",register:a,label:"Mobile Number",name:"mobileNumber",min:"0",onInput:e=>{const a=Math.max(0,e.target.value);e.target.value=a<1?"":a},placeholder:"",defaultValue:W[0]?W[0].mobileNumber:""}),(0,F.jsx)(v.A,{errorName:d.mobileNumber})]}),(0,F.jsx)(T.A,{register:a,setValue:s,errors:d,getValues:c,locationData:ie,id:J,showCity:!1}),!J&&(0,F.jsxs)(F.Fragment,{children:[(0,F.jsxs)("div",{className:"col-xl-3 mb-3 ",children:[(0,F.jsxs)("label",{className:"form-label",children:[H("password")," ",(0,F.jsx)("span",{className:"text-danger",children:"*"})]}),(0,F.jsxs)("div",{className:"position-relative",children:[(0,F.jsx)(j.A,{type:K?"text":"password",register:a,label:"Password",name:"password",placeholder:"",defaultValue:W[0]?W[0].password:""}),(0,F.jsx)("span",{className:"showPasswordIcon",onClick:()=>{B(!K)},children:K?(0,F.jsx)(f.mI_,{}):(0,F.jsx)(f.ZT8,{})})]}),(0,F.jsx)(v.A,{errorName:d.password})]}),(0,F.jsxs)("div",{className:"col-xl-3 mb-3 ",children:[(0,F.jsxs)("label",{className:"form-label",children:[H("confirmPassword")," ",(0,F.jsx)("span",{className:"text-danger",children:"*"})]}),(0,F.jsxs)("div",{className:"position-relative",children:[(0,F.jsx)(j.A,{type:Z?"text":"password",register:a,label:"Confirm Password",name:"confirmPassword",placeholder:"",defaultValue:W[0]?W[0].confirmPassword:""}),(0,F.jsx)("span",{className:"showPasswordIcon",onClick:()=>{Q(!Z)},children:Z?(0,F.jsx)(f.mI_,{}):(0,F.jsx)(f.ZT8,{})})]}),(0,F.jsx)(v.A,{errorName:d.confirmPassword})]})," "]}),(0,F.jsxs)("div",{className:"col-xl-3 mb-3 ",children:[(0,F.jsxs)("label",{className:"form-label",children:[H("featureTemplate")," ",(0,F.jsx)("span",{className:"text-danger",children:"*"})]}),(0,F.jsx)(o.xI,{name:"featureTemplateId",control:u,rules:{required:!0},render:e=>{let{field:a}=e;return(0,F.jsx)(p.Ay,{onChange:e=>{s("featureTemplateId",e.value)},options:q,ref:a.ref,name:a.name,styles:U,value:q.find((e=>e.value===a.value))})}}),!c("featureTemplateId")&&(0,F.jsx)(v.A,{errorName:d.featureTemplateId})]}),(0,F.jsxs)("div",{className:"col-xl-3 mb-3",children:[(0,F.jsxs)("label",{htmlFor:"exampleFormControlInput6",className:"form-label",children:[H("unitOfDistance"),(0,F.jsx)("span",{className:"text-danger",children:"*"})]}),(0,F.jsx)(o.xI,{name:"unitOfDistance",control:u,render:e=>{let{field:{onChange:a,value:r,name:l,ref:t}}=e;return(0,F.jsx)(p.Ay,{onChange:e=>{s("unitOfDistance",e.value)},options:E.jZ,ref:t,name:l,styles:U,value:{label:c("unitOfDistance"),value:c("unitOfDistance")}})}}),!c("unitOfDistance")&&(0,F.jsx)(v.A,{errorName:d.unitOfDistance})]})]}),(0,F.jsx)("div",{style:{width:"100%",display:"flex",justifyContent:"center",margin:"2rem 0"},children:(0,F.jsxs)(x.A,{type:"submit",disabled:D,onClick:n(t),style:{width:"10%"},children:[" ",H("submit")]})})]})};var k=s(53252),P=s(44988),L=s(1516),G=s(96152),O=s(5614);const _=()=>{const{id:e}=(0,l.g)(),{t:a}=(0,i.Bd)(),[s,x]=(0,r.useState)(0),p=[a("account")],f=[D],v=(0,l.Zp)(),j=(0,c.jE)(),b=(0,m.d4)((e=>e.auth.user)),{data:y,isError:N,isLoading:A}=(0,d.I)({queryKey:["user",e],queryFn:()=>(0,L.kl)(e),enabled:!!e,staleTime:1/0}),w=(0,r.useMemo)((()=>({...y})),[y]);(0,r.useEffect)((()=>{N&&e&&((0,g.U)("Not able to fetch user data"),v("/not-found"))}),[N&&e]);const{register:I,formState:{errors:S},setValue:C,getValues:E,control:T,handleSubmit:V,watch:U}=(0,o.mN)({resolver:(0,k.t)(e?P.I2:P.it),values:w}),_=e=>(0,g.U)((0,G.SU)(e)),{mutate:q,isPending:M}=(0,u.n)({mutationFn:e=>{let{data:a,id:s}=e;return(0,L.TK)(s,a)},onSuccess:()=>{(0,g.V)("Company Updated Successfully"),j.invalidateQueries(["users"]),v("/user")},onError:_}),{mutate:K,isPending:B}=(0,u.n)({mutationFn:L.kg,onSuccess:()=>{(0,g.V)("New User Created"),j.invalidateQueries(["users"]),v("/user")},onError:_}),Z=a=>{e?q({id:e,data:a}):(a.role="USER",a.parent=b.userName,a.type="STAFF",K(a))};return(0,F.jsxs)(F.Fragment,{children:[(0,F.jsx)(h.A,{mainTitle:"User",pageTitle:e?"Edit":"Create",parentTitle:"User"}),(0,F.jsx)("div",{className:"m-2 p-2",children:(0,F.jsx)(o.Op,{children:(0,F.jsx)("form",{onSubmit:V(Z),children:(0,F.jsx)("div",{className:"default-tab",children:(0,F.jsxs)(t.A.Container,{defaultActiveKey:p[0].toLowerCase(),children:[(0,F.jsx)(n.A,{as:"ul",className:"nav-tabs",children:p.map(((e,a)=>(0,F.jsx)(n.A.Item,{as:"li",children:(0,F.jsx)(n.A.Link,{style:{padding:".5rem 2rem"},eventKey:e.toLowerCase(),active:a===s,onClick:()=>x(a),children:e})},a)))}),(0,F.jsx)(t.A.Content,{className:"pt-4",children:A?(0,F.jsx)(O.A,{height:500}):p.map(((e,a)=>{const r=f[a];return(0,F.jsx)(t.A.Pane,{eventKey:e.toLowerCase(),active:a===s,children:(0,F.jsx)(r,{data:p,control:T,setValue:C,register:I,getValues:E,errors:S,onSubmit:Z,handleSubmit:V,isFormSubmitting:B||M,watch:U})},a)}))})]})})})})})]})}},88107:(e,a,s)=>{s.d(a,{A:()=>i});var r=s(78109),l=s(68892),t=s(74563),n=s(97804),o=s(47337);const i=e=>{let{onChange:a,value:s,customStyles:i,name:c,companyId:d,isDisabled:u,ref:m,isMulti:h=!0}=e;const[x,p]=(0,r.useState)([]),[f,v]=(0,r.useState)(s),{page:j}=(0,n.A)();return(0,r.useEffect)((()=>{(async()=>{const e=(await(0,l.e3)(void 0,d||void 0)).data.data.map((e=>({value:null===e||void 0===e?void 0:e._id,label:null===e||void 0===e?void 0:e.branchName})));p(e)})()}),[j,d]),(0,r.useEffect)((()=>{if(s&&Array.isArray(s)){const e=x.filter((e=>s.some((a=>a===e.value))));v(e)}else v(s)}),[s,x]),(0,o.jsx)(t.Ay,{options:x,value:f,onChange:e=>a(e),styles:i,name:c,ref:m,isDisabled:u,isMulti:!0})}},68459:(e,a,s)=>{s.d(a,{A:()=>i});var r=s(78109),l=s(74563),t=(s(97937),s(55759)),n=s(97804),o=s(47337);const i=e=>{let{onChange:a,value:s,customStyles:i,branchids:c,ref:d,isDisabled:u,name:m}=e;const[h,x]=(0,r.useState)([]),[p,f]=(0,r.useState)(s),{page:v}=(0,n.A)();return(0,r.useEffect)((()=>{(async()=>{const e=(await(0,t.kw)(v,c||void 0)).data.map((e=>({label:null===e||void 0===e?void 0:e.vehicleName,value:null===e||void 0===e?void 0:e._id})));x(e)})()}),[v,c]),(0,r.useEffect)((()=>{if(s&&Array.isArray(s)){const e=h.filter((e=>s.some((a=>a===e.value))));f(e)}else f(s)}),[s,h,c]),(0,o.jsx)(l.Ay,{options:h,value:p,onChange:e=>a(e),styles:i,ref:d,name:m,isMulti:!0})}},60306:(e,a,s)=>{s.d(a,{A:()=>n,y:()=>t});var r=s(95441),l=s(74763);(0,r.A)();const t=async e=>{try{let a="/feature-template";void 0!==e&&(a+=`?page=${e}&limit=10`);return(await l.A.get(a)).data}catch(a){return console.error("Error fetching templates:",a),{error:"Couldn't fetch User"}}},n={getTemplates:async e=>{try{return(await l.A.get("/feature-template",e)).data}catch(a){throw console.error("Error fetching modules:",a),a}},createTemplate:async e=>{try{return(await l.A.post("/feature-template",e)).data}catch(a){throw console.error("Error fetching modules:",a),a}},listModule:async e=>{try{return(await l.A.get("/modules",e)).data}catch(a){throw console.error("Error fetching modules:",a),a}},udpateTemplate:async e=>{try{return(await l.A.patch("/feature-template",e)).data}catch(a){throw console.error("Error fetching modules:",a),a}},deleteTemplate:async e=>{try{return(await l.A.delete(`/feature-template/${e}`)).data}catch(a){throw console.error("Error fetching modules:",a),a}}}}}]);
//# sourceMappingURL=2213.8076ff28.chunk.js.map