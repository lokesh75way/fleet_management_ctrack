"use strict";(self.webpackChunkFLEET=self.webpackChunkFLEET||[]).push([[799],{24725:(e,t,s)=>{s.d(t,{A:()=>i});var a=s(65043),n=s(42297),r=s(50377),l=s(70579);const i=e=>{let{onChange:t,value:s,customStyles:i,ref:c,isDisabled:o,name:d}=e;const[m,h]=(0,a.useState)([]),[x,p]=(0,a.useState)(s);return(0,a.useEffect)((()=>{(async()=>{const e=(await(0,r.j9)()).data.map((e=>({label:null===e||void 0===e?void 0:e.firstName,value:null===e||void 0===e?void 0:e._id})));h(e)})()}),[]),(0,a.useEffect)((()=>{const e=m.find((e=>e.value===s));p(e)}),[s,m]),(0,l.jsx)(n.Ay,{options:m,value:x,onChange:e=>t(e),styles:i,ref:c,name:d})}},799:(e,t,s)=>{s.r(t),s.d(t,{default:()=>M});var a=s(65043),n=s(73216),r=s(35475),l=(s(62378),s(27940),s(40399)),i=(s(31412),s(24858)),c=s(18403),o=s(70228),d=s(44816),m=s(86856),h=s(23577),x=s(42457),p=s(6720),j=s(60184),u=s(95977),f=s(23156),v=s(60446),g=s.n(v),b=s(70579);const N=e=>{let{children:t,tooltipText:s}=e;const[n,r]=(0,a.useState)(!1);return(0,b.jsxs)("div",{className:"custom-tooltip-container",onMouseEnter:()=>r(!0),onMouseLeave:()=>r(!1),style:{position:"relative",display:"inline-block"},children:[t,n&&(0,b.jsx)("div",{className:"custom-tooltip",style:{position:"absolute",bottom:"100%",left:"280%",transform:"translateX(-50%)",backgroundColor:"white",color:"#333",padding:"5px 10px",borderRadius:"4px",boxShadow:"0 2px 8px rgba(0,0,0,0.15)",zIndex:1e4,whiteSpace:"nowrap",fontSize:"12px",border:"1px solid #ddd",marginBottom:"3px"},children:s})]})},y=e=>{let{id:t}=e;const s=t.length>5?"".concat(t.substring(0,5),"..."):t;return(0,b.jsx)(N,{tooltipText:t,children:(0,b.jsx)("span",{children:s})})},S=e=>{let{tableData:t,onConfirmDelete:s,editDrawerOpen:a,active:n,currentPage:l,itemsPerPage:i}=e;const c=e=>g()(e).format("YYYY-MM-DD HH:MM");return(0,b.jsx)(b.Fragment,{children:t.map(((e,t)=>(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{children:(0,b.jsx)(y,{id:e._id})}),(0,b.jsx)("td",{children:(0,b.jsx)("span",{children:c(e.startTime)})}),(0,b.jsx)("td",{children:(0,b.jsx)("span",{children:e.startLocation})}),(0,b.jsx)("td",{children:(0,b.jsx)("span",{children:c(e.reachTime)})}),(0,b.jsx)("td",{children:(0,b.jsx)("span",{children:e.reachLocation})}),(0,b.jsx)("td",{children:(0,b.jsx)("span",{className:"text-primary",children:e.distance})}),(0,b.jsx)("td",{children:(0,b.jsx)("span",{children:e.fuelConsumption})}),(0,b.jsx)("td",{children:(0,b.jsx)("span",{children:e.driverName})}),(0,b.jsx)("td",{children:(0,b.jsxs)("span",{className:"d-flex justify-content-center",children:[n&&(0,b.jsx)("span",{className:"cursor-pointer",title:"tracking",children:(0,b.jsx)(r.N_,{to:"/vehicle/tracking/".concat(e.tripId),children:(0,b.jsx)(f.sIY,{style:{color:"#ff9f00",fontSize:"18px"}})})}),(0,b.jsx)("span",{className:"cursor-pointer",style:{marginRight:"3px",marginLeft:"7px"},onClick:()=>a(e._id),children:(0,b.jsx)(j.uO9,{style:{color:"green",fontSize:"1.2rem"}})}),(0,b.jsx)(u.A,{className:"cursor-pointer ",onConfirmDelete:s,id:e._id,children:(0,b.jsx)(p.b6i,{style:{color:"red",fontSize:"1.2rem"}})})]})})]},t)))})};var T=s(33723),C=s(94692),w=s(74117),D=(s(92157),s(19172)),A=s(18733);const E=e=>{let{tableData1:t,tabType:s}=e;const[r,l]=(0,a.useState)(t),[d,m]=(0,a.useState)(!1);(0,a.useEffect)((()=>{l(t)}),[t]);const{register:p,setValue:j,getValues:u,handleSubmit:f,formState:{errors:v},control:g}=(0,i.mN)({resolver:(0,c.t)(o.M0)}),[N,y]=(0,a.useState)({id:0,status:"",title:"",contact:0,age:0,drivingExperience:0,gender:"",location:""}),{isRtl:E}=(0,a.useContext)(T.D),{t:I}=(0,w.Bd)(),_=(0,n.Zp)(),{page:k,nextPage:P,prevPage:L,goToPage:M,setCount:O,totalCount:V,setPage:R}=(0,C.A)();(0,a.useEffect)((()=>{let e="";"Active Trips"===s?e="ONGOING":"Planned Trips"===s?e="JUST_STARTED":"Completed Trips"===s&&(e="COMPLETED"),H(e)}),[s,k]);const H=async e=>{try{m(!0);const{data:t,success:s,totalLength:a}=await(0,h.nH)(k,e);l(t),O(a)}catch(t){console.log("Error",t)}finally{m(!1)}};(0,a.useRef)(),(0,a.useRef)();return console.log(r),(0,b.jsx)("div",{className:"container-fluid",children:(0,b.jsx)("div",{className:"row",children:(0,b.jsx)("div",{className:"col-xl-12",children:(0,b.jsx)("div",{className:"card",children:(0,b.jsx)("div",{className:"card-body p-0",children:(0,b.jsx)("div",{className:"table-responsive active-projects style-1 ItemsCheckboxSec shorting",children:(0,b.jsxs)("div",{id:"employee-tbl_wrapper",className:"dataTables_wrapper no-footer",children:[!r.length&&d?(0,b.jsx)(A.A,{}):(0,b.jsxs)("table",{id:"empoloyees-tblwrapper",className:"table ItemsCheckboxSec dataTable no-footer mb-0",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{children:I("tripId")}),(0,b.jsx)("th",{children:I("startTime")}),(0,b.jsx)("th",{children:I("startLocation")}),(0,b.jsx)("th",{children:I("reachTime")}),(0,b.jsx)("th",{children:I("reachLocation")}),(0,b.jsx)("th",{children:I("distance")}),(0,b.jsx)("th",{children:I("fuelConsumption")}),(0,b.jsx)("th",{children:I("driver")}),(0,b.jsx)("th",{children:I("action")})]})}),(0,b.jsx)("tbody",{children:(0,b.jsx)(S,{active:!0,editData:N,tableData:r,onConfirmDelete:async e=>{await(0,h.BG)(e),l((t=>t.filter((t=>t._id!==e)))),(0,x.V)("Trip Deleted")},editDrawerOpen:e=>{const t=r.filter((t=>t._id===e));_("edit/".concat(e),{state:t})},setEditData:y,currentPage:k,itemsPerPage:10})})]}),(0,b.jsxs)("div",{className:"d-sm-flex text-center justify-content-between align-items-center",children:[(0,b.jsxs)("div",{className:"dataTables_info",children:[I("showing")," ",10*(k-1)+1," ",I("to")," ",Math.min(10*k,V)," ",I("of")," ",V," ",I("entries")]}),(0,b.jsx)("div",{className:"dataTables_paginate paging_simple_numbers",id:"example2_paginate",children:(0,b.jsx)(D.A,{totalCount:V,itemsPerPage:10,handlePageClick:e=>{let{selected:t}=e;M(t+1)}})})]})]})})})})})})})};s(43);var I=s(28086),_=s(31899),k=s.n(_),P=(s(9531),s(28334),s(87460),s(74805),s(24725));const L=(0,a.forwardRef)(((e,t)=>{let{Title:s,filterData:r}=e;const[l,d]=(0,a.useState)(!1),[m,x]=(0,a.useState)();(0,a.useImperativeHandle)(t,(()=>({showModal(){d(!0)}})));(0,n.Zp)();const p={control:e=>({...e,padding:".25rem 0 "})},{register:j,handleSubmit:u,setValue:f,getValues:v,control:g,formState:{errors:N}}=(0,i.mN)({resolver:(0,c.t)(o.$q)});return(0,b.jsx)(b.Fragment,{children:(0,b.jsxs)(I.A,{show:l,onHide:d,className:"offcanvas-end customeoff classy_filter",placement:"end",children:[(0,b.jsxs)("div",{className:"offcanvas-header",children:[(0,b.jsx)("h5",{className:"modal-title",id:"#gridSystemModal",children:s}),(0,b.jsx)("button",{type:"button",className:"btn-close",onClick:()=>d(!1),children:(0,b.jsx)("i",{className:"fa-solid fa-xmark"})})]}),(0,b.jsx)("div",{className:"offcanvas-body",children:(0,b.jsx)("div",{className:"container-fluid",children:(0,b.jsx)(i.Op,{children:(0,b.jsx)("form",{onSubmit:u((async e=>{const{driverId:t,startDate:s,endDate:a}=e,n=new Date(s),l=new Date(a);if(isNaN(n.getTime())||isNaN(l.getTime()))console.error("Invalid startDate or endDate");else{const e=n.toISOString(),s=l.toISOString(),{data:a}=await(0,h.nH)(void 0,void 0,t,e,s);r(a)}})),children:(0,b.jsxs)("div",{className:"container",children:[(0,b.jsxs)("div",{className:"row ",children:[(0,b.jsxs)("div",{className:"col-xl-12 mb-3 ",children:[(0,b.jsx)("label",{className:"form-label",children:"Driver"}),(0,b.jsx)(i.xI,{name:"driverId",control:g,render:e=>{let{field:{onChange:t,value:s,name:a,ref:n}}=e;return(0,b.jsx)(P.A,{onChange:e=>{f("driverId",e.value)},value:s,customStyles:p,ref:n,name:a})}})]}),(0,b.jsxs)("div",{className:"col-xl-12 mb-3 d-flex flex-column",children:[(0,b.jsx)("label",{className:"form-label",children:"Start Date"}),(0,b.jsx)(i.xI,{name:"startDate",control:g,render:e=>{let{field:t}=e;return(0,b.jsx)(k(),{selected:t.value,className:"form-control",onChange:e=>t.onChange(e)})}})]}),(0,b.jsxs)("div",{className:"col-xl-12 mb-3 d-flex flex-column",children:[(0,b.jsx)("label",{className:"form-label",children:"End Date"}),(0,b.jsx)(i.xI,{name:"endDate",control:g,render:e=>{let{field:t}=e;return(0,b.jsx)(k(),{selected:t.value,className:"form-control",onChange:e=>t.onChange(e)})}})]})]}),(0,b.jsx)("div",{className:"row",children:(0,b.jsx)("div",{className:"col-12",children:(0,b.jsx)("div",{className:"mb-4",children:(0,b.jsx)("button",{type:"submit",onClick:()=>d(!1),className:"btn btn-primary me-4 w-100",children:"Apply"})})})})]})})})})})]})})})),M=e=>{const{t:t}=(0,w.Bd)(),s=[t("activeTrips"),t("plannedTrips"),t("completedTrips")],p=[E,E,E],[j,u]=(0,a.useState)([]),{register:f,setValue:v,getValues:g,handleSubmit:N,clearErrors:y,formState:{errors:S},control:T}=(0,i.mN)({resolver:(0,c.t)(o.M0)}),[C,D]=(0,a.useState)({id:0,status:"",title:"",contact:0,age:0,drivingExperience:0,gender:"",location:""}),A=(0,n.Zp)(),I=((0,a.useRef)(),(0,a.useRef)()),_=async e=>{try{await(0,h.C$)(e),(0,x.V)("New Trip Created!"),A("/settings/classifyTrips")}catch(t){console.log("Error",t)}},[k,P]=(0,a.useState)(0);return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(l.A,{mainTitle:t("classifyTrip"),pageTitle:t("classifyTrip"),parentTitle:t("settings")}),(0,b.jsx)("div",{className:"m-2 p-2 classify_trip-container",children:(0,b.jsx)(i.Op,{children:(0,b.jsxs)("form",{onSubmit:N(_),children:[(0,b.jsxs)(d.A.Container,{defaultActiveKey:s[0].toLowerCase(),children:[(0,b.jsxs)(m.A,{as:"ul",className:"nav-tabs classify-trips",children:[(0,b.jsx)("div",{children:s.map(((e,t)=>(0,b.jsx)(m.A.Item,{as:"li",children:(0,b.jsx)(m.A.Link,{style:{padding:".5rem 2rem"},eventKey:e.toLowerCase(),active:t===k,onClick:()=>P(t),children:e})},t)))}),(0,b.jsxs)("div",{className:"",children:[(0,b.jsxs)(r.N_,{to:"#",className:"btn btn-primary btn-sm ms-1","data-bs-toggle":"offcanvas",onClick:()=>I.current.showModal(),children:["+ ",t("filter")]})," ",(0,b.jsxs)(r.N_,{to:"/settings/classifyTrips/create",className:"btn btn-primary btn-sm ms-1","data-bs-toggle":"offcanvas",children:["+ ",t("addTrips")]})," "]})]}),(0,b.jsx)(d.A.Content,{className:"pt-4",children:s.map(((e,t)=>{const a=p[t];return(0,b.jsx)(d.A.Pane,{eventKey:e.toLowerCase(),active:t===k,children:(0,b.jsx)(a,{tableData1:j,data:s,control:T,setValue:v,register:f,getValues:g,tableData:!0,errors:S,handleSubmit:N,onSubmit:_,tabType:e})},t)}))})]}),(0,b.jsx)(L,{ref:I,Title:"Add Filter",filterData:e=>{u(e)}})]})})})]})}},23577:(e,t,s)=>{s.d(t,{BG:()=>i,C$:()=>r,nH:()=>n,pj:()=>l});var a=s(77154);(0,s(94505).A)();const n=async function(){let e=arguments.length>1?arguments[1]:void 0,t=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0,n=arguments.length>4?arguments[4]:void 0,r="/trips?page=".concat(arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,"&limit=10");r+=t&&s&&n?"&driverId=".concat(t,"&start=").concat(s,"&end=").concat(n):"&status=".concat(e);const l=await a.A.get(r);return{data:l.data.data.data,totalLength:l.data.data.count}},r=async e=>a.A.post("/trips",e),l=async(e,t)=>a.A.patch("/trips/".concat(e),t),i=async e=>a.A.delete("/trips/".concat(e))}}]);
//# sourceMappingURL=799.315c3612.chunk.js.map