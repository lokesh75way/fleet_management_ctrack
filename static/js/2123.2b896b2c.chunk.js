"use strict";(self.webpackChunkFLEET=self.webpackChunkFLEET||[]).push([[2123],{32123:(e,a,t)=>{t.r(a),t.d(a,{default:()=>y});var s=t(78109),l=t(67236),n=t(78292),r=t(14578),i=t(27515),c=t(25255),d=t(76103),o=(t(7199),t(65687),t(33150)),m=t(47337);const h=e=>{let{onConfirmDelete:a,params:t,currentPage:s,itemsPerPage:l,tempValue:r,tempValue2:h,tableData:u,editDrawerOpen:p,setDataLength:x}=e,b=u;const{can:g}=(0,o.S)(),j=g("branch","modify"),v=g("branch","delete");"All Companies"!==r&&(b=u.filter((e=>"branch"===e.role&&e.parentCompany===r))),"All Branches"!==h&&(b=u.filter((e=>"branch"===e.role&&e.parentBranch===h)));for(var f=[],N=0;N<b.length;N++){const e=b[N]._id;f[N]=b.filter((a=>{var t;return(null===a||void 0===a||null===(t=a.parentBranchId)||void 0===t?void 0:t._id)===e})).length}const y=(s-1)*l+1;return(0,m.jsx)(m.Fragment,{children:b.map(((e,t)=>{var s,l,r,o;return(0,m.jsxs)("tr",{children:[(0,m.jsx)("td",{children:(0,m.jsx)("span",{children:y+t})}),(0,m.jsx)("td",{children:(0,m.jsx)("span",{className:"text-primary",children:e.branchName})}),(0,m.jsx)("td",{children:(0,m.jsx)("span",{children:null!==(s=e.companyId)&&void 0!==s&&s.companyName?null===(l=e.companyId)||void 0===l?void 0:l.companyName:(0,m.jsx)("span",{className:"ps-4",children:"-"})})}),(0,m.jsx)("td",{children:(0,m.jsx)("span",{children:null!==(r=e.businessGroupId)&&void 0!==r&&r.groupName?null===(o=e.businessGroupId)||void 0===o?void 0:o.groupName:(0,m.jsx)("span",{className:"ps-4",children:"-"})})}),(0,m.jsx)("td",{children:(0,m.jsx)("span",{children:e.city})}),(0,m.jsx)("td",{children:(0,m.jsx)(n.N_,{to:`/branch/bid/${e.id}`,className:"text-primary badge light border-0 badge-count",children:f[t]})}),(j||v)&&(0,m.jsx)("td",{children:(0,m.jsxs)("span",{className:"d-flex justify-content-center",children:[j&&(0,m.jsx)("span",{className:"cursor-pointer",onClick:()=>p(e._id),children:(0,m.jsx)(c.uO9,{style:{color:"green",fontSize:"1.2rem"}})}),v&&(0,m.jsx)(d.A,{className:"cursor-pointer ",onConfirmDelete:a,id:e._id,children:(0,m.jsx)(i.b6i,{style:{color:"red",fontSize:"1.2rem"}})})]})})]},t)}))})};var u=t(86554),p=(t(38230),t(34571)),x=t(35651),b=t(68892),g=t(70529),j=t(97804),v=t(79154),f=(t(88107),t(96152)),N=(t(8668),t(43157),t(40447));const y=()=>{var e;const{isRtl:a}=(0,s.useContext)(x.D),{can:t,setUserPermission:i}=(0,o.S)(),{t:c}=(0,p.Bd)(),d=(0,l.Zp)(),{id:y}=(0,l.g)(),[C,S]=(0,s.useState)({value:"All Companies",label:"All Companies"}),[w,A]=(0,s.useState)({value:"All Branches",label:"All Branches"}),[_,P]=(0,s.useState)("All Companies"),[B,D]=(0,s.useState)("All Branches"),[I,k]=(0,s.useState)(document.querySelectorAll("#employee-tbl_wrapper tbody tr")),T={control:e=>({...e,marginRight:"1rem",marginLeft:"1rem",width:"15rem",height:"0.6rem",menuPortal:e=>({...e,zIndex:9999}),menu:e=>({...e,zIndex:9999})})},{control:E,setValue:V,getValues:O,watch:z}=(localStorage.getItem("loginDetails-name"),(0,u.mN)()),F=JSON.parse(localStorage.getItem("userDetails")),L=null===F||void 0===F||null===(e=F.user)||void 0===e?void 0:e.role,[G,q]=(0,s.useState)(null),[J,M]=(0,s.useState)([]),[R,$]=(0,s.useState)({id:0,reseller:"",contact:0,username:"",status:"",location:"",usergroup:"",branches:0}),[H,U]=(0,s.useState)({label:c("allCompanies"),value:"All Companies"}),[Y,Z]=(0,s.useState)({label:c("selectParentBranch"),value:"All Branches"}),[K,Q]=(0,s.useState)([]),[W,X]=(0,s.useState)([]),[ee,ae]=(0,s.useState)(null),[te,se]=(0,s.useState)(null),{page:le,nextPage:ne,prevPage:re,goToPage:ie,setCount:ce,totalCount:de,setPage:oe}=((0,f.Bc)(),(0,j.A)()),me=10*(le-1),he=(J.slice(me,me+10),async(e,a,t)=>{try{if(a){const{data:e,success:t}=await(0,b.e3)(void 0,a);M(e.data),ce(e.totalCount),X(e.data)}else if(t){const{data:e,success:a}=await(0,b.e3)(void 0,void 0,t);M(e.data),ce(e.totalCount),X(e.data)}else{var s;const{data:a,success:t}=await(0,b.e3)(e),l=JSON.parse(localStorage.getItem("permission"));i(null===l||void 0===l||null===(s=l[0])||void 0===s?void 0:s.permission),M(a.data),ce(a.totalCount)}}catch(l){console.log("Error in fetching data",l)}});(0,s.useEffect)((()=>{y?he(le,y):he(le)}),[le,y]);W.filter((e=>ee&&e.companyId._id===ee.value)).map((e=>({value:e._id,label:e.branchName})));return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(r.A,{mainTitle:"Branch",pageTitle:"Branch",parentTitle:"Home"}),(0,m.jsx)("div",{className:"container-fluid",children:(0,m.jsx)("div",{className:"row",children:(0,m.jsx)("div",{className:"col-xl-12",children:(0,m.jsx)("div",{className:"card",children:(0,m.jsx)("div",{className:"card-body p-0",children:(0,m.jsxs)("div",{className:"table-responsive active-projects style-1 ItemsCheckboxSec shorting",children:[(0,m.jsxs)("div",{className:"tbl-caption d-flex justify-content-between text-wrap align-items-center",children:[(0,m.jsx)("h4",{className:"heading mb-0",children:c("branches")}),(0,m.jsxs)("div",{className:"d-flex align-items-center",children:[(0,m.jsx)(n.N_,{className:"btn  btn-xxs","data-bs-toggle":"offcanvas",onClick:()=>{he(),q(null),V("company",""),V("parent",""),U({label:"All companies",value:"All companies"})},to:"/branch",style:{background:"gray",border:"gray",color:"white"},children:"Clear"}),(0,m.jsx)(u.xI,{name:"company",control:E,rules:{required:!0},render:e=>{let{field:{onChange:a,value:t,name:s,ref:l}}=e;return(0,m.jsx)(v.A,{onChange:async e=>{var a;V("company",e.value),q(e.value),ae(a=e),S(a),q(a.value),oe(1),he(1,a.value)},value:t||H,customStyles:T,name:s,ref:l,isDisabled:"COMPANY"===L},G)}}),t("branch","add")&&(0,m.jsxs)(n.N_,{to:"/branch/create",className:"btn btn-primary btn-sm ms-1",style:{paddingBlock:"9px"},"data-bs-toggle":"offcanvas",children:["+ ",c("addBranch")]})," "]})]}),(0,m.jsxs)("div",{id:"employee-tbl_wrapper",className:"dataTables_wrapper no-footer",children:[(0,m.jsxs)("table",{id:"empoloyees-tblwrapper",className:"table ItemsCheckboxSec dataTable no-footer mb-0",children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{children:c("id")}),(0,m.jsx)("th",{children:c("branchName")}),(0,m.jsx)("th",{children:c("companyName")}),(0,m.jsx)("th",{children:c("businessGroup")}),(0,m.jsx)("th",{children:c("location")}),(0,m.jsx)("th",{children:c("childBranches")}),(t("branch","modify")||t("branch","delete"))&&(0,m.jsx)("th",{children:c("action")})]})}),(0,m.jsx)("tbody",{children:(0,m.jsx)(h,{tempValue:_,tempValue2:B,editData:R,tableData:J,currentPage:le,itemsPerPage:10,onConfirmDelete:async e=>{await(0,b.SN)(e),(0,g.V)("Branch Deleted"),await he()},editDrawerOpen:e=>{const a=null===J||void 0===J?void 0:J.filter((a=>a._id===e));d(`edit/${e}`,{state:a})},setEditData:$},J)})]}),(0,m.jsxs)("div",{className:"d-sm-flex text-center justify-content-between align-items-center",children:[(0,m.jsxs)("div",{className:"dataTables_info",children:[c("showing")," ",10*(le-1)+1," ",c("to")," ",Math.min(10*le,de)," ",c("of")," ",de," ",c("entries")]}),(0,m.jsx)("div",{className:"dataTables_paginate paging_simple_numbers",id:"example2_paginate",children:(0,m.jsx)(N.A,{totalCount:de,itemsPerPage:10,handlePageClick:e=>{let{selected:a}=e;ie(a+1)}})})]})]})]})})})})})})]})}}}]);
//# sourceMappingURL=2123.2b896b2c.chunk.js.map