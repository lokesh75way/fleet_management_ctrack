"use strict";(self.webpackChunkFLEET=self.webpackChunkFLEET||[]).push([[5110],{79055:(e,l,a)=>{a.d(l,{A:()=>b});var s=a(65043),n=a(13052),t=a(28334),r=a(74805),i=a(42297),o=a(85756),d=a(74117),c=a(70579);const u=e=>{let{countryCode:l,customStyle:a,setValue:n,id:t,dValues:r,Comptype:u}=e;const{t:m}=(0,d.Bd)(),[b,v]=(0,s.useState)([]),[h,x]=(0,s.useState)(null);(0,s.useEffect)((()=>{const e=o.Ay.getCountry(l);if(e){const l=e.timezones;l&&l.length>0&&(v(l.map((e=>({label:"(GMT ".concat(f(e),") ").concat(e," "),value:e})))),x({label:"(GMT ".concat(f(l[0]),") ").concat(l[0]," "),value:l[0]}),n("timezone",l[0]))}}),[l]),(0,s.useEffect)((()=>{if(r&&t){var e,l;const a="companyId"===u?null===(e=r.companyId)||void 0===e?void 0:e.timezone:"businessGroupId"===u?null===(l=r.businessGroupId)||void 0===l?void 0:l.timezone:r.timezone;n("timezone",a),a&&(x({label:"(GMT ".concat(f(a),") ").concat(a),value:a}),console.log(h,"hi"))}}),[r,t]);const f=e=>{const l=o.Ay.getTimezone(e).utcOffset,a=Math.abs(Math.floor(l/60)),s=Math.abs(l%60);return"".concat(l>=0?"+":"-").concat(a,":").concat(s.toString().padStart(2,"0"))};return(0,c.jsxs)("div",{className:"col-xl-3",children:[(0,c.jsxs)("label",{htmlFor:"timezone",children:[m("timezone"),":"]}),(0,c.jsx)(i.Ay,{id:"timezone",value:h,styles:a,onChange:e=>{n("timezone",e.value),x(e)},options:b})]})},m={control:e=>({...e,padding:".25rem 0 "})},b=e=>{let{register:l,setValue:a,errors:o,getValues:b,locationData:v,dValues:h,id:x,showCity:f,Comptype:j,showtimeZone:p=!0}=e;const{t:y}=(0,d.Bd)(),[g,N]=(0,s.useState)(null),[A,I]=(0,s.useState)(null),[C,S]=(0,s.useState)([]),[V,w]=(0,s.useState)([]),[E,F]=(0,s.useState)("IND");(0,s.useEffect)((()=>{(0,n.xb)().then((e=>{S(e)}))}),[]),(0,s.useEffect)((()=>{if(x){if(null!==h&&void 0!==h&&h.city&&a("city",h.city),null!==h&&void 0!==h&&h.country){a("country",h.country);const e=k.find((e=>e.value==(null===h||void 0===h?void 0:h.country)));e&&L(e)}null!==h&&void 0!==h&&h.state&&(a("state",h.state||""),I({value:h.state,label:h.state||""}))}else{var e,l,s,t,r,i,o,d;N({value:null===v||void 0===v||null===(e=v.country)||void 0===e?void 0:e.isoAlpha3,label:null===v||void 0===v||null===(l=v.country)||void 0===l?void 0:l.isoName}),a("country",null===v||void 0===v||null===(s=v.country)||void 0===s?void 0:s.isoAlpha3),F(null===v||void 0===v||null===(t=v.country)||void 0===t?void 0:t.isoAlpha2),I({value:null===v||void 0===v||null===(r=v.location)||void 0===r?void 0:r.principalSubdivision,label:(null===v||void 0===v||null===(i=v.location)||void 0===i?void 0:i.principalSubdivision)||""}),a("state",(null===v||void 0===v||null===(o=v.location)||void 0===o?void 0:o.principalSubdivision)||"");const c=G(null===v||void 0===v||null===(d=v.country)||void 0===d?void 0:d.isoAlpha3);(0,n.Wm)(c).then((e=>{w(e)}))}}),[v,x,h]);const G=e=>{const l=C.find((l=>l.iso3===e));return l?l.id:null},L=async e=>{const l=e.value,s=G(l),t=C.find((e=>e.iso3===l));F(t.iso2),a("country",l),N({value:l,label:t.name}),w([]),I({value:"",label:""});const r=await(0,n.Wm)(s);w(r)},z=e=>"United Arab Emirates"===(null===g||void 0===g?void 0:g.label)&&e.name.endsWith(" Emirate")?e.name.replace(" Emirate",""):e.name,k=C.map((e=>({value:e.iso3,label:e.name}))),B=V.map((e=>({value:e.name,label:z(e)})));return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("div",{className:"col-xl-3 mb-3",children:[(0,c.jsx)("label",{className:"form-label",children:y("country")}),(0,c.jsx)(i.Ay,{options:k,value:g,styles:m,onChange:L},g),!g&&(0,c.jsx)(t.A,{errorName:o.country})]}),(0,c.jsxs)("div",{className:"col-xl-3 mb-3",children:[(0,c.jsx)("label",{className:"form-label",children:y("state")}),(0,c.jsx)(i.Ay,{options:B,value:A,styles:m,onChange:e=>{const l=e.value,s=V.find((e=>e.name===l));"United Arab Emirates"===(null===g||void 0===g?void 0:g.label)&&null!==s&&void 0!==s&&s.name.endsWith(" Emirate")&&(s.name=s.name.replace(" Emirate","")),a("state",s.name),I({value:s.name,label:s.name})}},A),!A&&(0,c.jsx)(t.A,{errorName:o.state})]}),f&&(0,c.jsxs)("div",{className:"col-xl-3 mb-3",children:[(0,c.jsx)("label",{className:"form-label",children:y("city")}),(0,c.jsx)(r.A,{type:"text",register:l,label:"City",name:"city",placeholder:"",defaultValue:b("city")}),(0,c.jsx)(t.A,{errorName:o.city})]}),f&&p&&(0,c.jsx)(u,{setValue:a,id:x,countryCode:E,customStyle:m,Comptype:j})]})}},99793:(e,l,a)=>{a.d(l,{A:()=>o});a(65043);var s=a(74805),n=a(28334),t=a(27940),r=a(44978),i=a(70579);const o=e=>{var l,a,o,d,c,u,m,b;let{field:v,fields:h,index:x,register:f,getValues:j,errors:p,remove:y,id:g}=e;return(0,i.jsxs)("div",{className:"row",children:[(0,i.jsxs)("div",{className:"d-flex align-items-center",children:[h.length>1&&(0,i.jsx)("div",{className:"flex-grow-1 mb-3",children:(0,i.jsxs)("h5",{children:["User ",x+1]})}),h.length>1&&(0,i.jsx)("div",{className:"mr-5",onClick:()=>(e=>{y(e)})(x),children:t.Os.Delete})]}),(0,i.jsxs)("div",{className:"col-xl-3 mb-3",children:[(0,i.jsxs)("label",{className:"form-label",children:[(0,r.t)("name")," ",(0,i.jsx)("span",{className:"text-danger",children:"*"})]}),(0,i.jsx)(s.A,{type:"text",register:f,label:"name",name:"userInfo.".concat(x,".name"),placeholder:"",defaultValue:j("userInfo.".concat(x,".name"))}),(0,i.jsx)(n.A,{errorName:null===(l=p.userInfo)||void 0===l||null===(a=l[x])||void 0===a?void 0:a.name})]}),(0,i.jsxs)("div",{className:"col-xl-3 mb-3",children:[(0,i.jsxs)("label",{className:"form-label",children:[(0,r.t)("designation")," ",(0,i.jsx)("span",{className:"text-danger",children:"*"})]}),(0,i.jsx)(s.A,{type:"text",register:f,label:"designation",name:"userInfo.".concat(x,".designation"),placeholder:"",defaultValue:j("userInfo.".concat(x,".designation"))}),(0,i.jsx)(n.A,{errorName:null===(o=p.userInfo)||void 0===o||null===(d=o[x])||void 0===d?void 0:d.designation})]}),(0,i.jsxs)("div",{className:"col-xl-3 mb-3",children:[(0,i.jsxs)("label",{className:"form-label",children:[(0,r.t)("mobileNumber"),(0,i.jsx)("span",{className:"text-danger",children:"*"})]}),(0,i.jsx)(s.A,{type:"number",register:f,name:"userInfo.".concat(x,".mobileNumber"),label:"Mobile Number",placeholder:"",min:"0",onInput:e=>{const l=Math.max(0,e.target.value);e.target.value=l<1?"":l},defaultValue:j("userInfo.".concat(x,".mobileNumber"))}),(0,i.jsx)(n.A,{errorName:null===(c=p.userInfo)||void 0===c||null===(u=c[x])||void 0===u?void 0:u.mobileNumber})]}),(0,i.jsxs)("div",{className:"col-xl-3 mb-3",children:[(0,i.jsxs)("label",{className:"form-label",children:[(0,r.t)("email"),(0,i.jsx)("span",{className:"text-danger",children:"*"})]}),(0,i.jsx)(s.A,{type:"email",register:f,name:"userInfo.".concat(x,".email"),label:"email",placeholder:"",defaultValue:j("userInfo.".concat(x,".email"))}),(0,i.jsx)(n.A,{errorName:null===(m=p.userInfo)||void 0===m||null===(b=m[x])||void 0===b?void 0:b.email})]})]},v.id)}},94492:(e,l,a)=>{a.d(l,{A:()=>p});var s=a(65043),n=a(14282),t=a(24858),r=a(42297),i=a(73216),o=a(74117),d=a(28334),c=a(74805),u=a(92548),m=a(95474),b=a(99793),v=a(87460),h=a(79055),x=a(75636),f=a(70579);const j={control:e=>({...e,padding:".25rem 0 "})},p=e=>{let{setValue:l,getValues:a,register:p,onSubmit:y,handleSubmit:g,errors:N,control:A,isFormSubmitting:I,watch:C}=e;const{fields:S,append:V,remove:w}=(0,t.jz)({control:A,name:"userInfo"}),[E,F]=(0,s.useState)(),{t:G}=(0,o.Bd)(),{id:L}=(0,i.g)(),{location:z,error:k}=(0,x.A)();return(0,f.jsxs)("div",{className:"p-4",children:[(0,f.jsxs)("div",{className:"row",style:{width:"85%",margin:"auto"},children:[(0,f.jsx)("div",{children:k&&(0,f.jsx)("p",{children:k})}),(0,f.jsxs)("div",{className:"col-xl-3 mb-3",children:[(0,f.jsx)("label",{className:"form-label",children:G("businessGroup")}),(0,f.jsx)("span",{className:"text-danger",children:"*"}),(0,f.jsx)(t.xI,{name:"businessGroupId",control:A,rules:{required:!0},render:e=>{let{field:{onChange:s,value:n,name:t,ref:r}}=e;return(0,f.jsx)(u.A,{onChange:e=>{a("businessGroupId")!=e.value&&(l("businessGroupId",e.value),l("companyName",""),l("companyId",""),F(null))},defaultValue:n,customStyles:j,ref:r,name:t})}}),!a("businessGroupId")&&(0,f.jsx)(d.A,{errorName:N.businessGroupId})]}),(0,f.jsxs)("div",{className:"col-xl-3 mb-3",children:[(0,f.jsxs)("label",{className:"form-label",children:[G("company"),(0,f.jsx)("span",{className:"text-danger",children:"*"})]}),(0,f.jsx)(t.xI,{name:"companyId",control:A,rules:{required:!0},render:e=>{let{field:{onChange:a,value:s,name:n,ref:t}}=e;return(0,f.jsx)(m.A,{groupId:C("businessGroupId"),onChange:e=>{l("companyId",e.value),l("companyName",e.label),F(e)},defaultValue:s,value:E,customStyles:j,ref:t,name:n})}}),!a("companyId")&&(0,f.jsx)(d.A,{errorName:N.companyId})]}),(0,f.jsxs)("div",{className:"col-xl-3 mb-3 ",children:[(0,f.jsxs)("label",{className:"form-label",children:[G("branchName")," ",(0,f.jsx)("span",{className:"text-danger",children:"*"})]}),(0,f.jsx)(c.A,{type:"text",register:p,required:!0,label:"Branch Name",name:"branchName",placeholder:"",defaultValue:a("branchName")}),(0,f.jsx)(d.A,{errorName:N.branchName})]}),(0,f.jsxs)("div",{className:"col-xl-3 mb-3 ",children:[(0,f.jsx)("label",{className:"form-label",children:G("tradeLicenseNumber")}),(0,f.jsx)(c.A,{type:"text",register:p,label:"tradeLicenseNumber",name:"tradeLicenseNumber",placeholder:"",defaultValue:a("tradeLicenseNumber")}),(0,f.jsx)(d.A,{errorName:N.tradeLicenseNumber})]}),(0,f.jsxs)("div",{className:"col-xl-3 mb-3 ",children:[(0,f.jsx)("label",{className:"form-label",children:G("officeNo")}),(0,f.jsx)(c.A,{type:"text",register:p,label:"officeNumber",name:"officeNumber",placeholder:"",defaultValue:a("officeNumber")}),(0,f.jsx)(d.A,{errorName:N.officeNumber})]}),(0,f.jsxs)("div",{className:"col-xl-3 mb-3 ",children:[(0,f.jsxs)("label",{className:"form-label",children:[G("email"),(0,f.jsx)("span",{className:"text-danger",children:"*"})]}),(0,f.jsx)(c.A,{type:"email",register:p,label:"Email",name:"email",placeholder:"",defaultValue:a("email"),disabled:!!L}),(0,f.jsx)(d.A,{errorName:N.email})]}),(0,f.jsx)(h.A,{register:p,setValue:l,dValues:{country:a("country"),state:a("state"),city:a("city")},errors:N,getValues:a,locationData:z,id:L,showCity:!0,Comptype:""}),(0,f.jsxs)("div",{className:"col-xl-3 mb-3 ",children:[(0,f.jsx)("label",{className:"form-label",children:G("dateFormat")}),(0,f.jsx)(t.xI,{name:"dateFormat",control:A,render:e=>{let{field:{onChange:a,value:s,name:n,ref:t}}=e;return(0,f.jsx)(r.Ay,{onChange:e=>l("dateFormat",null===e||void 0===e?void 0:e.value),options:v.wJ,ref:t,name:n,styles:j,value:{value:s,label:s}})}}),(0,f.jsx)(d.A,{errorName:N.dateFormat})]}),(0,f.jsxs)("div",{className:"col-xl-3 mb-3 ",children:[(0,f.jsx)("label",{className:"form-label",children:G("timeFormat")}),(0,f.jsx)(t.xI,{name:"timeFormat",control:A,render:e=>{let{field:{onChange:a,value:s,name:n,ref:t}}=e;return(0,f.jsx)(r.Ay,{onChange:e=>l("timeFormat",e.value),options:v.lD,ref:t,name:n,styles:j,value:{value:s,label:s},defaultValue:v.lD[1]})}})]}),(0,f.jsxs)("div",{style:{width:"100%",display:"flex",justifyContent:"space-between",margin:"2rem 0"},children:[(0,f.jsx)("h3",{children:G("contactDetails")}),(0,f.jsxs)(n.A,{type:"button",onClick:()=>{V({name:"",designation:"",mobileNumber:null,email:""})},style:{width:"10%"},children:[" ","ADD"]})]}),S.map(((e,l)=>(0,f.jsx)(b.A,{field:e,index:l,register:p,getValues:a,errors:N,fields:S,remove:w,id:L},e.id)))]}),(0,f.jsx)("div",{style:{width:"100%",display:"flex",justifyContent:"center",margin:"2rem 0"},children:(0,f.jsxs)(n.A,{type:"submit",disabled:I,onClick:g(y),style:{width:"10%"},children:[" ",G("submit")]})})]})}},95110:(e,l,a)=>{a.r(l),a.d(l,{default:()=>N});var s=a(65043),n=a(73216),t=a(44816),r=a(86856),i=a(24858),o=(a(9531),a(18403)),d=a(63248),c=a(28261),u=a(47097),m=a(74117),b=a(40399),v=a(70228),h=a(42457),x=a(272),f=a(19019),j=a(94492),p=a(87460),y=a(15395),g=a(70579);const N=()=>{var e,l;const{t:a}=(0,m.Bd)(),[N,A]=(0,s.useState)(0),{id:I}=(0,n.g)(),C=[a(I?"editBranch":"newBranch")],S=[j.A],V=(0,n.Zp)(),w=(0,d.jE)(),{data:E,isLoading:F,isError:G}=(0,c.I)({queryKey:["branch",I],queryFn:()=>(0,f.dh)(I),enabled:!!I,staleTime:1/0});(0,s.useEffect)((()=>{G&&I&&((0,h.U)("Not able to fetch branch data"),V("/not-found"))}),[G&&I]);const L=(0,s.useMemo)((()=>{var e,l;return{...E,businessGroupId:null===E||void 0===E||null===(e=E.businessGroupId)||void 0===e?void 0:e._id,companyId:null===E||void 0===E||null===(l=E.companyId)||void 0===l?void 0:l._id}}),[E]),{register:z,formState:{errors:k},setValue:B,getValues:D,control:T,handleSubmit:M,watch:U}=(0,i.mN)({defaultValues:{companyId:"",businessGroupId:"",userInfo:[{name:"",designation:"",mobileNumber:null,email:""}],timeFormat:null===(e=p.lD[1])||void 0===e?void 0:e.value,dateFormat:null===(l=p.wJ[1])||void 0===l?void 0:l.value},resolver:(0,o.t)(v.dZ),values:L}),{mutate:q,isPending:K}=(0,u.n)({mutationFn:f.v9,onSuccess:()=>{(0,h.V)("Branch has been created"),w.invalidateQueries(["branches"]),V("/branch")},onError:e=>(0,h.U)((0,x.SU)(e))}),{mutate:P,isPending:W}=(0,u.n)({mutationFn:e=>{let{data:l,id:a}=e;return(0,f.t0)(a,l)},onSuccess:()=>{(0,h.V)("Branch has been updated!"),w.invalidateQueries(["branches"]),V("/branch")},onError:e=>{(0,h.U)(e.message)}}),O=async e=>{0===N&&(null!=e.logo&&0!==e.logo.length||delete e.logo,e.file&&0===e.file.length&&delete e.file,I?P({data:e,id:I}):q(e))};return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(b.A,{mainTitle:"Branch",pageTitle:I?"Edit":"Create",parentTitle:"Branch"}),(0,g.jsx)("div",{className:"m-2 p-2",children:(0,g.jsx)(i.Op,{children:(0,g.jsx)("form",{onSubmit:M(O),children:(0,g.jsx)("div",{className:"default-tab",children:(0,g.jsxs)(t.A.Container,{defaultActiveKey:C[0].toLowerCase(),children:[(0,g.jsx)(r.A,{as:"ul",className:"nav-tabs",children:C.map(((e,l)=>(0,g.jsx)(r.A.Item,{as:"li",children:(0,g.jsx)(r.A.Link,{style:{padding:".5rem 2rem"},eventKey:e.toLowerCase(),active:l===N,onClick:()=>A(l),children:e})},l)))}),(0,g.jsx)(t.A.Content,{className:"pt-4",children:F?(0,g.jsx)(y.A,{height:500}):C.map(((e,l)=>{const a=S[l];return(0,g.jsx)(t.A.Pane,{eventKey:e.toLowerCase(),active:l===N,children:(0,g.jsx)(a,{data:C,control:T,setValue:B,register:z,getValues:D,errors:k,handleSubmit:M,onSubmit:O,watch:U,isFormSubmitting:K||W})},l)}))})]})})})})})]})}},75636:(e,l,a)=>{a.d(l,{A:()=>t});var s=a(65043),n=a(77154);const t=()=>{const[e,l]=(0,s.useState)(null),[a,t]=(0,s.useState)(null),[r,i]=(0,s.useState)(null),[o,d]=(0,s.useState)(null),[c,u]=(0,s.useState)(!1);return(0,s.useEffect)((()=>{(async()=>{try{u(!0);const e="bdc_031d6a642ab94e0b8f5376a97ded1793";if(!e)throw new Error("API key is missing.");const a=await n.A.get("https://api.bigdatacloud.net/data/ip-geolocation?key=".concat(e));l(a.data.location.latitude),t(a.data.location.longitude);const s=a.data;d(s),i(null)}catch(r){i("Error getting location data: "+r.message)}finally{u(!1)}})()}),[]),{location:o,lat:e,lng:a,isLoading:c,error:r}}}}]);
//# sourceMappingURL=5110.1cd0961d.chunk.js.map