"use strict";(self.webpackChunkFLEET=self.webpackChunkFLEET||[]).push([[8995],{48995:(e,a,s)=>{s.r(a),s.d(a,{default:()=>S});var t=s(65043),n=s(73216),l=s(35475),r=s(9866),c=s(6720),i=s(60184),o=s(51359),d=(s(71232),s(59167),s(10966)),h=s(70579);const m=e=>{let{onConfirmDelete:a,params:s,tempValue:t,tempValue2:n,tableData:r,editDrawerOpen:m,setDataLength:u}=e;var p=r;const{can:x}=(0,d.S)(),b=x("branch","modify"),g=x("branch","delete");"All Companies"!==t&&(p=r.filter((e=>"branch"===e.role&&e.parentCompany===t))),"All Branches"!==n&&(p=r.filter((e=>"branch"===e.role&&e.parentBranch===n)));for(var j=[],f=0;f<p.length;f++){const e=p[f].userName;j[f]=p.filter((a=>a.parentBranch===e)).length}return(0,h.jsx)(h.Fragment,{children:p.map(((e,s)=>{var t,n,r,d,u,p;return(0,h.jsxs)("tr",{children:[(0,h.jsx)("td",{children:(0,h.jsx)("span",{children:s+1})}),(0,h.jsx)("td",{children:(0,h.jsx)("span",{className:"text-primary",children:e.branchName})}),(0,h.jsx)("td",{children:(0,h.jsx)("span",{children:null!==(t=e.parentBranchId)&&void 0!==t&&t.branchName?null===(n=e.parentBranchId)||void 0===n?void 0:n.branchName:(0,h.jsx)("span",{className:"ps-4",children:"-"})})}),(0,h.jsx)("td",{children:(0,h.jsx)("span",{children:null!==(r=e.companyId)&&void 0!==r&&r.companyName?null===(d=e.companyId)||void 0===d?void 0:d.companyName:(0,h.jsx)("span",{className:"ps-4",children:"-"})})}),(0,h.jsx)("td",{children:(0,h.jsx)("span",{children:null!==(u=e.businessGroupId)&&void 0!==u&&u.groupName?null===(p=e.businessGroupId)||void 0===p?void 0:p.groupName:(0,h.jsx)("span",{className:"ps-4",children:"-"})})}),(0,h.jsx)("td",{children:(0,h.jsx)("span",{children:e.city})}),(0,h.jsx)("td",{children:(0,h.jsx)(l.N_,{to:"/branch/bid/".concat(e.id),className:"text-primary badge light border-0 badge-count",children:j[s]})}),(b||g)&&(0,h.jsx)("td",{children:(0,h.jsxs)("span",{className:"d-flex justify-content-center",children:[b&&(0,h.jsx)("span",{className:"cursor-pointer",onClick:()=>m(e._id),children:(0,h.jsx)(i.uO9,{style:{color:"green",fontSize:"1.2rem"}})}),g&&(0,h.jsx)(o.A,{className:"cursor-pointer ",onConfirmDelete:a,id:e._id,children:(0,h.jsx)(c.b6i,{style:{color:"red",fontSize:"1.2rem"}})})]})})]},s)}))})};var u=s(24858),p=(s(99482),s(74117)),x=s(58387),b=s(33723),g=s(66948),j=s(42457),f=s(94692),v=s(12954),N=(s(85539),s(272)),y=s(83700);const S=()=>{const{isRtl:e}=(0,t.useContext)(b.D),a=(0,x.$)({"fa-solid fa-angle-right":e,"fa-solid fa-angle-left":!e}),s=(0,x.$)({"fa-solid fa-angle-left":e,"fa-solid fa-angle-right":!e}),{can:c,setUserPermission:i}=(0,d.S)(),{t:o}=(0,p.Bd)(),S=(0,n.Zp)(),[C,_]=((0,n.g)(),(0,t.useState)({value:"All Companies",label:"All Companies"})),[w,A]=(0,t.useState)({value:"All Branches",label:"All Branches"}),[B,I]=(0,t.useState)("All Companies"),[D,k]=(0,t.useState)("All Branches"),[T,E]=(0,t.useState)(document.querySelectorAll("#employee-tbl_wrapper tbody tr")),V={control:e=>({...e,marginRight:"1rem",marginLeft:"1rem",width:"15rem",height:"0.6rem",menuPortal:e=>({...e,zIndex:9999}),menu:e=>({...e,zIndex:9999})})},O=localStorage.getItem("loginDetails-name"),P=localStorage.getItem("role"),{control:J,setValue:z,getValues:F,watch:G}=(0,u.mN)(),L=JSON.parse(localStorage.getItem("userJsonData")).filter((e=>"branch"===e.role)),[q,M]=(0,t.useState)(null),[R,$]=(0,t.useState)([]),[H,U]=(0,t.useState)({id:0,reseller:"",contact:0,username:"",status:"",location:"",usergroup:"",branches:0}),[Z,K]=(0,t.useState)({label:"All Companies",value:"All Companies"}),[Q,W]=(0,t.useState)({label:"All Branches",value:"All Branches"}),[X,Y]=(0,t.useState)([]),[ee,ae]=(0,t.useState)([]),[se,te]=(0,t.useState)(null),[ne,le]=(0,t.useState)(null),{page:re,nextPage:ce,prevPage:ie,goToPage:oe,setCount:de,totalCount:he,setPage:me}=((0,N.Bc)(),(0,f.A)()),ue=async(e,a,s)=>{try{if(a){const{data:e,success:s}=await(0,g.e3)(void 0,a);$(e.data),de(e.totalCount),ae(e.data)}else if(s){const{data:e,success:a}=await(0,g.e3)(void 0,void 0,s);$(e.data),de(e.totalCount),ae(e.data)}else{var t;const{data:a,success:s}=await(0,g.e3)(e),n=JSON.parse(localStorage.getItem("permission"));i(null===n||void 0===n||null===(t=n[0])||void 0===t?void 0:t.permission),$(a.data),de(a.totalCount)}}catch(n){console.log("Error in fetching data",n)}};(0,t.useEffect)((()=>{ue(re)}),[re]);ee.filter((e=>se&&e.companyId._id===se.value)).map((e=>({value:e._id,label:e.branchName}))),JSON.parse(localStorage.getItem("userJsonData"));return(0,t.useEffect)((()=>{if("admin"!==P)if("businessgroup"===P){const e=L.filter((e=>e.parentBusinessGroup===O));$(e)}else if("company"===P){const e=L.filter((e=>e.parentCompany===O));$(e)}}),[O,P,L]),(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(r.A,{mainTitle:"Branch",pageTitle:"Branch",parentTitle:"Home"}),(0,h.jsx)("div",{className:"container-fluid",children:(0,h.jsx)("div",{className:"row",children:(0,h.jsx)("div",{className:"col-xl-12",children:(0,h.jsx)("div",{className:"card",children:(0,h.jsx)("div",{className:"card-body p-0",children:(0,h.jsxs)("div",{className:"table-responsive active-projects style-1 ItemsCheckboxSec shorting",children:[(0,h.jsxs)("div",{className:"tbl-caption d-flex justify-content-between text-wrap align-items-center",children:[(0,h.jsx)("h4",{className:"heading mb-0",children:o("branches")}),(0,h.jsxs)("div",{className:"d-flex align-items-center",children:[(0,h.jsx)(l.N_,{className:"btn  btn-xxs","data-bs-toggle":"offcanvas",onClick:()=>{ue(),M(null),z("company",""),z("parent",""),K({label:"All companies",value:"All companies"})},style:{background:"gray",border:"gray",color:"white"},children:"Clear"}),(0,h.jsx)(u.xI,{name:"company",control:J,rules:{required:!0},render:e=>{let{field:{onChange:a,value:s,name:t,ref:n}}=e;return(0,h.jsx)(v.A,{onChange:async e=>{var a;z("company",e.value),M(e.value),te(a=e),_(a),M(a.value),me(1),ue(1,a.value)},value:s||Z,customStyles:V,name:t,ref:n,isDisabled:!1},q)}}),(0,h.jsx)(u.xI,{name:"parent",control:J,rules:{required:!0},render:e=>{let{field:{onChange:a,value:s,name:t,ref:n}}=e;return(0,h.jsx)(y.A,{onChange:e=>{var a;z("parent",e.value),le(a=e),A(a),me(1),ue(1,void 0,a.value)},companyId:q,value:s||Q,customStyles:V,ref:n,name:t,isDisabled:!1},q)}}),c("branch","add")&&(0,h.jsxs)(l.N_,{to:"/branch/create",className:"btn btn-primary btn-sm ms-1",style:{paddingBlock:"9px"},"data-bs-toggle":"offcanvas",children:["+ ",o("addBranch")]})," "]})]}),(0,h.jsxs)("div",{id:"employee-tbl_wrapper",className:"dataTables_wrapper no-footer",children:[(0,h.jsxs)("table",{id:"empoloyees-tblwrapper",className:"table ItemsCheckboxSec dataTable no-footer mb-0",children:[(0,h.jsx)("thead",{children:(0,h.jsxs)("tr",{children:[(0,h.jsx)("th",{children:o("id")}),(0,h.jsx)("th",{children:o("branchName")}),(0,h.jsx)("th",{children:o("parentBranch")}),(0,h.jsx)("th",{children:o("companyName")}),(0,h.jsx)("th",{children:o("businessGroup")}),(0,h.jsx)("th",{children:o("location")}),(0,h.jsx)("th",{children:o("childBranches")}),(c("branch","modify")||c("branch","delete"))&&(0,h.jsx)("th",{children:o("action")})]})}),(0,h.jsx)("tbody",{children:(0,h.jsx)(m,{tempValue:B,tempValue2:D,editData:H,tableData:R,onConfirmDelete:async e=>{await(0,g.SN)(e),(0,j.V)("Branch Deleted"),await ue()},editDrawerOpen:e=>{const a=R.filter((a=>a._id===e));S("edit/".concat(e),{state:a})},setEditData:U},R)})]}),(0,h.jsxs)("div",{className:"d-sm-flex text-center justify-content-between align-items-center",children:[(0,h.jsxs)("div",{className:"dataTables_info",children:[o("showing")," ",10*(re-1)+1," ",o("to")," ",Math.min(10*re,he)," ",o("of")," ",he," ",o("entries")]}),(0,h.jsxs)("div",{className:"dataTables_paginate paging_simple_numbers",id:"example2_paginate",children:[(0,h.jsx)(l.N_,{className:"paginate_button ".concat(1===re?"previous disabled":"previous"),to:"/branch",onClick:()=>ie(re-1),children:(0,h.jsx)("i",{className:a})}),(0,h.jsx)("span",{children:[...Array(Math.ceil(he/10)).keys()].map((e=>(0,h.jsx)(l.N_,{className:"paginate_button ".concat(re===e+1?"current":""),onClick:()=>oe(e+1),children:e+1},e)))}),(0,h.jsx)(l.N_,{className:"paginate_button ".concat(10*re>=he?"next disabled":"next"),to:"/branch",onClick:()=>ce(re+1),children:(0,h.jsx)("i",{className:s})})]})]})]})]})})})})})})]})}}}]);
//# sourceMappingURL=8995.2170c5ea.chunk.js.map