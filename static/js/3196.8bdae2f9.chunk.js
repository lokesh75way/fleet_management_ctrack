"use strict";(self.webpackChunkFLEET=self.webpackChunkFLEET||[]).push([[3196],{50014:(e,t,s)=>{s.d(t,{A:()=>n});var i=s(65043),a=s(70579);const d=function(e){const{onClick:t,data:s,isActive:i}=e,{title:d,icon:n}=s;return(0,a.jsx)("div",{onClick:t,className:"card same-card mx-2 bg-white col-xl-2 col-lg-4 cold-md-4 col-sm-6 ".concat(i?"active-tab":""),style:{height:"160px",width:"160px",border:i?"1px solid #4C9AFF":"1px solid #E6E6E6"},children:(0,a.jsx)("div",{className:"card-body d-flex align-items-center",children:(0,a.jsxs)("div",{className:"d-flex flex-column align-items-center w-100 pb-2",children:[n&&(0,a.jsx)("span",{className:"card-text text-primary fs-1 mb-2",children:n}),(0,a.jsx)("h6",{className:"card-text text-primary text-center fs-4",children:d})]})})})};const n=function(e){const{tabs:t=[]}=e,[s,n]=(0,i.useState)(t[0]);return(0,a.jsxs)("div",{className:"container-fluid",children:[(0,a.jsx)("div",{className:"tabs row w-100",children:t.map(((e,t)=>(0,a.jsx)(d,{data:e,isActive:s===e,onClick:()=>{n(e)}},t)))}),s&&(0,a.jsx)("div",{children:s.component})]})}},3196:(e,t,s)=>{s.r(t),s.d(t,{default:()=>v});var i=s(65043),a=s(9866),d=s(50014),n=s(60184),r=s(38628),o=s(64196),l=s(2364),c=s(35514);s(33723),s(53536);var m=s(73216),u=s(74117),h=(s(23764),s(42457)),p=s(70579);const x=e=>{let{isEditTrue:t,setIsEditTrue:s}=e;const{t:a}=(0,u.Bd)(),[d,n]=(0,i.useState)([]),[x,v]=(0,i.useState)([]),[f,g]=(0,i.useState)([]),y=(0,m.Zp)(),{id:j}=(0,m.g)(),[b,w]=(0,i.useState)({name:"",permission:{}}),[k,N]=(0,i.useState)([]),[A,E]=(0,i.useState)(null),T=(e,t,s)=>{let i=[...f];const a={...i.find((e=>e._id===s)).permission};a[t]=!!e;const d=i.findIndex((e=>e._id===s));i[d].permission=a,g(i)},C=(e,t,s,i)=>{const a=f.map((a=>{if(a._id===s){const s=a.subModules.map((s=>{if(s.id===i){const i={...s.permission};return i[t]=e,{...s,permission:i}}return s}));return{...a,subModules:s}}return a}));g(a)},[_,M]=(0,i.useState)(!1);(0,i.useEffect)((()=>{if(-1!==t){const e=d.filter(((e,s)=>s===t));w({name:e.name,permission:e.permission}),console.log(e)}}),[]),(0,i.useEffect)((()=>{(async()=>{try{const e=await c.A.listModule(),t={add:!1,view:!1,modify:!1,delete:!1},s=[...e.data].map((e=>{const s=[...e.subModules].map((e=>({...e,permission:t})));return{...e,permission:t,subModules:s}}));console.log("ye he new Data",s),g(s),console.log({newData:s})}catch(e){console.error("Error fetching template data:",e)}})()}),[]);const[D,F]=(0,i.useState)(),S=d.map((e=>e.name));console.log("this is group data state ",S);(0,i.useEffect)((()=>{(async()=>{try{const e=await c.A.getTemplates();if(j){const t=await c.A.listModule(),s=e.data.data.find((e=>e._id===j));w(s),F(s.name);const i=t.data.map((e=>{const t=s.permission.find((t=>t.moduleId===e._id));return t&&(e.permission={add:null===t||void 0===t?void 0:t.add,view:null===t||void 0===t?void 0:t.view,modify:null===t||void 0===t?void 0:t.modify,delete:null===t||void 0===t?void 0:t.delete}),e}));g(i),v(s.permission.filter((e=>!(!e.delete&&!e.view&&!e.modify&&!e.add))).map((e=>e.moduleId)))}n(e.data.data),N(e.data.data.map((e=>({value:e._id,label:e.name}))))}catch(e){console.error("Error fetching template data:",e)}})()}),[]),console.log("is error : ",_);let I=!1;return(0,p.jsx)("div",{children:(0,p.jsxs)(r.A,{children:[(0,p.jsx)(r.A.Header,{children:(0,p.jsx)(r.A.Title,{children:a("permission")})}),(0,p.jsxs)("div",{className:"d-flex justify-content-between m-2 mt-4 p-3 mb-0 pb-0",children:[(0,p.jsx)("div",{children:(0,p.jsx)("input",{value:b.name,name:"groupname",type:"text",className:"p-2",onChange:e=>(e=>{M(!1);const{value:t}=e.target;w((e=>({...e,name:t})))})(e),style:{marginRight:"1rem",border:"#D3D3D3 1px solid",borderRadius:"0.3rem",width:"15rem"},placeholder:a("featureTemplateName")})}),(0,p.jsxs)("div",{className:"d-flex justify-content-center",style:{width:"25rem"},children:[(0,p.jsx)(l.Ay,{options:k,placeholder:a("selectFeatureTemplate"),styles:{control:e=>({...e,width:"18rem"})},onChange:e=>{const t=d.find((t=>t._id===e.value));E(t)},children:" "})," ",(0,p.jsx)("button",{className:"btn btn-primary",style:{marginLeft:"1rem",padding:"7px 16px",marginRight:"1rem"},onClick:()=>{if(!A)return;const e=f.map((e=>{const t=A.permission.find((t=>t.moduleId===e._id));return t&&(e.permission={add:null===t||void 0===t?void 0:t.add,view:null===t||void 0===t?void 0:t.view,modify:null===t||void 0===t?void 0:t.modify,delete:null===t||void 0===t?void 0:t.delete}),e}));g(e),v(e.filter((e=>{var t,s,i,a;return!((null===(t=e.permission)||void 0===t||!t.delete)&&(null===(s=e.permission)||void 0===s||!s.view)&&(null===(i=e.permission)||void 0===i||!i.modify)&&(null===(a=e.permission)||void 0===a||!a.add))})).map((e=>e._id))),console.log("Data copied successfully")},children:a("copy")})]})]}),(0,p.jsx)("div",{className:"ms-4 pt-0 mt-0",children:_&&(0,p.jsx)("span",{className:"text-danger text-sm pt-0 mt-0",style:{marginBottom:"1rem"},children:"feature template name is required"})}),(0,p.jsxs)(r.A.Body,{className:"d-flex",children:[(0,p.jsx)("div",{style:{flex:.4,maxHeight:"50vh",overflow:"auto",border:"1px solid #D3D3D3  ",borderRadius:"0.5rem"},children:(0,p.jsxs)(o.A,{children:[(0,p.jsx)("thead",{style:{position:"sticky",top:0,background:"white"},children:(0,p.jsx)("tr",{children:(0,p.jsx)("th",{scope:"col",children:a("module")})})}),(0,p.jsx)("tbody",{children:f.map(((e,t)=>e&&e.title?(0,p.jsx)(i.Fragment,{children:(0,p.jsx)("tr",{children:(0,p.jsxs)("td",{children:[(0,p.jsx)("input",{type:"checkbox",className:"form-check-input",style:{marginRight:"0.2rem"},name:"create",checked:x.includes(e._id),onChange:t=>((e,t)=>{v(e?e=>[...e,t]:e=>e.filter((e=>e!==t)))})(t.target.checked,e._id)}),(0,p.jsx)("span",{style:{marginRight:"1.7rem"},children:a(e.title)})]})})},e._id):null))})]})}),(0,p.jsx)("div",{style:{flex:1,maxHeight:"50vh",overflow:"auto",border:"1px solid #D3D3D3",borderRadius:"0.5rem",marginLeft:"0.2rem"},children:(0,p.jsxs)(o.A,{children:[(0,p.jsx)("thead",{id:"feature_template",style:{position:"sticky",top:0,background:"white"},children:(0,p.jsxs)("tr",{children:[(0,p.jsx)("th",{scope:"col",className:"col-4",style:{width:"150px"},children:a("subModules")}),(0,p.jsx)("th",{scope:"col",children:a("add")}),(0,p.jsx)("th",{scope:"col",children:a("view")}),(0,p.jsx)("th",{scope:"col",children:a("modify")}),(0,p.jsx)("th",{scope:"col",children:a("delete")})]})}),(0,p.jsx)("tbody",{className:"feature_template_table",children:x.length>0&&x.map(((e,t)=>{var s,a,d,n;const r=f.find((t=>t._id===e));return r?(r.subModules.length>0&&(I=!0),console.log("yeee aaa gaya module dataa",r),(0,p.jsxs)(i.Fragment,{children:[(0,p.jsxs)("tr",{children:[(0,p.jsxs)("td",{className:"col-2",style:{width:"130px"},children:[" ",r.title]}),(0,p.jsx)("td",{children:(0,p.jsx)("input",{type:"checkbox",checked:null===(s=r.permission)||void 0===s?void 0:s.add,onChange:t=>T(t.target.checked,t.target.name,e),className:"form-check-input",name:"add",disabled:I&&r.subModules.length>0})}),(0,p.jsx)("td",{children:(0,p.jsx)("input",{type:"checkbox",checked:null===(a=r.permission)||void 0===a?void 0:a.view,className:"form-check-input",onChange:t=>T(t.target.checked,t.target.name,e),name:"view"})}),(0,p.jsx)("td",{children:(0,p.jsx)("input",{type:"checkbox",checked:null===(d=r.permission)||void 0===d?void 0:d.modify,className:"form-check-input",onChange:t=>T(t.target.checked,t.target.name,e),disabled:I&&r.subModules.length>0,name:"modify"})}),(0,p.jsx)("td",{children:(0,p.jsx)("input",{type:"checkbox",checked:null===(n=r.permission)||void 0===n?void 0:n.delete,className:"form-check-input",onChange:t=>T(t.target.checked,t.target.name,e),disabled:I&&r.subModules.length>0,name:"delete"})})]}),r.subModules.map(((t,s)=>{var i,a,d,n;return(0,p.jsxs)("tr",{children:[(0,p.jsxs)("td",{className:"col-2",children:[" ",t.title]}),(0,p.jsx)("td",{children:(0,p.jsx)("input",{type:"checkbox",checked:null===(i=t.permission)||void 0===i?void 0:i.add,onChange:s=>C(s.target.checked,s.target.name,e,t.id),className:"form-check-input",name:"add"})}),(0,p.jsx)("td",{children:(0,p.jsx)("input",{type:"checkbox",checked:null===(a=t.permission)||void 0===a?void 0:a.view,onChange:s=>C(s.target.checked,s.target.name,e,t.id),className:"form-check-input",name:"view"})}),(0,p.jsx)("td",{children:(0,p.jsx)("input",{type:"checkbox",checked:null===(d=t.permission)||void 0===d?void 0:d.modify,onChange:s=>C(s.target.checked,s.target.name,e,t.id),className:"form-check-input",name:"modify"})}),(0,p.jsx)("td",{children:(0,p.jsx)("input",{type:"checkbox",checked:null===(n=t.permission)||void 0===n?void 0:n.delete,onChange:s=>C(s.target.checked,s.target.name,e,t.id),className:"form-check-input",name:"delete"})})]},s)}))]},t)):null}))})]})})]}),(0,p.jsx)("div",{className:"d-flex justify-content-end  p-3",children:(0,p.jsxs)("button",{className:"btn btn-primary",style:{marginLeft:"1rem",padding:"7px 16px"},onClick:async()=>{if(b.name){if(j){if(S.includes(b.name)&&b.name!==D)return void(0,h.U)("Feature Template name already exists")}else if(S.includes(b.name))return void(0,h.U)("Feature Template name already exists");try{M(!1),console.log(f,"data-;;");const e=f.reduce(((e,t)=>{var s,i,a,d;const n={moduleId:t._id,add:null===(s=t.permission)||void 0===s?void 0:s.add,view:null===(i=t.permission)||void 0===i?void 0:i.view,modify:null===(a=t.permission)||void 0===a?void 0:a.modify,delete:null===(d=t.permission)||void 0===d?void 0:d.delete};return e.push(n),t.subModules&&t.subModules.length>0&&!j&&t.subModules.forEach((t=>{var s,i,a,d;const n={moduleId:t.id,add:null===(s=t.permission)||void 0===s?void 0:s.add,view:null===(i=t.permission)||void 0===i?void 0:i.view,modify:null===(a=t.permission)||void 0===a?void 0:a.modify,delete:null===(d=t.permission)||void 0===d?void 0:d.delete};e.push(n)})),e}),[]),t={...b,permission:e};w((t=>({...t,permission:e})));const s=j?c.A.udpateTemplate:c.A.createTemplate;await s(t),v([]),console.log("Data saved successfully"),(0,h.V)("saved"),y("/groups")}catch(e){console.error("Error saving data:",e)}}else M(!0)},children:[" ",j?"Update":"Save"," "]})})]})})},v=()=>{const{t:e}=(0,u.Bd)(),t=(0,m.zy)(),{isEditTrue:s,setIsEditTrue:i}=JSON.parse(t.state);console.log(s,i);const r=[{title:"Permission",component:(0,p.jsx)(x,{isEditTrue:s,setIsEditTrue:i}),icon:(0,p.jsx)(n.x$1,{})}];return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(a.A,{mainTitle:e("permission"),pageTitle:e("permission"),parentTitle:e("Feature Templates")}),(0,p.jsx)(d.A,{tabs:r})]})}},35514:(e,t,s)=>{s.d(t,{A:()=>n,y:()=>d});s(99080);var i=s(88472),a=s(77154);(0,i.A)();const d=async e=>{try{console.log("page is here ",e);let t="/feature-template";void 0!==e&&(t+="?page=".concat(e,"&limit=",10));return(await a.A.get(t)).data}catch(t){return console.error("Error fetching templates:",t),{error:"Couldn't fetch User"}}},n={getTemplates:async e=>{try{return(await a.A.get("/feature-template",e)).data}catch(t){throw console.error("Error fetching modules:",t),t}},createTemplate:async e=>{try{console.log(e);return(await a.A.post("/feature-template",e)).data}catch(t){throw console.error("Error fetching modules:",t),t}},listModule:async e=>{try{return(await a.A.get("/modules",e)).data}catch(t){throw console.error("Error fetching modules:",t),t}},udpateTemplate:async e=>{try{return(await a.A.patch("/feature-template",e)).data}catch(t){throw console.error("Error fetching modules:",t),t}},deleteTemplate:async e=>{try{return(await a.A.delete("/feature-template/".concat(e))).data}catch(t){throw console.error("Error fetching modules:",t),t}}}}}]);
//# sourceMappingURL=3196.8bdae2f9.chunk.js.map