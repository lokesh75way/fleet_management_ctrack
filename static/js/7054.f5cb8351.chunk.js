"use strict";(self.webpackChunkFLEET=self.webpackChunkFLEET||[]).push([[7054],{50014:(e,t,s)=>{s.d(t,{A:()=>a});var i=s(65043),d=s(70579);const n=function(e){const{onClick:t,data:s,isActive:i}=e,{title:n,icon:a}=s;return(0,d.jsx)("div",{onClick:t,className:"card same-card mx-2 bg-white col-xl-2 col-lg-4 cold-md-4 col-sm-6 ".concat(i?"active-tab":""),style:{height:"160px",width:"160px",border:i?"1px solid #4C9AFF":"1px solid #E6E6E6"},children:(0,d.jsx)("div",{className:"card-body d-flex align-items-center",children:(0,d.jsxs)("div",{className:"d-flex flex-column align-items-center w-100 pb-2",children:[a&&(0,d.jsx)("span",{className:"card-text text-primary fs-1 mb-2",children:a}),(0,d.jsx)("h6",{className:"card-text text-primary text-center fs-4",children:n})]})})})};const a=function(e){const{tabs:t=[]}=e,[s,a]=(0,i.useState)(t[0]);return(0,d.jsxs)("div",{className:"container-fluid",children:[(0,d.jsx)("div",{className:"tabs row w-100",children:t.map(((e,t)=>(0,d.jsx)(n,{data:e,isActive:s===e,onClick:()=>{a(e)}},t)))}),s&&(0,d.jsx)("div",{children:s.component})]})}},47054:(e,t,s)=>{s.r(t),s.d(t,{default:()=>v});var i=s(65043),d=s(40399),n=s(50014),a=s(60184),r=s(38628),l=s(64196),o=s(42297),c=s(35514),m=s(73216),u=s(74117),h=s(42457),p=s(70579);const x=e=>{let{isEditTrue:t,setIsEditTrue:s}=e;const{t:d}=(0,u.Bd)(),[n,a]=(0,i.useState)([]),[x,v]=(0,i.useState)([]),[f,g]=(0,i.useState)([]),y=(0,m.Zp)(),{id:j}=(0,m.g)(),[b,w]=(0,i.useState)({name:"",permission:{}}),[k,N]=(0,i.useState)([]),[E,A]=(0,i.useState)(null),T=(e,t,s)=>{let i=[...f];const d={...i.find((e=>e._id===s)).permission};d[t]=!!e;const n=i.findIndex((e=>e._id===s));i[n].permission=d,g(i)},C=(e,t,s,i)=>{const d=f.map((d=>{if(d._id===s){const s=d.subModules.map((s=>{if(s.id===i){const i={...s.permission};return i[t]=e,{...s,permission:i}}return s}));return{...d,subModules:s}}return d}));g(d)},[M,_]=(0,i.useState)(!1);(0,i.useEffect)((()=>{if(-1!==t){const e=n.filter(((e,s)=>s===t));w({name:e.name,permission:e.permission})}}),[]),(0,i.useEffect)((()=>{(async()=>{try{const e=await c.A.listModule(),t={add:!1,view:!1,modify:!1,delete:!1},s=[...e.data].map((e=>{const s=[...e.subModules].map((e=>({...e,permission:t})));return{...e,permission:t,subModules:s}}));g(s)}catch(e){console.error("Error fetching template data:",e)}})()}),[]);const[D,F]=(0,i.useState)(),S=n.map((e=>e.name));(0,i.useEffect)((()=>{(async()=>{try{const e=await c.A.getTemplates();if(j){const t=await c.A.listModule(),s=e.data.data.find((e=>e._id===j));w(s),F(s.name);const i=t.data.map((e=>{const t=s.permission.find((t=>t.moduleId===(e.id||e._id)));return t&&(e.permission={add:null===t||void 0===t?void 0:t.add,view:null===t||void 0===t?void 0:t.view,modify:null===t||void 0===t?void 0:t.modify,delete:null===t||void 0===t?void 0:t.delete},e.subModules&&e.subModules.length>0&&e.subModules.forEach((e=>{const t=s.permission.find((t=>t.moduleId===(e.id||e._id)));t&&(e.permission={add:t.add,view:t.view,modify:t.modify,delete:t.delete})}))),e}));g(i),v(s.permission.filter((e=>!(!e.delete&&!e.view&&!e.modify&&!e.add))).map((e=>e.moduleId)))}a(e.data.data),N(e.data.data.map((e=>({value:e._id,label:e.name}))))}catch(e){console.error("Error fetching template data:",e)}})()}),[]);let I=!1;return(0,p.jsx)("div",{children:(0,p.jsxs)(r.A,{children:[(0,p.jsx)(r.A.Header,{children:(0,p.jsx)(r.A.Title,{children:d("permission")})}),(0,p.jsxs)("div",{className:"d-flex justify-content-between m-2 mt-4 p-3 mb-0 pb-0",children:[(0,p.jsx)("div",{children:(0,p.jsx)("input",{value:b.name,name:"groupname",type:"text",className:"p-2",onChange:e=>(e=>{_(!1);const{value:t}=e.target;w((e=>({...e,name:t})))})(e),style:{marginRight:"1rem",border:"#D3D3D3 1px solid",borderRadius:"0.3rem",width:"15rem"},placeholder:d("featureTemplateName")})}),(0,p.jsxs)("div",{className:"d-flex justify-content-center",style:{width:"25rem"},children:[(0,p.jsx)(o.Ay,{options:k,placeholder:d("selectFeatureTemplate"),styles:{control:e=>({...e,width:"18rem"})},onChange:e=>{const t=n.find((t=>t._id===e.value));A(t)},children:" "})," ",(0,p.jsx)("button",{className:"btn btn-primary",style:{marginLeft:"1rem",padding:"7px 16px",marginRight:"1rem"},onClick:()=>{if(!E)return;const e=f.map((e=>{const t=E.permission.find((t=>t.moduleId===e._id));return t&&(e.permission={add:null===t||void 0===t?void 0:t.add,view:null===t||void 0===t?void 0:t.view,modify:null===t||void 0===t?void 0:t.modify,delete:null===t||void 0===t?void 0:t.delete}),e}));g(e),v(e.filter((e=>{var t,s,i,d;return!((null===(t=e.permission)||void 0===t||!t.delete)&&(null===(s=e.permission)||void 0===s||!s.view)&&(null===(i=e.permission)||void 0===i||!i.modify)&&(null===(d=e.permission)||void 0===d||!d.add))})).map((e=>e._id))),console.log("Data copied successfully")},children:d("copy")})]})]}),(0,p.jsx)("div",{className:"ms-4 pt-0 mt-0",children:M&&(0,p.jsx)("span",{className:"text-danger text-sm pt-0 mt-0",style:{marginBottom:"1rem"},children:"feature template name is required"})}),(0,p.jsxs)(r.A.Body,{className:"d-flex",children:[(0,p.jsx)("div",{style:{flex:.4,maxHeight:"50vh",overflow:"auto",border:"1px solid #D3D3D3  ",borderRadius:"0.5rem"},children:(0,p.jsxs)(l.A,{children:[(0,p.jsx)("thead",{style:{position:"sticky",top:0,background:"white"},children:(0,p.jsx)("tr",{children:(0,p.jsx)("th",{scope:"col",children:d("module")})})}),(0,p.jsx)("tbody",{children:f.map(((e,t)=>e&&e.title?(0,p.jsx)(i.Fragment,{children:(0,p.jsx)("tr",{children:(0,p.jsxs)("td",{children:[(0,p.jsx)("input",{type:"checkbox",className:"form-check-input",style:{marginRight:"0.2rem"},name:"create",checked:x.includes(e._id),onChange:t=>((e,t)=>{v(e?e=>[...e,t]:e=>e.filter((e=>e!==t)))})(t.target.checked,e._id)}),(0,p.jsx)("span",{style:{marginRight:"1.7rem"},children:d(e.title)})]})})},e._id):null))})]})}),(0,p.jsx)("div",{style:{flex:1,maxHeight:"50vh",overflow:"auto",border:"1px solid #D3D3D3",borderRadius:"0.5rem",marginLeft:"0.2rem"},children:(0,p.jsxs)(l.A,{children:[(0,p.jsx)("thead",{id:"feature_template",style:{position:"sticky",top:0,background:"white"},children:(0,p.jsxs)("tr",{children:[(0,p.jsx)("th",{scope:"col",className:"col-4",style:{width:"150px"},children:d("subModules")}),(0,p.jsx)("th",{scope:"col",children:d("add")}),(0,p.jsx)("th",{scope:"col",children:d("view")}),(0,p.jsx)("th",{scope:"col",children:d("modify")}),(0,p.jsx)("th",{scope:"col",children:d("delete")})]})}),(0,p.jsx)("tbody",{className:"feature_template_table",children:x.length>0&&x.map(((e,t)=>{var s,d,n,a;const r=f.find((t=>t._id===e));return r?(r.subModules.length>0&&(I=!0),(0,p.jsxs)(i.Fragment,{children:[(0,p.jsxs)("tr",{children:[(0,p.jsxs)("td",{className:"col-2",style:{width:"130px"},children:[" ",r.title]}),(0,p.jsx)("td",{children:(0,p.jsx)("input",{type:"checkbox",checked:null===(s=r.permission)||void 0===s?void 0:s.add,onChange:t=>T(t.target.checked,t.target.name,e),className:"form-check-input",name:"add",disabled:I&&r.subModules.length>0})}),(0,p.jsx)("td",{children:(0,p.jsx)("input",{type:"checkbox",checked:null===(d=r.permission)||void 0===d?void 0:d.view,className:"form-check-input",onChange:t=>T(t.target.checked,t.target.name,e),name:"view"})}),(0,p.jsx)("td",{children:(0,p.jsx)("input",{type:"checkbox",checked:null===(n=r.permission)||void 0===n?void 0:n.modify,className:"form-check-input",onChange:t=>T(t.target.checked,t.target.name,e),disabled:I&&r.subModules.length>0,name:"modify"})}),(0,p.jsx)("td",{children:(0,p.jsx)("input",{type:"checkbox",checked:null===(a=r.permission)||void 0===a?void 0:a.delete,className:"form-check-input",onChange:t=>T(t.target.checked,t.target.name,e),disabled:I&&r.subModules.length>0,name:"delete"})})]}),r.subModules.map(((t,s)=>{var i,d,n,a;return(0,p.jsxs)("tr",{children:[(0,p.jsxs)("td",{className:"col-2",children:[" ",t.title]}),(0,p.jsx)("td",{children:(0,p.jsx)("input",{type:"checkbox",checked:null===(i=t.permission)||void 0===i?void 0:i.add,onChange:s=>C(s.target.checked,s.target.name,e,t.id),className:"form-check-input",name:"add"})}),(0,p.jsx)("td",{children:(0,p.jsx)("input",{type:"checkbox",checked:null===(d=t.permission)||void 0===d?void 0:d.view,onChange:s=>C(s.target.checked,s.target.name,e,t.id),className:"form-check-input",name:"view"})}),(0,p.jsx)("td",{children:(0,p.jsx)("input",{type:"checkbox",checked:null===(n=t.permission)||void 0===n?void 0:n.modify,onChange:s=>C(s.target.checked,s.target.name,e,t.id),className:"form-check-input",name:"modify"})}),(0,p.jsx)("td",{children:(0,p.jsx)("input",{type:"checkbox",checked:null===(a=t.permission)||void 0===a?void 0:a.delete,onChange:s=>C(s.target.checked,s.target.name,e,t.id),className:"form-check-input",name:"delete"})})]},s)}))]},t)):null}))})]})})]}),(0,p.jsx)("div",{className:"d-flex justify-content-end  p-3",children:(0,p.jsxs)("button",{className:"btn btn-primary",style:{marginLeft:"1rem",padding:"7px 16px"},onClick:async()=>{if(b.name){if(j){if(S.includes(b.name)&&b.name!==D)return void(0,h.U)("Feature Template name already exists")}else if(S.includes(b.name))return void(0,h.U)("Feature Template name already exists");try{_(!1);const e=f.reduce(((e,t)=>{var s,i,d,n;const a={moduleId:t._id,add:null===(s=t.permission)||void 0===s?void 0:s.add,view:null===(i=t.permission)||void 0===i?void 0:i.view,modify:null===(d=t.permission)||void 0===d?void 0:d.modify,delete:null===(n=t.permission)||void 0===n?void 0:n.delete};return e.push(a),t.subModules&&t.subModules.length>0&&t.subModules.forEach((t=>{var s,i,d,n;const a={moduleId:t.id,add:null===(s=t.permission)||void 0===s?void 0:s.add,view:null===(i=t.permission)||void 0===i?void 0:i.view,modify:null===(d=t.permission)||void 0===d?void 0:d.modify,delete:null===(n=t.permission)||void 0===n?void 0:n.delete};e.push(a)})),e}),[]),t={...b,permission:e};w((t=>({...t,permission:e})));const s=j?c.A.udpateTemplate:c.A.createTemplate;await s(t),v([]),console.log("Data saved successfully"),(0,h.V)("saved"),y("/groups")}catch(e){console.error("Error saving data:",e)}}else _(!0)},children:[" ",j?"Update":"Save"," "]})})]})})},v=()=>{const{t:e}=(0,u.Bd)(),t=(0,m.zy)(),{isEditTrue:s,setIsEditTrue:i}=JSON.parse(t.state);console.log(s,i);const r=[{title:"Permission",component:(0,p.jsx)(x,{isEditTrue:s,setIsEditTrue:i}),icon:(0,p.jsx)(a.x$1,{})}];return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(d.A,{mainTitle:e("permission"),pageTitle:e("permission"),parentTitle:e("Feature Templates")}),(0,p.jsx)(n.A,{tabs:r})]})}},35514:(e,t,s)=>{s.d(t,{A:()=>a,y:()=>n});var i=s(94505),d=s(77154);(0,i.A)();const n=async e=>{try{let t="/feature-template";void 0!==e&&(t+="?page=".concat(e,"&limit=",10));return(await d.A.get(t)).data}catch(t){return console.error("Error fetching templates:",t),{error:"Couldn't fetch User"}}},a={getTemplates:async e=>{try{return(await d.A.get("/feature-template",e)).data}catch(t){throw console.error("Error fetching modules:",t),t}},createTemplate:async e=>{try{return(await d.A.post("/feature-template",e)).data}catch(t){throw console.error("Error fetching modules:",t),t}},listModule:async e=>{try{return(await d.A.get("/modules",e)).data}catch(t){throw console.error("Error fetching modules:",t),t}},udpateTemplate:async e=>{try{return(await d.A.patch("/feature-template",e)).data}catch(t){throw console.error("Error fetching modules:",t),t}},deleteTemplate:async e=>{try{return(await d.A.delete("/feature-template/".concat(e))).data}catch(t){throw console.error("Error fetching modules:",t),t}}}}}]);
//# sourceMappingURL=7054.f5cb8351.chunk.js.map