"use strict";(self.webpackChunkFLEET=self.webpackChunkFLEET||[]).push([[2724],{99620:(e,a,s)=>{s.r(a),s.d(a,{default:()=>P});var t=s(65043),n=s(9866),l=s(53358),i=s(33723),c=s(44816),r=s(86856),o=(s(72213),s(50423)),d=s(47522),h=(s(19980),s(79904)),u=s.n(h),m=s(14282),p=s(70579);const x=e=>{const[a,s]=(0,t.useState)([]),[n,l]=(0,t.useState)([]),[i,c]=(0,t.useState)([]);(0,t.useEffect)((()=>{const a=null===e||void 0===e?void 0:e.companyVehicle.map((e=>{var a;const s=null===e||void 0===e||null===(a=e.vehicles)||void 0===a?void 0:a.map((e=>({label:null===e||void 0===e?void 0:e.vehicleName,value:null===e||void 0===e?void 0:e._id})));return{value:null===e||void 0===e?void 0:e._id,label:null===e||void 0===e?void 0:e.companyName,children:s}}));c([...a])}),[e.companyVehicle]),(0,t.useEffect)((()=>{let e=[];null===i||void 0===i||i.map((a=>{var s;return null===(s=a.children)||void 0===s?void 0:s.map((a=>e.push(a.value)))}));r(e)}),[i]);const r=a=>{s(a),e.setVehicleIds(a)};return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("div",{className:"checkboxTree",children:(0,p.jsx)(u(),{nodes:i,checked:a,expanded:n,onCheck:r,onExpand:e=>{l(e)},showNodeIcon:!1,icons:{expandOpen:(0,p.jsx)("i",{class:"fa-solid fa-minus"}),expandClose:(0,p.jsx)("i",{class:"fa-solid fa-plus"}),uncheck:(0,p.jsx)("i",{class:"fa-regular fa-square",style:{fontSize:"16px"}}),check:(0,p.jsx)("i",{class:"fa-solid fa-square-check",style:{fontSize:"16px"}}),halfCheck:(0,p.jsx)("i",{class:"fa-regular fa-square-minus",style:{fontSize:"16px"}})}})}),(0,p.jsx)("div",{className:"text-center  pt-2 ",children:(0,p.jsx)(m.A,{className:" mb-5",variant:"primary btn-md ",type:"submit",onClick:()=>{e.getVehiclesByIds(),e.handleToggleCardPositionHandler()},children:"Save Selection"})})]})};var v=s(272);const g=e=>{let{geoFences:a,handleToggleCardPositionHandler:s}=e;const[n,l]=(0,t.useState)([]),[i,c]=(0,t.useState)([]),[r,o]=(0,t.useState)([]);(0,t.useEffect)((()=>{const e=Object.entries(a).map((e=>{let[a,s]=e;return{value:a,label:a,children:s.map((e=>({label:e.name,value:e.id})))}}));o(e)}),[a]);return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("div",{className:"checkboxTree",children:(0,p.jsx)(u(),{nodes:r,checked:n,expanded:i,onCheck:e=>{l(e)},onExpand:e=>{c(e)},showNodeIcon:!1,icons:{expandOpen:(0,p.jsx)("i",{className:"fa-solid fa-minus"}),expandClose:(0,p.jsx)("i",{className:"fa-solid fa-plus"}),uncheck:(0,p.jsx)("i",{className:"fa-regular fa-square",style:{fontSize:"16px"}}),check:(0,p.jsx)("i",{className:"fa-solid fa-square-check",style:{fontSize:"16px"}}),halfCheck:(0,p.jsx)("i",{className:"fa-regular fa-square-minus",style:{fontSize:"16px"}})}})}),(0,p.jsx)("div",{className:"text-center  pt-2 ",children:(0,p.jsx)(m.A,{className:" mb-5",variant:"primary btn-md ",type:"submit",onClick:()=>{const e=n.map((e=>JSON.parse(e)));console.log(e),s()},children:"Save Selection"})})]})},f=e=>{const[a,s]=(0,t.useState)([]),[n,l]=(0,t.useState)([]),[i,c]=(0,t.useState)([]);console.log(e.drivers,"props.drivers"),(0,t.useEffect)((()=>{const a=Object.entries(e.drivers).map((e=>{const a=e[1].map((e=>({label:e.firstName,value:e.id})));return{value:e[0],label:e[0],children:a}}));c([...a])}),[e.drivers]);return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("div",{className:"checkboxTree",children:(0,p.jsx)(u(),{nodes:i,checked:a,expanded:n,onCheck:e=>{s(e)},onExpand:e=>{l(e)},showNodeIcon:!1,icons:{expandOpen:(0,p.jsx)("i",{class:"fa-solid fa-minus"}),expandClose:(0,p.jsx)("i",{class:"fa-solid fa-plus"}),uncheck:(0,p.jsx)("i",{class:"fa-regular fa-square",style:{fontSize:"16px"}}),check:(0,p.jsx)("i",{class:"fa-solid fa-square-check",style:{fontSize:"16px"}}),halfCheck:(0,p.jsx)("i",{class:"fa-regular fa-square-minus",style:{fontSize:"16px"}})}})}),(0,p.jsx)("div",{className:"text-center  pt-2 ",children:(0,p.jsx)(m.A,{className:" mb-5",variant:"primary btn-md ",type:"submit",onClick:()=>{const s=a.map((e=>JSON.parse(e)));console.log(s,"selctedObject"),e.handleToggleCardPositionHandler()},children:"Save Selection"})})]})};var j=s(42457),S=s(78247);const N=e=>{const{setVehicleStatus:a}=e,s=(0,v.r_)(),{Running:n,Idle:l,Stopped:i,Inactive:c,nodata:r,total:o}=s,[h,u]=(0,t.useState)("All"),[m,g]=(0,t.useState)([]),[f,N]=(0,t.useState)([]);(0,t.useEffect)((()=>{(async()=>{try{var e;const a=await(0,S.oq)();return void await N(null!==(e=null===a||void 0===a?void 0:a.data)&&void 0!==e?e:[])}catch(a){(0,j.U)("Some Error occured")}})()}),[h]);const k=JSON.parse(localStorage.getItem("userJsonData")).filter((e=>"vehicle"===e.designation)).map((e=>({id:e.id,name:e.vehicleName})));return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("div",{className:"vehicle_tracking-object",children:[(0,p.jsxs)("span",{className:"light fs-9 running ".concat("Running"===h&&"vehicle_tracking-active"),onClick:()=>{u("Running"),a("RUNNING")},children:[(0,p.jsx)("p",{children:n}),(0,p.jsx)("span",{children:"Running"})]}),(0,p.jsxs)("span",{pill:!0,className:"light fs-9 idle ".concat("Idle"===h&&"vehicle_tracking-active"),onClick:()=>{u("Idle"),a("Idle")},children:[(0,p.jsx)("p",{children:l}),(0,p.jsx)("span",{children:"Idle"})]}),(0,p.jsxs)("span",{pill:!0,className:"light stopped fs-9 ".concat("Stopped"===h&&"vehicle_tracking-active"),onClick:()=>{u("Stopped"),a("STOP")},children:[(0,p.jsx)("p",{children:i}),(0,p.jsx)("span",{children:"Stopped"})]}),(0,p.jsxs)("span",{pill:!0,className:"light fs-9 inActive ".concat("Inactive"===h&&"vehicle_tracking-active"),onClick:()=>{u("Inactive"),a("Inactive")},children:[(0,p.jsx)("p",{children:c}),(0,p.jsx)("span",{children:"InActive"})]}),(0,p.jsxs)("span",{pill:!0,className:"light fs-9 noData ".concat("NoData"===h&&"vehicle_tracking-active"),onClick:()=>{u("NoData"),a("NoData")},children:[(0,p.jsx)("p",{children:r}),(0,p.jsx)("span",{children:"NoData"})]}),(0,p.jsxs)("span",{className:"light fs-9 total ".concat("All"===h&&"vehicle_tracking-active"),onClick:()=>{u("All"),a("")},children:[(0,p.jsx)("p",{children:o}),(0,p.jsx)("span",{children:"Total"})]})]}),(0,p.jsx)("div",{className:"d-flex mt-4 mb-4",children:(0,p.jsx)(d.ReactSearchAutocomplete,{items:k,className:"w-100",styling:{height:"30px",marginRight:"10px",fontSize:"12px",color:"#4A4646"},onSearch:e=>{if(""===e){const e=(0,v.kw)(h);g(e)}},onSelect:e=>{const a=(0,v.kw)(h),s=Object.entries(a).filter((a=>a[1].filter((a=>a.id==e.id)).length>0)).reduce(((a,s)=>{let[t,n]=s;return n.map((s=>{s.vehicleName===e.name&&(a[t]=[s])})),a}),{});g(s)}})}),(0,p.jsx)(x,{companyVehicle:null!==f&&void 0!==f?f:[],setVehicleIds:e.setVehicleIds,vehicles:m,getVehiclesByIds:e.getVehiclesByIds,handleToggleCardPositionHandler:e.handleToggleCardPosition})]})},k=e=>{const[a,s]=(0,t.useState)("All"),[n,l]=(0,t.useState)([]),[i,c]=(0,t.useState)([]),[r,o]=(0,t.useState)([]),[h,u]=(0,t.useState)(!1),[m,x]=(0,t.useState)(!1),v=JSON.parse(localStorage.getItem("userJsonData")),[g,j]=(0,t.useState)([]),[S,N]=(0,t.useState)(v.filter((e=>"company"===e.role))),[k,y]=(0,t.useState)(v.filter((e=>"Driver"===e.designation))),C=k.filter((e=>"Allocated"===e.activityStatus)),b=k.filter((e=>"Not Allocated"===e.activityStatus));(0,t.useEffect)((()=>{const e=S.reduce(((e,a)=>{const s=v.filter((e=>"Driver"===e.designation&&e.parentCompany===a.userName));return s.length>0&&(e[a.userName]=s),e}),{});j(e)}),[S]),(0,t.useEffect)((()=>{const e=S.reduce(((e,s)=>{const t=v.filter((e=>"Driver"===e.designation&&e.parentCompany===s.userName&&("All"==a||e.activityStatus===a)));return t.length>0&&(e[s.userName]=t),e}),{});j(e)}),[a]);const I=k.length,A=v.filter((e=>"Driver"===e.designation)).map((e=>({id:e.id,name:e.firstName+" "+e.lastName})));return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("div",{className:"px-2 vehicle_tracking-object",children:[(0,p.jsxs)("span",{bg:"",pill:!0,className:"light fs-9  running ".concat("Allocated"===a?"vehicle_tracking-active":m&&"pe-none"),onClick:()=>s("Allocated"),children:[(0,p.jsx)("p",{children:C.length}),(0,p.jsx)("span",{children:"Allocated"})]}),(0,p.jsxs)("span",{bg:"",pill:!0,className:"light fs-9 idle ".concat("Not Allocated"===a?"vehicle_tracking-active":m&&"pe-none"),onClick:()=>s("Not Allocated"),children:[(0,p.jsx)("p",{children:b.length}),(0,p.jsx)("span",{children:"Not Allocated"})]}),(0,p.jsxs)("span",{bg:"",pill:!0,className:"light fs-9 total ".concat("Total"===a?"vehicle_tracking-active":m&&"pe-none"),onClick:()=>s("All"),children:[(0,p.jsx)("p",{children:I}),(0,p.jsx)("span",{children:"Total"})]})]}),(0,p.jsx)("div",{className:"d-flex mt-4 mb-4",children:(0,p.jsx)(d.ReactSearchAutocomplete,{items:A,className:"w-100",styling:{height:"30px",marginRight:"10px",fontSize:"12px",color:"#red"},onSearch:(e,a)=>{if(""===e){const e=S.reduce(((e,a)=>{const s=v.filter((e=>"Driver"===e.designation&&e.parentCompany===a.userName));return s.length>0&&(e[a.userName]=s),e}),{});j(e)}},onSelect:e=>{const a=e.id,s=S.reduce(((e,s)=>{const t=v.filter((e=>"Driver"===e.designation&&e.parentCompany===s.userName&&e.id===a));return t.length>0&&(e[s.userName]=t),e}),{});j(s)}})}),(0,p.jsx)(f,{drivers:g,handleToggleCardPositionHandler:e.handleToggleCardPosition},g)]})},y=e=>{const a=JSON.parse(localStorage.getItem("geofenceData")),[s,n]=(0,t.useState)(a),[l,i]=(0,t.useState)([]),[c,r]=(0,t.useState)(""),o=(s.filter((e=>e.company.toLowerCase().includes(c.toLowerCase()))),s.reduce(((e,a)=>(e[a.company]||(e[a.company]=[]),e[a.company].push(a),e)),{})),h=s.map((e=>({id:e.id,name:e.name})));return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("div",{className:"d-flex mt-4 mb-4",children:(0,p.jsx)(d.ReactSearchAutocomplete,{items:h,className:"w-100",styling:{height:"30px",marginRight:"10px",fontSize:"12px",color:"#red"},onSelect:e=>{const s=a.filter((a=>a.id===e.id));n(s)}})}),(0,p.jsx)("div",{className:"d-flex flex-column p-2",style:{marginTop:".5rem",overflowY:"scroll"},children:(0,p.jsx)(g,{geoFences:o,handleToggleCardPositionHandler:e.handleToggleCardPosition})})]})},C=e=>{let{tabData:a,handleToggleCardPosition:s,isOutside:t,setVehicleIds:n,getVehiclesByIds:l,setVehicleStatus:i}=e;const d={name:"Company1",drivers:[{name:"driver1",timeStamp:"22-02-2024 3:00 PM",status:"running"},{name:"driver2",timeStamp:"22-02-2024 3:00 PM",status:"idle"},{name:"driver3",timeStamp:"22-02-2024 3:00 PM",status:"inactive"},{name:"driver4",timeStamp:"22-02-2024 3:00 PM",status:"running"},{name:"driver5",timeStamp:"22-02-2024 3:00 PM",status:"stopped"},{name:"driver6",timeStamp:"22-02-2024 3:00 PM",status:"stopped"},{name:"driver7",timeStamp:"22-02-2024 3:00 PM"}],allocatedDriver:4,notAllocatedDriver:3,totalDriver:7},h=[N,k,y];return(0,p.jsx)(p.Fragment,{children:(0,p.jsxs)("div",{className:"default-tab outer-container ".concat(t?"toggleBarInside":"toggleBarOutside"),children:[(0,p.jsx)("button",{onClick:s,className:"driver_tracking_button",children:t?(0,p.jsx)(o.m6W,{}):(0,p.jsx)(o.OQo,{})}),(0,p.jsxs)(c.A.Container,{defaultActiveKey:a[0].name.toLowerCase(),children:[(0,p.jsx)(r.A,{as:"ul",className:"nav-tabs tracking_navTabs",children:a.map(((e,a)=>{const s=e.icon;return(0,p.jsx)(r.A.Item,{as:"li",children:(0,p.jsxs)(r.A.Link,{eventKey:e.name.toLowerCase(),children:[(0,p.jsx)(s,{className:"tab-icon"}),e.name]})},a)}))}),(0,p.jsx)(c.A.Content,{className:"p-2 py-4",style:{background:"#f5f5f5",overflow:"scroll",height:"100vh"},children:a.map(((e,a)=>{const t=h[a];return(0,p.jsx)(c.A.Pane,{eventKey:e.name.toLowerCase(),children:(0,p.jsx)(t,{data:d,handleToggleCardPosition:s,setVehicleIds:n,getVehiclesByIds:l,setVehicleStatus:i})},a)}))})]})]})})};var b=s(60397),I=s(60184),A=s(6720),T=s(74117);const P=()=>{const{t:e}=(0,T.Bd)(),{currentPosition:a,setCurrentPosition:s}=(0,t.useContext)(i.D),[c,r]=(0,t.useState)(!0),o=[{name:"Object",icon:b.ETQ},{name:"Driver",icon:I.x$1},{name:"Geofence",icon:A.vVi}],[d,h]=(0,t.useState)([]),[u,m]=(0,t.useState)(""),[x,v]=(0,t.useState)([]),g=async e=>{try{const a=await(0,S.Up)(null!==e&&void 0!==e?e:"",u);return void v(null!==a&&void 0!==a?a:[])}catch(a){(0,j.U)("Some Error occured")}},f=()=>{const e=d.map((e=>"id=".concat(e,"&"))).join("");g(e)};return(0,t.useEffect)((()=>{let e;return d.length&&(f(),e=setInterval((()=>{g()}),12e4)),()=>{clearInterval(e)}}),[d]),(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(n.A,{mainTitle:e("vehicleTracking"),pageTitle:e("vehicleTracking"),parentTitle:e("tracking")}),(0,p.jsx)("div",{className:"backdrop ".concat(c?"d-none":"d-block"),onClick:()=>r(!0)}),(0,p.jsx)("div",{className:"p-2",children:(0,p.jsx)(l.A,{data:[{lat:30.7099475,lng:76.6900474},{lat:30.7333,lng:76.7794}],trackingData:x})}),(0,p.jsx)(C,{tabData:o,setVehicleIds:h,getVehiclesByIds:f,vehicleIds:d,setVehicleStatus:m,handleToggleCardPosition:()=>{r(!c)},isOutside:c})]})}}}]);
//# sourceMappingURL=2724.58f4b9c1.chunk.js.map