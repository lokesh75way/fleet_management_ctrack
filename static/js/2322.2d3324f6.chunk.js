"use strict";(self.webpackChunkFLEET=self.webpackChunkFLEET||[]).push([[2322],{2322:(e,a,s)=>{s.r(a),s.d(a,{default:()=>D});var t=s(78109),n=s(14578),l=s(15850),i=s(35651),c=s(36145),r=s(93576),o=(s(6040),s(87388)),d=s(36379),u=(s(94713),s(93452)),h=s.n(u),m=s(85389),p=s(47337);const v=e=>{const[a,s]=(0,t.useState)([]),[n,l]=(0,t.useState)([]),[i,c]=(0,t.useState)([]);(0,t.useEffect)((()=>{const a=null===e||void 0===e?void 0:e.companyVehicle.map((e=>{var a;const s=null===e||void 0===e||null===(a=e.vehicles)||void 0===a?void 0:a.map((e=>({label:null===e||void 0===e?void 0:e.vehicleName,value:null===e||void 0===e?void 0:e._id})));return{value:null===e||void 0===e?void 0:e._id,label:null===e||void 0===e?void 0:e.companyName,children:s}}));c([...a])}),[e.companyVehicle]),(0,t.useEffect)((()=>{let e=[];null===i||void 0===i||i.map((a=>{var s;return null===(s=a.children)||void 0===s?void 0:s.map((a=>e.push(a.value)))}));r(e)}),[i]);const r=a=>{s(a),e.setVehicleIds(a)};return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("div",{className:"checkboxTree",children:(0,p.jsx)(h(),{nodes:i,checked:a,expanded:n,onCheck:r,onExpand:e=>{l(e)},showNodeIcon:!1,icons:{expandOpen:(0,p.jsx)("i",{class:"fa-solid fa-minus"}),expandClose:(0,p.jsx)("i",{class:"fa-solid fa-plus"}),uncheck:(0,p.jsx)("i",{class:"fa-regular fa-square",style:{fontSize:"16px"}}),check:(0,p.jsx)("i",{class:"fa-solid fa-square-check",style:{fontSize:"16px"}}),halfCheck:(0,p.jsx)("i",{class:"fa-regular fa-square-minus",style:{fontSize:"16px"}})}})}),(0,p.jsx)("div",{className:"text-center  pt-2 ",children:(0,p.jsx)(m.A,{className:" mb-5",variant:"primary btn-md ",type:"submit",onClick:()=>{e.getVehiclesByIds(),e.handleToggleCardPositionHandler()},children:"Save Selection"})})]})};var g=s(96152);const x=e=>{let{geoFences:a,handleToggleCardPositionHandler:s}=e;const[n,l]=(0,t.useState)([]),[i,c]=(0,t.useState)([]),[r,o]=(0,t.useState)([]);(0,t.useEffect)((()=>{const e=Object.entries(a).map((e=>{let[a,s]=e;return{value:a,label:a,children:s.map((e=>({label:e.name,value:e.id})))}}));o(e)}),[a]);return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("div",{className:"checkboxTree",children:(0,p.jsx)(h(),{nodes:r,checked:n,expanded:i,onCheck:e=>{l(e)},onExpand:e=>{c(e)},showNodeIcon:!1,icons:{expandOpen:(0,p.jsx)("i",{className:"fa-solid fa-minus"}),expandClose:(0,p.jsx)("i",{className:"fa-solid fa-plus"}),uncheck:(0,p.jsx)("i",{className:"fa-regular fa-square",style:{fontSize:"16px"}}),check:(0,p.jsx)("i",{className:"fa-solid fa-square-check",style:{fontSize:"16px"}}),halfCheck:(0,p.jsx)("i",{className:"fa-regular fa-square-minus",style:{fontSize:"16px"}})}})}),(0,p.jsx)("div",{className:"text-center  pt-2 ",children:(0,p.jsx)(m.A,{className:" mb-5",variant:"primary btn-md ",type:"submit",onClick:()=>{n.map((e=>JSON.parse(e)));s()},children:"Save Selection"})})]})},f=e=>{const[a,s]=(0,t.useState)([]),[n,l]=(0,t.useState)([]),[i,c]=(0,t.useState)([]);(0,t.useEffect)((()=>{const a=Object.entries(e.drivers).map((e=>{const a=e[1].map((e=>({label:e.firstName,value:e.id})));return{value:e[0],label:e[0],children:a}}));c([...a])}),[e.drivers]);return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("div",{className:"checkboxTree",children:(0,p.jsx)(h(),{nodes:i,checked:a,expanded:n,onCheck:e=>{s(e)},onExpand:e=>{l(e)},showNodeIcon:!1,icons:{expandOpen:(0,p.jsx)("i",{class:"fa-solid fa-minus"}),expandClose:(0,p.jsx)("i",{class:"fa-solid fa-plus"}),uncheck:(0,p.jsx)("i",{class:"fa-regular fa-square",style:{fontSize:"16px"}}),check:(0,p.jsx)("i",{class:"fa-solid fa-square-check",style:{fontSize:"16px"}}),halfCheck:(0,p.jsx)("i",{class:"fa-regular fa-square-minus",style:{fontSize:"16px"}})}})}),(0,p.jsx)("div",{className:"text-center  pt-2 ",children:(0,p.jsx)(m.A,{className:" mb-5",variant:"primary btn-md ",type:"submit",onClick:()=>{const s=a.map((e=>JSON.parse(e)));console.log(s,"selctedObject"),e.handleToggleCardPositionHandler()},children:"Save Selection"})})]})};var j=s(70529),S=s(55759);const N=e=>{var a,s;const{setVehicleStatus:n,vehicleCounts:l}=e,{running:i,idle:c,stopped:r,inactive:o,nodata:u,total:h}=l,[m,x]=(0,t.useState)("All"),[f,N]=(0,t.useState)([]),[k,C]=(0,t.useState)([]);(0,t.useEffect)((()=>{(async e=>{try{var a;const s=await(0,S.oq)(e);return void await C(null!==(a=null===s||void 0===s?void 0:s.data)&&void 0!==a?a:[])}catch(s){(0,j.U)("Some Error occured")}})()}),[m]);const y=JSON.parse(null===(a=localStorage)||void 0===a?void 0:a.getItem("userJsonData"))?JSON.parse(null===(s=localStorage)||void 0===s?void 0:s.getItem("userJsonData")).filter((e=>"vehicle"===e.designation)).map((e=>({id:e.id,name:e.vehicleName}))):[];return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("div",{className:"vehicle_tracking-object",children:[(0,p.jsxs)("span",{className:`light fs-9 running ${"Running"===m&&"vehicle_tracking-active"}`,onClick:()=>{x("Running"),n("RUNNING")},children:[(0,p.jsx)("p",{children:i}),(0,p.jsx)("span",{children:"Running"})]}),(0,p.jsxs)("span",{pill:!0,className:`light fs-9 idle ${"Idle"===m&&"vehicle_tracking-active"}`,onClick:()=>{x("Idle"),n("IDLE")},children:[(0,p.jsx)("p",{children:c}),(0,p.jsx)("span",{children:"Idle"})]}),(0,p.jsxs)("span",{pill:!0,className:`light stopped fs-9 ${"Stopped"===m&&"vehicle_tracking-active"}`,onClick:()=>{x("Stopped"),n("STOP")},children:[(0,p.jsx)("p",{children:r}),(0,p.jsx)("span",{children:"Stopped"})]}),(0,p.jsxs)("span",{pill:!0,className:`light fs-9 inActive ${"Inactive"===m&&"vehicle_tracking-active"}`,onClick:()=>{x("Inactive"),n("INACTIVE")},children:[(0,p.jsx)("p",{children:o}),(0,p.jsx)("span",{children:"InActive"})]}),(0,p.jsxs)("span",{pill:!0,className:`light fs-9 noData ${"NoData"===m&&"vehicle_tracking-active"}`,onClick:()=>{x("NoData"),n("NODATA")},children:[(0,p.jsx)("p",{children:u}),(0,p.jsx)("span",{children:"NoData"})]}),(0,p.jsxs)("span",{className:`light fs-9 total ${"All"===m&&"vehicle_tracking-active"}`,onClick:()=>{x("All"),n("")},children:[(0,p.jsx)("p",{children:h}),(0,p.jsx)("span",{children:"Total"})]})]}),(0,p.jsx)("div",{className:"d-flex mt-4 mb-4",children:(0,p.jsx)(d.ReactSearchAutocomplete,{items:y,className:"w-100",styling:{height:"30px",marginRight:"10px",fontSize:"12px",color:"#4A4646"},onSearch:e=>{if(""===e){const e=(0,g.kw)(m);N(e)}},onSelect:e=>{const a=(0,g.kw)(m),s=Object.entries(a).filter((a=>a[1].filter((a=>a.id==e.id)).length>0)).reduce(((a,s)=>{let[t,n]=s;return n.map((s=>{s.vehicleName===e.name&&(a[t]=[s])})),a}),{});N(s)}})}),(0,p.jsx)(v,{companyVehicle:null!==k&&void 0!==k?k:[],setVehicleIds:e.setVehicleIds,vehicles:f,getVehiclesByIds:e.getVehiclesByIds,handleToggleCardPositionHandler:e.handleToggleCardPosition})]})},k=e=>{const[a,s]=(0,t.useState)("All"),[n,l]=(0,t.useState)([]),[i,c]=(0,t.useState)([]),[r,o]=(0,t.useState)([]),[u,h]=(0,t.useState)(!1),[m,v]=(0,t.useState)(!1),g=JSON.parse(localStorage.getItem("userJsonData"))?JSON.parse(localStorage.getItem("userJsonData")):[],[x,j]=(0,t.useState)([]),[S,N]=(0,t.useState)(g.filter((e=>"company"===e.role))),[k,C]=(0,t.useState)(g.filter((e=>"Driver"===e.designation))),y=k.filter((e=>"Allocated"===e.activityStatus)),b=k.filter((e=>"Not Allocated"===e.activityStatus));(0,t.useEffect)((()=>{const e=S.reduce(((e,a)=>{const s=g.filter((e=>"Driver"===e.designation&&e.parentCompany===a.userName));return s.length>0&&(e[a.userName]=s),e}),{});j(e)}),[S]),(0,t.useEffect)((()=>{const e=S.reduce(((e,s)=>{const t=g.filter((e=>"Driver"===e.designation&&e.parentCompany===s.userName&&("All"==a||e.activityStatus===a)));return t.length>0&&(e[s.userName]=t),e}),{});j(e)}),[a]);const A=k.length,I=g.filter((e=>"Driver"===e.designation)).map((e=>({id:e.id,name:e.firstName+" "+e.lastName})));return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("div",{className:"px-2 vehicle_tracking-object",children:[(0,p.jsxs)("span",{bg:"",pill:!0,className:`light fs-9  running ${"Allocated"===a?"vehicle_tracking-active":m&&"pe-none"}`,onClick:()=>s("Allocated"),children:[(0,p.jsx)("p",{children:y.length}),(0,p.jsx)("span",{children:"Allocated"})]}),(0,p.jsxs)("span",{bg:"",pill:!0,className:`light fs-9 idle ${"Not Allocated"===a?"vehicle_tracking-active":m&&"pe-none"}`,onClick:()=>s("Not Allocated"),children:[(0,p.jsx)("p",{children:b.length}),(0,p.jsx)("span",{children:"Not Allocated"})]}),(0,p.jsxs)("span",{bg:"",pill:!0,className:`light fs-9 total ${"Total"===a?"vehicle_tracking-active":m&&"pe-none"}`,onClick:()=>s("All"),children:[(0,p.jsx)("p",{children:A}),(0,p.jsx)("span",{children:"Total"})]})]}),(0,p.jsx)("div",{className:"d-flex mt-4 mb-4",children:(0,p.jsx)(d.ReactSearchAutocomplete,{items:I,className:"w-100",styling:{height:"30px",marginRight:"10px",fontSize:"12px",color:"#red"},onSearch:(e,a)=>{if(""===e){const e=S.reduce(((e,a)=>{const s=g.filter((e=>"Driver"===e.designation&&e.parentCompany===a.userName));return s.length>0&&(e[a.userName]=s),e}),{});j(e)}},onSelect:e=>{const a=e.id,s=S.reduce(((e,s)=>{const t=g.filter((e=>"Driver"===e.designation&&e.parentCompany===s.userName&&e.id===a));return t.length>0&&(e[s.userName]=t),e}),{});j(s)}})}),(0,p.jsx)(f,{drivers:x,handleToggleCardPositionHandler:e.handleToggleCardPosition},x)]})},C=e=>{const a=JSON.parse(localStorage.getItem("geofenceData"))?JSON.parse(localStorage.getItem("geofenceData")):[],[s,n]=(0,t.useState)(a),[l,i]=(0,t.useState)([]),[c,r]=(0,t.useState)(""),o=(s.filter((e=>e.company.toLowerCase().includes(c.toLowerCase()))),s.reduce(((e,a)=>(e[a.company]||(e[a.company]=[]),e[a.company].push(a),e)),{})),u=s.map((e=>({id:e.id,name:e.name})));return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("div",{className:"d-flex mt-4 mb-4",children:(0,p.jsx)(d.ReactSearchAutocomplete,{items:u,className:"w-100",styling:{height:"30px",marginRight:"10px",fontSize:"12px",color:"#red"},onSelect:e=>{const s=a.filter((a=>a.id===e.id));n(s)}})}),(0,p.jsx)("div",{className:"d-flex flex-column p-2",style:{marginTop:".5rem",overflowY:"scroll"},children:(0,p.jsx)(x,{geoFences:o,handleToggleCardPositionHandler:e.handleToggleCardPosition})})]})},y=e=>{let{tabData:a,handleToggleCardPosition:s,isOutside:t,setVehicleIds:n,getVehiclesByIds:l,setVehicleStatus:i,vehicleCounts:d}=e;const u={name:"Company1",drivers:[{name:"driver1",timeStamp:"22-02-2024 3:00 PM",status:"running"},{name:"driver2",timeStamp:"22-02-2024 3:00 PM",status:"idle"},{name:"driver3",timeStamp:"22-02-2024 3:00 PM",status:"inactive"},{name:"driver4",timeStamp:"22-02-2024 3:00 PM",status:"running"},{name:"driver5",timeStamp:"22-02-2024 3:00 PM",status:"stopped"},{name:"driver6",timeStamp:"22-02-2024 3:00 PM",status:"stopped"},{name:"driver7",timeStamp:"22-02-2024 3:00 PM"}],allocatedDriver:4,notAllocatedDriver:3,totalDriver:7},h=[N,k,C];return(0,p.jsx)(p.Fragment,{children:(0,p.jsxs)("div",{className:"default-tab outer-container "+(t?"toggleBarInside":"toggleBarOutside"),children:[(0,p.jsx)("button",{onClick:s,className:"driver_tracking_button",children:t?(0,p.jsx)(o.m6W,{}):(0,p.jsx)(o.OQo,{})}),(0,p.jsxs)(c.A.Container,{defaultActiveKey:a[0].name.toLowerCase(),children:[(0,p.jsx)(r.A,{as:"ul",className:"nav-tabs tracking_navTabs",children:a.map(((e,a)=>{const s=e.icon;return(0,p.jsx)(r.A.Item,{as:"li",children:(0,p.jsxs)(r.A.Link,{eventKey:e.name.toLowerCase(),children:[(0,p.jsx)(s,{className:"tab-icon"}),e.name]})},a)}))}),(0,p.jsx)(c.A.Content,{className:"p-2 py-4",style:{background:"#f5f5f5",overflow:"scroll",height:"100vh"},children:a.map(((e,a)=>{const t=h[a];return(0,p.jsx)(c.A.Pane,{eventKey:e.name.toLowerCase(),children:(0,p.jsx)(t,{data:u,handleToggleCardPosition:s,setVehicleIds:n,getVehiclesByIds:l,setVehicleStatus:i,vehicleCounts:d})},a)}))})]})]})})};var b=s(17558),A=s(25255),I=s(27515),T=s(34571);const D=()=>{const{t:e}=(0,T.Bd)(),{currentPosition:a,setCurrentPosition:s}=(0,t.useContext)(i.D),[c,r]=(0,t.useState)(!0),o=[{name:"Object",icon:b.ETQ},{name:"Driver",icon:A.x$1},{name:"Geofence",icon:I.vVi}],[d,u]=(0,t.useState)([]),[h,m]=(0,t.useState)(""),[v,g]=(0,t.useState)([]),[x,f]=(0,t.useState)({}),[N,k]=(0,t.useState)({}),C=()=>{(async e=>{try{var a,s,t;const n=await(0,S.Up)(null!==e&&void 0!==e?e:"",h);return g(null!==(a=null===n||void 0===n?void 0:n.data)&&void 0!==a?a:[]),f(null===n||void 0===n||null===(s=n.data)||void 0===s?void 0:s.count),void k(null===n||void 0===n||null===(t=n.data)||void 0===t?void 0:t.centerCoordinate)}catch(n){(0,j.U)("Some Error occured")}})(d.map((e=>`id=${e}&`)).join(""))};return(0,t.useEffect)((()=>{let e;return d.length&&(C(),e=setInterval((()=>{C()}),12e4)),()=>{clearInterval(e)}}),[d]),(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(n.A,{mainTitle:e("vehicleTracking"),pageTitle:e("vehicleTracking"),parentTitle:e("tracking")}),(0,p.jsx)("div",{className:"backdrop "+(c?"d-none":"d-block"),onClick:()=>r(!0)}),(0,p.jsx)("div",{className:"p-2",children:(0,p.jsx)(l.A,{data:[{lat:30.7099475,lng:76.6900474},{lat:30.7333,lng:76.7794}],trackingData:v,centerCoordinate:N})}),(0,p.jsx)(y,{tabData:o,setVehicleIds:u,getVehiclesByIds:C,vehicleIds:d,setVehicleStatus:m,vehicleCounts:x,handleToggleCardPosition:()=>{r(!c)},isOutside:c})]})}}}]);
//# sourceMappingURL=2322.2d3324f6.chunk.js.map