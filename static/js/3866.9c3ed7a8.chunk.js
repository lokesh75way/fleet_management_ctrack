"use strict";(self.webpackChunkFLEET=self.webpackChunkFLEET||[]).push([[3866],{13866:(e,a,s)=>{s.r(a),s.d(a,{default:()=>R});var t=s(78109),l=s(78292),r=s(32343),n=s(27515),i=s(25255),c=s(32449),o=s(47337);const d=e=>{let{tableData:a,onConfirmDelete:s,editDrawerOpen:t,currentPage:l,itemsPerPage:r}=e;const d=(l-1)*r+1;return(0,o.jsx)(o.Fragment,{children:a.map(((e,a)=>{var l,r,m,x;return(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{children:(0,o.jsx)("span",{children:d+a})}),(0,o.jsx)("td",{children:(0,o.jsx)("div",{className:"products",children:(0,o.jsx)("div",{children:(0,o.jsx)("h6",{children:e.taskName})})})}),(0,o.jsx)("td",{children:(0,o.jsx)("span",{children:e.taskCategory})}),(0,o.jsx)("td",{children:(0,o.jsx)("span",{children:`${null!==(l=null===(r=e.technician)||void 0===r?void 0:r.firstName)&&void 0!==l?l:""} ${null!==(m=null===(x=e.technician)||void 0===x?void 0:x.lastName)&&void 0!==m?m:""}`})}),(0,o.jsx)("td",{children:(0,o.jsx)("span",{children:e.serviceLocation})}),(0,o.jsx)("td",{children:(0,o.jsx)("span",{className:"text-primary",children:e.reportingTime})}),(0,o.jsx)("td",{children:(0,o.jsxs)("span",{className:"d-flex justify-content-center",children:[(0,o.jsx)("span",{className:"cursor-pointer",onClick:()=>t(null===e||void 0===e?void 0:e._id),children:(0,o.jsx)(i.uO9,{style:{color:"green",fontSize:"1.2rem"}})}),(0,o.jsx)(c.A,{className:"cursor-pointer ",onConfirmDelete:s,id:e._id,children:(0,o.jsx)(n.b6i,{style:{color:"red",fontSize:"1.2rem"}})})]})})]},a)}))})};var m=s(85129),x=s(75889),h=s.n(x),u=(s(1682),s(86554)),j=s(74563),p=s(75542),g=s(91197),b=(s(7804),s(20460)),f=s(34571),v=s(97804),N=s(44231);const y=e=>{let{onChange:a,value:s,groupId:l,customStyles:r,name:n,ref:i,isDisabled:c}=e;const[d,m]=(0,t.useState)([]),[x,h]=(0,t.useState)(s),{page:u}=(0,v.A)();return(0,t.useEffect)((()=>{(async()=>{const{technicians:e}=await(0,N.KZ)(u),a=e.map((e=>{var a,s;return{value:null===e||void 0===e?void 0:e._id,label:`${null!==(a=null===e||void 0===e?void 0:e.firstName)&&void 0!==a?a:""} ${null!==(s=null===e||void 0===e?void 0:e.lastName)&&void 0!==s?s:""}`}}));m(a)})()}),[]),(0,t.useEffect)((()=>{const e=d.find((e=>e.value===s));h(e)}),[s,d,l]),(0,o.jsx)(j.Ay,{options:d,value:x,onChange:e=>a(e),styles:r,name:n,ref:i,isDisabled:c})},k=(0,t.forwardRef)(((e,a)=>{let{Title:s,handleSubmit:r,editData:n,setEditData:i,control:c,setValue:d,getValues:x,register:v,errors:N,clearErrors:k,onSubmit:C,reset:D}=e;const[T,w]=(0,t.useState)(!1);(0,t.useImperativeHandle)(a,(()=>({showModal(){w(!0)},closeModal(){D(),k(),w(!1)}})));const{t:P}=(0,f.Bd)(),S={control:e=>({...e,padding:".25rem 0 "})};return(0,t.useEffect)((()=>{D({}),k(),T&&n?(D({...n,technician:n.technician._id}),d("description",n.description)):i()}),[T]),(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)(m.A,{show:T,onHide:w,className:"offcanvas-end customeoff",placement:"end",children:[(0,o.jsxs)("div",{className:"offcanvas-header",children:[(0,o.jsx)("h5",{className:"modal-title",id:"#gridSystemModal",children:s}),(0,o.jsx)("button",{type:"button",className:"btn-close",onClick:()=>w(!1),children:(0,o.jsx)("i",{className:"fa-solid fa-xmark"})})]}),(0,o.jsx)("div",{className:"offcanvas-body",children:(0,o.jsx)("div",{className:"container-fluid",children:(0,o.jsx)(u.Op,{children:(0,o.jsxs)("form",{noValidate:!0,onSubmit:r(C),children:[(0,o.jsxs)("div",{className:"row",children:[(0,o.jsxs)("div",{className:"col-xl-6 mb-3",children:[(0,o.jsxs)("label",{className:"form-label",children:[P("technician")," ",(0,o.jsx)("span",{className:"text-danger",children:"*"})]}),(0,o.jsx)(u.xI,{name:"technician",control:c,rules:{required:!0},render:e=>{let{field:{onChange:a,value:s,name:t,ref:l}}=e;return(0,o.jsx)(y,{onChange:e=>{d("technician",e.value)},value:s,customStyles:S,ref:l,name:t})}}),!x("technician")&&(0,o.jsx)(p.A,{errorName:N.technician})]}),(0,o.jsxs)("div",{className:"col-xl-6 mb-3",children:[(0,o.jsxs)("label",{className:"form-label",children:[P("taskCategory"),(0,o.jsx)("span",{className:"text-danger",children:"*"})]}),(0,o.jsx)(u.xI,{name:"c",control:c,rules:{required:!0},render:e=>{let{field:{onChange:a,value:s,name:t,ref:l}}=e;return(0,o.jsx)(j.Ay,{onChange:e=>{d("taskCategory",e.value)},options:b.qf,ref:l,name:t,styles:S,value:s,defaultValue:{value:x("taskCategory")?x("taskCategory"):b.qf[0].value,label:x("taskCategory")?x("taskCategory"):b.qf[0].label}})}}),!x("taskCategory")&&(0,o.jsx)(p.A,{errorName:N.taskCategory})]}),(0,o.jsxs)("div",{className:"col-xl-6 mb-3",children:[(0,o.jsxs)("label",{htmlFor:"exampleFormControlInput2",className:"form-label",children:[P("taskName")," ",(0,o.jsx)("span",{className:"text-danger",children:"*"})]}),(0,o.jsx)(g.A,{type:"text",register:v,name:"taskName",label:"Task Name",placeholder:""}),(0,o.jsx)(p.A,{errorName:N.taskName})]}),(0,o.jsxs)("div",{className:"col-xl-6 mb-3",children:[(0,o.jsxs)("label",{className:"form-label",children:[P("taskPriority")," ",(0,o.jsx)("span",{className:"text-danger",children:"*"})]}),(0,o.jsx)(u.xI,{name:"taskPriority",control:c,rules:{required:!0},render:e=>{let{field:{onChange:a,value:s,name:t,ref:l}}=e;return(0,o.jsx)(j.Ay,{onChange:e=>{d("taskPriority",e.value)},options:b.YR,ref:l,name:t,styles:S,defaultValue:{value:x("taskPriority")?x("taskPriority"):b.YR[0].value,label:x("taskPriority")?x("taskPriority"):b.YR[0].label}})}}),!x("taskPriority")&&(0,o.jsx)(p.A,{errorName:N.taskPriority})]}),(0,o.jsxs)("div",{className:"col-xl-6 mb-3",children:[(0,o.jsx)("label",{htmlFor:"exampleFormControlInput3",className:"form-label",children:P("contactPersonNumber")}),(0,o.jsx)(g.A,{type:"number",register:v,name:"contactPersonNumber",label:"Contact Person Number",placeholder:""}),(0,o.jsx)(p.A,{errorName:N.contactPersonNumber})]}),(0,o.jsxs)("div",{className:"col-xl-6 mb-3",children:[(0,o.jsxs)("label",{className:"form-label",children:[P("serviceLocation"),(0,o.jsx)("span",{className:"text-danger",children:"*"})]}),(0,o.jsx)(g.A,{type:"text",name:"serviceLocation",register:v,label:"Service Location",placeholder:""}),(0,o.jsx)(p.A,{errorName:N.serviceLocation})]}),(0,o.jsxs)("div",{className:"col-xl-6 mb-3 d-flex flex-column",children:[(0,o.jsxs)("label",{className:"form-label",children:[P("plannedReportingDate")," ",(0,o.jsx)("span",{className:"text-danger",children:"*"})]}),(0,o.jsx)(u.xI,{name:"plannedReportingDate",control:c,render:e=>{let{value:a,name:s}=e;return(0,o.jsx)(h(),{selected:x("plannedReportingDate")?new Date(x("plannedReportingDate")):new Date,className:"form-control customDateHeight",onChange:e=>d("plannedReportingDate",e)})}}),!x("plannedReportingDate")&&(0,o.jsx)(p.A,{errorName:N.plannedReportingDate})]}),(0,o.jsxs)("div",{className:"col-xl-6 mb-3 ",children:[(0,o.jsxs)("label",{className:"form-label",children:[P("reportingTime"),(0,o.jsx)("span",{className:"text-danger",children:"*"})]}),(0,o.jsx)(g.A,{type:"time",register:v,name:"reportingTime",label:"Reporting Time",placeholder:""}),(0,o.jsx)(p.A,{errorName:N.reportingTime})]}),(0,o.jsxs)("div",{className:"col-xl-6 mb-3",children:[(0,o.jsx)("label",{className:"form-label",children:P("description")}),(0,o.jsx)("div",{className:"mb-3 ",children:(0,o.jsx)(u.xI,{name:"description",control:c,defaultValue:"",render:e=>{let{field:a}=e;return(0,o.jsx)("textarea",{className:"form-txtarea form-control",register:v("description"),name:"description",label:"Description",rows:"8",id:"comment",...a})}})})]})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("button",{type:"submit",onClick:()=>{console.log("clicked here"),r(C)},className:"btn btn-primary me-1 m-1",children:P("submit")}),(0,o.jsx)(l.N_,{to:"#",onClick:()=>w(!1),className:"btn btn-danger light ms-1 m-1",children:P("cancel")})]})]})})})})]})})}));var C=s(53252),D=s(44988),T=s(35651),w=s(70529),P=(s(43157),s(38686)),S=s.n(P),A=(s(35145),s(71980)),_=s(72555);const R=e=>{const{t:a}=(0,f.Bd)(),{isRtl:s}=(0,t.useContext)(T.D),[n,i]=(0,t.useState)([]),{page:c,nextPage:m,prevPage:x,goToPage:h,setCount:j,totalCount:p,setPage:g}=(0,v.A)(),[b,y]=(0,t.useState)(),[P,R]=(0,t.useState)(!1),E=async(e,a)=>{try{R(!0);const{data:a,totalCount:s}=await(0,N.x1)(e,10);i(a),j(s)}catch(s){(0,w.U)("Error in fetching data")}finally{R(!1)}};(0,t.useEffect)((()=>{E(c)}),[c]);const{register:V,formState:{errors:I},setValue:M,getValues:F,control:L,handleSubmit:q,clearErrors:Y,reset:U}=(0,u.mN)({resolver:(0,C.t)(D.l2)}),O=(0,t.useRef)();return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(r.A,{mainTitle:a("technicianTask"),pageTitle:a("technicianTask"),parentTitle:a("technician")}),(0,o.jsx)("div",{className:"container-fluid",children:(0,o.jsx)("div",{className:"row",children:(0,o.jsx)("div",{className:"col-xl-12",children:(0,o.jsx)("div",{className:"card",children:(0,o.jsx)("div",{className:"card-body p-0",children:(0,o.jsxs)("div",{className:"table-responsive active-projects style-1 ItemsCheckboxSec shorting",children:[(0,o.jsxs)("div",{className:"tbl-caption d-flex justify-content-between text-wrap align-items-center",children:[(0,o.jsx)("h4",{className:"heading mb-0",children:a("technicianTask")}),(0,o.jsxs)("div",{children:[(0,o.jsxs)(l.N_,{to:"#",className:"btn btn-primary btn-sm ms-1","data-bs-toggle":"offcanvas",onClick:()=>{Y(),U(),O.current.showModal()},children:["+ ",a("addTechnicianTask")]})," "]})]}),(0,o.jsxs)("div",{id:"employee-tbl_wrapper",className:"dataTables_wrapper no-footer",children:[!n.length&&P?(0,o.jsx)(_.A,{}):(0,o.jsxs)("table",{id:"empoloyees-tblwrapper",className:"table ItemsCheckboxSec dataTable no-footer mb-0",children:[(0,o.jsx)("thead",{children:(0,o.jsxs)("tr",{children:[(0,o.jsx)("th",{children:a("id")}),(0,o.jsx)("th",{children:a("taskName")}),(0,o.jsx)("th",{children:a("taskCategory")}),(0,o.jsx)("th",{children:a("technicianName")}),(0,o.jsx)("th",{children:a("serviceLocation")}),(0,o.jsx)("th",{children:a("reportingTime")}),(0,o.jsx)("th",{children:a("action")})]})}),(0,o.jsx)("tbody",{children:(0,o.jsx)(d,{tableData:n,onConfirmDelete:async e=>{try{await(0,N.vq)(e);const a=n.filter((a=>a._id!==e));i(a),j(p-1),(0,w.V)("Task Deleted")}catch(a){(0,w.U)("Something Went Wrong")}},editDrawerOpen:e=>{n.map((a=>a._id===e&&y(a))),O.current.showModal()},setEditData:y,currentPage:c,itemsPerPage:10})})]}),(0,o.jsxs)("div",{className:"d-sm-flex text-center justify-content-between align-items-center",children:[(0,o.jsxs)("div",{className:"dataTables_info",children:[a("showing")," ",10*(c-1)+1," ",a("to")," ",Math.min(10*c,p)," ",a("of")," ",p," ",a("entries")]}),(0,o.jsx)("div",{className:"dataTables_paginate paging_simple_numbers",id:"example2_paginate",children:(0,o.jsx)(A.A,{totalCount:p,itemsPerPage:10,handlePageClick:e=>{let{selected:a}=e;h(a+1)},isRtl:s})})]})]})]})})})})})}),(0,o.jsx)(k,{ref:O,editData:b,control:L,setValue:M,getValues:F,onSubmit:async e=>{try{if(e.plannedReportingDate){const a=S()(e.plannedReportingDate).format("YYYY-MM-DD");e.plannedReportingDate=a}e._id&&0!==e._id?(await(0,N.lC)(e,e._id),(0,w.V)("Task Updated Successfully !!"),O.current.closeModal()):(await(0,N.UT)(e),(0,w.V)("Task Created Successfully !!"),O.current.closeModal()),E()}catch(r){var s,t,l;const e=null===(s=r.response)||void 0===s||null===(t=s.data)||void 0===t||null===(l=t.data)||void 0===l?void 0:l.errors;e&&e.length>0?(0,w.U)(e[0].msg):(0,w.U)(a("someErrorOccurred"))}},register:V,errors:I,setEditData:y,handleSubmit:q,clearErrors:Y,reset:U,Title:b&&0!==b._id?a("editTask"):a("addTask")})]})}}}]);
//# sourceMappingURL=3866.9c3ed7a8.chunk.js.map