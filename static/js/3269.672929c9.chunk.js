"use strict";(self.webpackChunkFLEET=self.webpackChunkFLEET||[]).push([[3269],{88107:(e,a,l)=>{l.d(a,{A:()=>i});var s=l(78109),c=l(68892),t=l(74563),r=l(97804),n=l(47337);const i=e=>{let{onChange:a,value:l,customStyles:i,name:o,companyId:d,isDisabled:m,ref:h,isMulti:x=!0}=e;const[u,v]=(0,s.useState)([]),[j,f]=(0,s.useState)(l),{page:b}=(0,r.A)();return(0,s.useEffect)((()=>{(async()=>{const e=(await(0,c.e3)(void 0,d||void 0)).data.data.map((e=>({value:null===e||void 0===e?void 0:e._id,label:null===e||void 0===e?void 0:e.branchName})));v(e)})()}),[b,d]),(0,s.useEffect)((()=>{if(l&&Array.isArray(l)){const e=u.filter((e=>l.some((a=>a===e.value))));f(e)}else f(l)}),[l,u]),(0,n.jsx)(t.Ay,{options:u,value:j,onChange:e=>a(e),styles:i,name:o,ref:h,isDisabled:m,isMulti:!0})}},52145:(e,a,l)=>{l.d(a,{A:()=>n});l(78109);var s=l(27515),c=l(25255),t=l(32449),r=l(47337);const n=e=>{let{tableData:a,onConfirmDelete:l,editDrawerOpen:n}=e;return(0,r.jsx)(r.Fragment,{children:a.map(((e,a)=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:(0,r.jsx)("span",{children:e.basedOn})}),(0,r.jsx)("td",{children:(0,r.jsx)("div",{className:"products",children:(0,r.jsx)("h6",{children:e.alertName})})}),(0,r.jsx)("td",{children:(0,r.jsx)("span",{children:e.alertType})}),(0,r.jsx)("td",{children:(0,r.jsx)("span",{children:new Date(e.createdAt).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})})}),(0,r.jsx)("td",{children:(0,r.jsx)("span",{children:e.notification})}),(0,r.jsx)("td",{children:(0,r.jsx)("span",{children:e.reason})}),(0,r.jsx)("td",{children:(0,r.jsxs)("span",{className:"d-flex justify-content-center",children:[(0,r.jsx)("span",{className:"cursor-pointer",onClick:()=>n(null===e||void 0===e?void 0:e._id),children:(0,r.jsx)(c.uO9,{style:{color:"green",fontSize:"1.2rem"}})}),(0,r.jsx)(t.A,{className:"cursor-pointer ",onConfirmDelete:l,id:e._id,children:(0,r.jsx)(s.b6i,{style:{color:"red",fontSize:"1.2rem"}})})]})})]},a)))})}},43269:(e,a,l)=>{l.r(a),l.d(a,{default:()=>E});var s=l(78109),c=l(78292),t=l(86554),r=l(53252),n=l(34571),i=l(32343),o=l(85129),d=l(74563),m=(l(1682),l(75542)),h=l(20460),x=l(91197),u=(l(7804),l(75889)),v=l.n(u),j=l(88107),f=l(47337);const b=(0,s.forwardRef)(((e,a)=>{var l,r,i,u,b,p,N,g,y;let{Title:k,register:C,setValue:A,getValues:T,control:E,errors:S,handleSubmit:w,onSubmit:D,clearErrors:O,reset:_,editData:I,setEditData:V}=e;const[M,H]=(0,s.useState)(!1),[P,B]=(0,s.useState)(""),[L,R]=(0,s.useState)(""),[U,F]=(0,s.useState)(""),[Y,G]=(0,s.useState)(),{t:$}=(0,n.Bd)(),q=JSON.parse(localStorage.getItem("userDetails"));(0,s.useImperativeHandle)(a,(()=>({showModal(){H(!0)},closeModal(){_(),O(),H(!1)}}))),(0,s.useEffect)((()=>{var e;"COMPANY"===q.user.role&&G(null===q||void 0===q||null===(e=q.user.companyId[0])||void 0===e?void 0:e._id)}),[]);const z={control:e=>({...e,padding:".25rem 0 "})};(0,s.useEffect)((()=>{_({}),O(),M&&I?_({...I}):V()}),[M]);const W=e=>{B(e.target.value),A("basedOn",e.target.value)},J=e=>{R(e.target.value),A("value",e.target.value)},K=e=>{F(e.target.value),A("validDays",e.target.value)},Q=e=>{T(e.target.name);A(e.target.name,e.target.checked)};return(0,f.jsx)(f.Fragment,{children:(0,f.jsxs)(o.A,{show:M,onHide:H,className:"offcanvas-end customeoff",placement:"end",children:[(0,f.jsxs)("div",{className:"offcanvas-header",children:[(0,f.jsx)("h5",{className:"modal-title",id:"#gridSystemModal",children:k}),(0,f.jsx)("button",{type:"button",className:"btn-close",onClick:()=>H(!1),children:(0,f.jsx)("i",{className:"fa-solid fa-xmark"})})]}),(0,f.jsx)("div",{className:"offcanvas-body",children:(0,f.jsx)("div",{className:"container-fluid",children:(0,f.jsx)(t.Op,{children:(0,f.jsxs)("form",{onSubmit:w(D),children:[(0,f.jsxs)("div",{className:"row",children:[(0,f.jsxs)("div",{className:"col-xl-6 mb-3 ",children:[(0,f.jsx)("label",{className:"form-label",children:$("branch")}),(0,f.jsx)(t.xI,{name:"branch",control:E,render:e=>{let{field:{onChange:a,value:l,name:s,ref:c}}=e;return(0,f.jsx)(j.A,{onChange:e=>{const a=e.map((e=>e.value));A("branch",a)},value:l,customStyles:z,ref:c,companyId:Y,name:s})}}),!T("branch")&&(0,f.jsx)(m.A,{errorName:S.branch})]}),(0,f.jsxs)("div",{className:"col-xl-6 mb-3",children:[(0,f.jsxs)("label",{className:"form-label",children:[$("basedOn"),(0,f.jsx)("span",{className:"text-danger",children:"*"})]}),(0,f.jsxs)("div",{className:"basic-form",style:{marginTop:".5rem"},children:[(0,f.jsxs)("div",{className:"form-check custom-checkbox form-check-inline",children:[(0,f.jsx)("input",{type:"radio",className:"form-check-input",value:"VEHICLE",checked:"VEHICLE"===(null!==(l=T("basedOn"))&&void 0!==l?l:P),onChange:W}),(0,f.jsx)("label",{className:"form-check-label",style:{marginBottom:"0"},children:$("vehicle")})]}),(0,f.jsxs)("div",{className:"form-check custom-checkbox form-check-inline",children:[(0,f.jsx)("input",{type:"radio",className:"form-check-input",value:"VEHICLE_GROUP",checked:"VEHICLE_GROUP"===(null!==(r=T("basedOn"))&&void 0!==r?r:P),onChange:W}),(0,f.jsx)("label",{className:"form-check-label",style:{marginBottom:"0"},children:$("vehicleGroup")})]}),(0,f.jsxs)("div",{className:"form-check custom-checkbox form-check-inline",children:[(0,f.jsx)("input",{type:"radio",className:"form-check-input",value:"VEHICLE_TYPE",checked:"VEHICLE_TYPE"===(null!==(i=T("basedOn"))&&void 0!==i?i:P),onChange:W}),(0,f.jsx)("label",{className:"form-check-label",style:{marginBottom:"0"},children:$("vehicleType")})]})]}),!T("basedOn")&&(0,f.jsx)(m.A,{errorName:S.basedOn})]}),(0,f.jsxs)("div",{className:"col-xl-6 mb-3 ",children:[(0,f.jsxs)("label",{className:"form-label",children:[$("object")," ",(0,f.jsx)("span",{className:"text-danger",children:"*"})]}),(0,f.jsx)(t.xI,{name:"object",control:E,rules:{required:!0},render:e=>{var a;let{field:{onChange:l,value:s,name:c,ref:t}}=e;return(0,f.jsx)(d.Ay,{onChange:e=>{A("object",e.value)},options:h.oT,ref:t,name:c,styles:z,value:null===(a=h.oT.filter((e=>e.value==T("object"))))||void 0===a?void 0:a[0]})}}),!T("object")&&(0,f.jsx)(m.A,{errorName:S.object})]}),(0,f.jsxs)("div",{className:""+("VEHICLE_GROUP"!==(null!==(u=T("basedOn"))&&void 0!==u?u:P)?"col-xl-6 mb-3 pe-none red":"col-xl-6 mb-3"),children:[(0,f.jsxs)("label",{className:"form-label",children:[$("objectGroup")," ",(0,f.jsx)("span",{className:"text-danger",children:"*"})]}),(0,f.jsx)(x.A,{type:"text",register:C,label:"Object Group",name:"objectGroup",placeholder:""}),(0,f.jsx)(m.A,{errorName:S.objectGroup})]}),(0,f.jsxs)("div",{className:"col-xl-6 mb-3 ",children:[(0,f.jsxs)("label",{className:"form-label",children:[$("alertName")," ",(0,f.jsx)("span",{className:"text-danger",children:"*"})]}),(0,f.jsx)(x.A,{type:"text",register:C,label:"Alert Name",name:"alertName",placeholder:""}),(0,f.jsx)(m.A,{errorName:S.alertName})]}),(0,f.jsxs)("div",{className:"col-xl-6 mb-3 ",children:[(0,f.jsxs)("label",{className:"form-label",children:[$("alertType")," ",(0,f.jsx)("span",{className:"text-danger",children:"*"})]}),(0,f.jsx)(t.xI,{name:"alertType",control:E,rules:{required:!0},render:e=>{var a;let{field:{onChange:l,value:s,name:c,ref:t}}=e;return(0,f.jsx)(d.Ay,{onChange:e=>{A("alertType",e.value)},options:h.xw,ref:t,name:c,styles:z,value:null===(a=h.xw.filter((e=>e.value===T("alertType"))))||void 0===a?void 0:a[0]})}}),!T("alertType")&&(0,f.jsx)(m.A,{errorName:S.alertType})]}),(0,f.jsxs)("div",{className:"col-xl-6 mb-3",children:[(0,f.jsxs)("label",{className:"form-label",children:["Value",(0,f.jsx)("span",{className:"text-danger",children:"*"})]}),(0,f.jsxs)("div",{className:"basic-form",style:{marginTop:".5rem"},children:[(0,f.jsxs)("div",{className:"form-check custom-checkbox form-check-inline",children:[(0,f.jsx)("input",{type:"radio",className:"form-check-input",value:"START",checked:"START"===(null!==(b=T("value"))&&void 0!==b?b:L),onChange:J}),(0,f.jsx)("label",{className:"form-check-label",style:{marginBottom:"0"},children:$("start")})]}),(0,f.jsxs)("div",{className:"form-check custom-checkbox form-check-inline",children:[(0,f.jsx)("input",{type:"radio",className:"form-check-input",value:"CANCEL",checked:"CANCEL"===(null!==(p=T("value"))&&void 0!==p?p:L),onChange:J}),(0,f.jsx)("label",{className:"form-check-label",style:{marginBottom:"0"},children:$("cancel")})]}),(0,f.jsxs)("div",{className:"form-check custom-checkbox form-check-inline",children:[(0,f.jsx)("input",{type:"radio",className:"form-check-input",value:"BOTH",checked:"BOTH"===(null!==(N=T("value"))&&void 0!==N?N:L),onChange:J}),(0,f.jsx)("label",{className:"form-check-label",style:{marginBottom:"0"},children:$("both")})]})]}),!T("BOTH")&&(0,f.jsx)(m.A,{errorName:S.value})]}),(0,f.jsxs)("div",{className:"col-xl-6 mb-3",children:[(0,f.jsx)("label",{className:"form-label",children:$("validDays")}),(0,f.jsxs)("div",{className:"basic-form",style:{marginTop:".5rem"},children:[(0,f.jsxs)("div",{className:"form-check custom-checkbox form-check-inline",children:[(0,f.jsx)("input",{type:"radio",className:"form-check-input",value:"EVERYDAY",checked:"EVERYDAY"===(null!==(g=T("validDays"))&&void 0!==g?g:U),onChange:K}),(0,f.jsx)("label",{className:"form-check-label",style:{marginBottom:"0"},children:$("everyday")})]}),(0,f.jsxs)("div",{className:"form-check custom-checkbox form-check-inline",children:[(0,f.jsx)("input",{type:"radio",className:"form-check-input",value:"CUSTOM",checked:"CUSTOM"===(null!==(y=T("validDays"))&&void 0!==y?y:U),onChange:K}),(0,f.jsx)("label",{className:"form-check-label",style:{marginBottom:"0"},children:$("custom")})]})]})]}),(0,f.jsxs)("div",{className:"col-xl-6 mb-3 ",children:[(0,f.jsx)("label",{className:"form-label",children:$("validTimeFrom")}),(0,f.jsxs)("div",{className:"d-flex align-items-center justify-content-evenly",children:[(0,f.jsx)(t.xI,{name:"validFrom",control:E,render:e=>{let{value:a,name:l}=e;return(0,f.jsx)(v(),{selected:T("validFrom")?new Date(T("validFrom")):new Date,className:"form-control customDateHeight",onChange:e=>A("validFrom",e)})}}),(0,f.jsx)("span",{className:"px-1",children:$("to")}),(0,f.jsx)(t.xI,{name:"validTo",control:E,render:e=>{let{value:a,name:l}=e;return(0,f.jsx)(v(),{selected:T("validTo")?new Date(T("validTo")):new Date,className:"form-control customDateHeight",onChange:e=>A("validTo",e)})}})]})]}),(0,f.jsxs)("div",{className:"col-xl-6 mb-3 ",children:[(0,f.jsxs)("label",{className:"form-label",children:[$("action")," "]}),(0,f.jsxs)("div",{className:"d-flex align-items-center",children:[(0,f.jsx)("div",{className:"form-check form-check-inline",children:(0,f.jsxs)("label",{className:"form-check-label",children:[(0,f.jsx)("input",{type:"checkbox",className:"form-check-input",name:"action.SMS",checked:T("action.SMS"),onInput:Q}),$("sms")]})}),(0,f.jsx)("div",{className:"form-check form-check-inline",children:(0,f.jsxs)("label",{className:"form-check-label",children:[(0,f.jsx)("input",{type:"checkbox",className:"form-check-input",name:"action.Email",checked:T("action.Email"),onInput:Q}),$("email")]})}),(0,f.jsx)("div",{className:"form-check form-check-inline",children:(0,f.jsxs)("label",{className:"form-check-label",children:[(0,f.jsx)("input",{type:"checkbox",className:"form-check-input",name:"action.Notification",checked:T("action.Notification"),onInput:Q}),$("notification")]})})]})]})]}),(0,f.jsxs)("div",{className:"col-xl-6 mb-3 ",children:[(0,f.jsxs)("label",{className:"form-label",children:[$("severity")," ",(0,f.jsx)("span",{className:"text-danger",children:"*"})]}),(0,f.jsx)(t.xI,{name:"severity",control:E,rules:{required:!0},render:e=>{var a;let{field:{onChange:l,value:s,name:c,ref:t}}=e;return(0,f.jsx)(d.Ay,{onChange:e=>{A("severity",e.value)},options:h.YR,ref:t,name:c,styles:z,value:null===(a=h.YR.filter((e=>e.value==T("severity"))))||void 0===a?void 0:a[0]})}}),!T("severity")&&(0,f.jsx)(m.A,{errorName:S.severity})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("button",{type:"submit",onClick:()=>{w(D)},className:"btn btn-primary me-1 m-1",children:$("submit")}),(0,f.jsx)(c.N_,{to:"#",onClick:()=>H(!1),className:"btn btn-danger light ms-1 m-1",children:$("cancel")})]})]})})})})]})})}));var p=l(52145),N=l(44988),g=l(71980),y=l(97804),k=l(70529),C=l(74763);(0,l(95441).A)();const A=async function(){var e;let a=`/alerts?page=${arguments.length>0&&void 0!==arguments[0]?arguments[0]:1}&limit=${arguments.length>1&&void 0!==arguments[1]?arguments[1]:10}`;const l=await C.A.get(a);return null===l||void 0===l||null===(e=l.data)||void 0===e?void 0:e.data};var T=l(72555);const E=()=>{const{t:e}=(0,n.Bd)(),{register:a,formState:{errors:l},setValue:o,getValues:d,control:m,clearErrors:h,handleSubmit:x,reset:u}=(0,t.mN)({resolver:(0,r.t)(N.cA)}),[v,j]=(0,s.useState)([]),{page:E,goToPage:S,setCount:w,totalCount:D}=(0,y.A)(),[O,_]=(0,s.useState)(),[I,V]=(0,s.useState)(!1),M=async(e,a)=>{try{V(!0);const{data:a,count:l}=await A(e,10);j(a),w(l)}catch(l){(0,k.U)("Error in fetching data")}finally{V(!1)}};(0,s.useEffect)((()=>{M(E)}),[E]);const H=(0,s.useRef)();return(0,s.useEffect)((()=>{!async function(){try{const{data:e,totalPage:a,totalCount:l}=await A();j(e),console.log("data came",e)}catch(e){console.log("Error in fetching data",e)}}()}),[]),(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(i.A,{mainTitle:e("alert"),pageTitle:e("alert"),parentTitle:e("settings")}),(0,f.jsx)("div",{className:"container-fluid",children:(0,f.jsx)("div",{className:"row",children:(0,f.jsx)("div",{className:"col-xl-12",children:(0,f.jsx)("div",{className:"card",children:(0,f.jsx)("div",{className:"card-body p-0",children:(0,f.jsxs)("div",{className:"table-responsive active-projects style-1 ItemsCheckboxSec shorting",children:[(0,f.jsxs)("div",{className:"tbl-caption d-flex justify-content-between text-wrap align-items-center",children:[(0,f.jsx)("h4",{className:"heading mb-0",style:{flex:1},children:e("alert")}),(0,f.jsx)("div",{className:"d-flex",children:(0,f.jsxs)("div",{children:[(0,f.jsxs)(c.N_,{to:"#",className:"btn btn-primary btn-sm ms-1","data-bs-toggle":"offcanvas",onClick:()=>{h(),u(),H.current.showModal()},children:["+ ",e("addAlert")]})," "]})})]}),(0,f.jsxs)("div",{id:"employee-tbl_wrapper",className:"dataTables_wrapper no-footer",children:[!v.length&&I?(0,f.jsx)(T.A,{}):(0,f.jsxs)("table",{id:"empoloyees-tblwrapper",className:"table ItemsCheckboxSec dataTable no-footer mb-0",children:[(0,f.jsx)("thead",{children:(0,f.jsxs)("tr",{children:[(0,f.jsx)("th",{children:e("alerts")}),(0,f.jsx)("th",{children:e("alertName")}),(0,f.jsx)("th",{children:e("alertType")}),(0,f.jsx)("th",{children:e("createdDate")}),(0,f.jsx)("th",{children:e("notification")}),(0,f.jsx)("th",{children:e("reason")}),(0,f.jsx)("th",{children:e("action")})]})}),(0,f.jsx)("tbody",{children:(0,f.jsx)(p.A,{editData:O,tableData:v,onConfirmDelete:async e=>{try{await(async e=>{var a;const l=await C.A.delete(`/alerts/${e}`);return null===l||void 0===l||null===(a=l.data)||void 0===a?void 0:a.data})(e);const a=v.filter((a=>a._id!==e));j(a),w(D-1),(0,k.V)("Task Deleted")}catch(a){(0,k.U)("Something Went Wrong")}},editDrawerOpen:e=>{v.map((a=>a._id===e&&_(a))),H.current.showModal()},setEditData:_,currentPage:E,itemsPerPage:10})})]}),(0,f.jsxs)("div",{className:"d-sm-flex text-center justify-content-between align-items-center",children:[(0,f.jsxs)("div",{className:"dataTables_info",children:[e("showing")," ",10*(E-1)+1," ",e("to")," ",Math.min(10*E,D)," ",e("of")," ",D," ",e("entries")]}),(0,f.jsx)("div",{className:"dataTables_paginate paging_simple_numbers",id:"example2_paginate",children:(0,f.jsx)(g.A,{totalCount:D,itemsPerPage:10,handlePageClick:e=>{let{selected:a}=e;S(a+1)}})})]})]})]})})})})})}),(0,f.jsx)(b,{ref:H,Title:O&&0!==O._id?"Edit Alert":e("addAlert"),editData:O,setEditData:_,register:a,setValue:o,onSubmit:async a=>{try{a._id&&0!==a._id?(await(async(e,a)=>{var l;const s=await C.A.put(`/alerts/${a}`,e);return null===s||void 0===s||null===(l=s.data)||void 0===l?void 0:l.data})(a,a._id),(0,k.V)("Task Updated Successfully !!"),M(E),H.current.closeModal()):(await(async e=>{var a;const l=await C.A.post("/alerts",e);return null===l||void 0===l||null===(a=l.data)||void 0===a?void 0:a.data})(a),(0,k.V)("Task Added Successfully !!"),M(E),H.current.closeModal())}catch(t){var l,s,c;const a=null===(l=t.response)||void 0===l||null===(s=l.data)||void 0===s||null===(c=s.data)||void 0===c?void 0:c.errors;a&&a.length>0?(0,k.U)(a[0].msg):(0,k.U)(e("someErrorOccurred"))}},getValues:d,control:m,errors:l,handleSubmit:x,clearErrors:h,reset:u})]})}}}]);
//# sourceMappingURL=3269.672929c9.chunk.js.map