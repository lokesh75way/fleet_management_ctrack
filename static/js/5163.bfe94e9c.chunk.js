"use strict";(self.webpackChunkFLEET=self.webpackChunkFLEET||[]).push([[5163],{45794:(e,a,t)=>{t.d(a,{A:()=>r});var s=t(65043),n=t(80228),l=t(51403),i=t(3778),c=t(70579);function r(e){let{geojson:a,setGeojson:t}=e;const r=(0,s.useRef)(null);(0,s.useEffect)((()=>{var e;0===(null===(e=r.current)||void 0===e?void 0:e.getLayers().length)&&a&&n.geoJSON(a).eachLayer((e=>{var a,t,s;(e instanceof n.Polyline||e instanceof n.Polygon||e instanceof n.Marker)&&(null!==e&&void 0!==e&&null!==(a=e.feature)&&void 0!==a&&a.properties.radius&&r.current?new n.Circle(e.feature.geometry.coordinates.slice().reverse(),{radius:null===(t=e.feature)||void 0===t?void 0:t.properties.radius}).addTo(r.current):null===(s=r.current)||void 0===s||s.addLayer(e))}))}),[a]);const o=()=>{var e;const a=null===(e=r.current)||void 0===e?void 0:e.toGeoJSON();console.log(a),"FeatureCollection"===(null===a||void 0===a?void 0:a.type)&&t(a)};return(0,c.jsx)(l.m,{ref:r,children:(0,c.jsx)(i.M,{position:"topright",onEdited:o,onCreated:o,onDeleted:o,draw:{rectangle:!1,circle:!0,polyline:!0,polygon:!0,marker:!0,circlemarker:!1}})})}},53358:(e,a,t)=>{t.d(a,{A:()=>o});t(65043),t(33723),t(72213);var s=t(70579);t(84391);var n=t(99419),l=t(12023),i=t(76036),c=t(13318),r=t(62559);t(45794);const o=e=>{let{data:a}=e;return(0,s.jsx)("div",{style:{display:"flex",height:"85vh",position:"relative",zIndex:1},children:(0,s.jsx)("div",{style:{width:"100%"},children:(0,s.jsxs)(n.W,{center:[25.2233,55.2869],zoom:14,zoomControl:!1,children:[(0,s.jsx)(l.e,{attribution:'\xa9 <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"http://{s}.tile.osm.org/{z}/{x}/{y}.png"}),(0,s.jsxs)(i.p,{styles:{background:"red"},position:[25.2233,55.2869],children:[(0,s.jsx)(c.z,{children:"Dubai Trade Center"}),(0,s.jsx)(r.m,{children:"Dubai Trade Center"})]})]})})})}},98649:(e,a,t)=>{t.r(a),t.d(a,{default:()=>A});var s=t(65043),n=t(9866),l=t(53358),i=t(33723),c=t(44816),r=t(86856),o=t(10457),d=t(14282),m=(t(72213),t(50423)),h=(t(51359),t(15075),t(47522)),p=(t(19980),t(79904)),u=t.n(p),x=t(70579);const g=e=>{const[a,t]=(0,s.useState)([]),[n,l]=(0,s.useState)([]),[i,c]=(0,s.useState)([]);(0,s.useEffect)((()=>{const a=Object.entries(e.vehicles).map((e=>{const a=e[1].map((e=>({label:e.vehicleName,value:e.id})));return{value:e[0],label:e[0],children:a}}));c([...a])}),[e.vehicles]);return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("div",{className:"checkboxTree",children:(0,x.jsx)(u(),{nodes:i,checked:a,expanded:n,onCheck:e=>{t(e)},onExpand:e=>{l(e)},showNodeIcon:!1,icons:{expandOpen:(0,x.jsx)("i",{class:"fa-solid fa-minus"}),expandClose:(0,x.jsx)("i",{class:"fa-solid fa-plus"}),uncheck:(0,x.jsx)("i",{class:"fa-regular fa-square",style:{fontSize:"16px"}}),check:(0,x.jsx)("i",{class:"fa-solid fa-square-check",style:{fontSize:"16px"}}),halfCheck:(0,x.jsx)("i",{class:"fa-regular fa-square-minus",style:{fontSize:"16px"}})}})}),(0,x.jsx)("div",{className:"text-center  pt-2 ",children:(0,x.jsx)(d.A,{className:" mb-5",variant:"primary btn-md ",type:"submit",onClick:()=>{const t=a.map((e=>JSON.parse(e)));console.log(t),e.handleToggleCardPositionHandler()},children:"Save Selection"})})]})};var v=t(272);const f=e=>{let{geoFences:a,handleToggleCardPositionHandler:t}=e;const[n,l]=(0,s.useState)([]),[i,c]=(0,s.useState)([]),[r,o]=(0,s.useState)([]);(0,s.useEffect)((()=>{const e=Object.entries(a).map((e=>{let[a,t]=e;return{value:a,label:a,children:t.map((e=>({label:e.name,value:e.id})))}}));o(e)}),[a]);return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("div",{className:"checkboxTree",children:(0,x.jsx)(u(),{nodes:r,checked:n,expanded:i,onCheck:e=>{l(e)},onExpand:e=>{c(e)},showNodeIcon:!1,icons:{expandOpen:(0,x.jsx)("i",{className:"fa-solid fa-minus"}),expandClose:(0,x.jsx)("i",{className:"fa-solid fa-plus"}),uncheck:(0,x.jsx)("i",{className:"fa-regular fa-square",style:{fontSize:"16px"}}),check:(0,x.jsx)("i",{className:"fa-solid fa-square-check",style:{fontSize:"16px"}}),halfCheck:(0,x.jsx)("i",{className:"fa-regular fa-square-minus",style:{fontSize:"16px"}})}})}),(0,x.jsx)("div",{className:"text-center  pt-2 ",children:(0,x.jsx)(d.A,{className:" mb-5",variant:"primary btn-md ",type:"submit",onClick:()=>{const e=n.map((e=>JSON.parse(e)));console.log(e),t()},children:"Save Selection"})})]})},j=e=>{const a=(0,v.r_)(),{Running:t,Idle:n,Stopped:l,Inactive:i,nodata:c,total:r}=a,[o,d]=(0,s.useState)("All"),[m,p]=(0,s.useState)([]);(0,s.useEffect)((()=>{const e=(0,v.kw)(o);p(e)}),[o]);const u=JSON.parse(localStorage.getItem("userJsonData")).filter((e=>"vehicle"===e.designation)).map((e=>({id:e.id,name:e.vehicleName})));return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)("div",{className:"vehicle_tracking-object",children:[(0,x.jsxs)("span",{className:"light fs-9 running ".concat("Running"===o&&"vehicle_tracking-active"),onClick:()=>d("Running"),children:[(0,x.jsx)("p",{children:t}),(0,x.jsx)("span",{children:"Running"})]}),(0,x.jsxs)("span",{pill:!0,className:"light fs-9 idle ".concat("Idle"===o&&"vehicle_tracking-active"),onClick:()=>d("Idle"),children:[(0,x.jsx)("p",{children:n}),(0,x.jsx)("span",{children:"Idle"})]}),(0,x.jsxs)("span",{pill:!0,className:"light stopped fs-9 ".concat("Stopped"===o&&"vehicle_tracking-active"),onClick:()=>d("Stopped"),children:[(0,x.jsx)("p",{children:l}),(0,x.jsx)("span",{children:"Stopped"})]}),(0,x.jsxs)("span",{pill:!0,className:"light fs-9 inActive ".concat("Inactive"===o&&"vehicle_tracking-active"),onClick:()=>d("Inactive"),children:[(0,x.jsx)("p",{children:i}),(0,x.jsx)("span",{children:"InActive"})]}),(0,x.jsxs)("span",{pill:!0,className:"light fs-9 noData ".concat("NoData"===o&&"vehicle_tracking-active"),onClick:()=>d("NoData"),children:[(0,x.jsx)("p",{children:c}),(0,x.jsx)("span",{children:"NoData"})]}),(0,x.jsxs)("span",{className:"light fs-9 total ".concat("All"===o&&"vehicle_tracking-active"),onClick:()=>d("All"),children:[(0,x.jsx)("p",{children:r}),(0,x.jsx)("span",{children:"Total"})]})]}),(0,x.jsx)("div",{className:"d-flex mt-4 mb-4",children:(0,x.jsx)(h.ReactSearchAutocomplete,{items:u,className:"w-100",styling:{height:"30px",marginRight:"10px",fontSize:"12px",color:"#4A4646"},onSearch:e=>{if(""===e){const e=(0,v.kw)(o);p(e)}},onSelect:e=>{const a=(0,v.kw)(o);console.log(a);const t=Object.entries(a).filter((a=>a[1].filter((a=>a.id==e.id)).length>0)).reduce(((a,t)=>{let[s,n]=t;return n.map((t=>{t.vehicleName===e.name&&(a[s]=[t])})),a}),{});p(t)}})}),(0,x.jsx)(g,{vehicles:m,handleToggleCardPositionHandler:e.handleToggleCardPosition})]})},N=e=>{const[a,t]=(0,s.useState)("All"),[n,l]=(0,s.useState)([]),[i,c]=(0,s.useState)([]),[r,m]=(0,s.useState)([]),[p,u]=(0,s.useState)(!1),[g,v]=(0,s.useState)(!1),f=JSON.parse(localStorage.getItem("userJsonData")),[j,N]=(0,s.useState)(f.filter((e=>"company"===e.role))),[k,S]=(0,s.useState)(f.filter((e=>"Driver"===e.designation))),y=k.filter((e=>"Allocated"===e.activityStatus)),C=k.filter((e=>"Not Allocated"===e.activityStatus)),b=k.length;console.log(k);const A=e=>{console.log(n),l((a=>{const t=[...a];return t[e]=!t[e],t}))};(0,s.useEffect)((()=>{if("All"!==a){if(N(f.filter((e=>"company"===e.role))),u(!0),"Allocated"===a){const e=y.map((e=>e.parentCompany)).filter(((e,a,t)=>t.indexOf(e)===a));N(j.filter((a=>e.some((e=>e===a.userName)))))}if("Not Allocated"===a){const e=C.map((e=>e.parentCompany)).filter(((e,a,t)=>t.indexOf(e)===a));N(j.filter((a=>e.some((e=>e===a.userName)))))}}else u(!1)}),[a]);const T=f.filter((e=>"Driver"===e.designation)).map((e=>({id:e.id,name:e.firstName+" "+e.lastName})));return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)("div",{className:"px-2 vehicle_tracking-object",children:[(0,x.jsxs)("span",{bg:"",pill:!0,className:"light fs-9  running ".concat("Allocated"===a?"vehicle_tracking-active":g&&"pe-none"),onClick:()=>t("Allocated"),children:[(0,x.jsx)("p",{children:y.length}),(0,x.jsx)("span",{children:"Allocated"})]}),(0,x.jsxs)("span",{bg:"",pill:!0,className:"light fs-9 idle ".concat("Not Allocated"===a?"vehicle_tracking-active":g&&"pe-none"),onClick:()=>t("Not Allocated"),children:[(0,x.jsx)("p",{children:C.length}),(0,x.jsx)("span",{children:"Not Allocated"})]}),(0,x.jsxs)("span",{bg:"",pill:!0,className:"light fs-9 total ".concat("Total"===a?"vehicle_tracking-active":g&&"pe-none"),onClick:()=>t("Total"),children:[(0,x.jsx)("p",{children:b}),(0,x.jsx)("span",{children:"Total"})]})]}),(0,x.jsx)("div",{className:"d-flex mt-4 mb-4",children:(0,x.jsx)(h.ReactSearchAutocomplete,{items:T,className:"w-100",styling:{height:"30px",marginRight:"10px",fontSize:"12px",color:"#red"},onSearch:(e,a)=>{t("All"),v(!1),u(!1),S(f.filter((e=>"Driver"===e.designation))),N(f.filter((e=>"company"===e.role)))},onSelect:e=>{t("All"),u(!0),v(!0);var a=f.filter((a=>"Driver"===a.designation&&a.id===e.id)),s=j.filter((e=>e.userName===a[0].parentCompany));S(a),N(s)}})}),(0,x.jsx)("div",{className:"d-flex flex-column  p-2",style:{marginTop:".5rem",height:"65vh",overflowY:"scroll"},children:j.map(((e,t)=>{var s=[];return 0===i.length&&j.map((e=>i.push([])&&n.push(!1))),p?"All"===a?s=k:"Allocated"===a?s=y.filter((a=>a.parentCompany===e.userName)):"Not Allocated"===a?s=C.filter((a=>a.parentCompany===e.userName)):"Total"===a&&(s=f.filter((a=>"Driver"===a.designation&&a.parentCompany===e.userName))):s=f.filter((a=>"Driver"===a.designation&&a.parentCompany===e.userName)),(0,x.jsx)(o.A,{className:"accordion accordion-primary",defaultActiveKey:"0",children:(0,x.jsxs)(o.A.Item,{className:"accordion-item",eventKey:"$/{i}",children:[(0,x.jsxs)(o.A.Header,{className:"accordian-header rounded-sm",children:[(0,x.jsx)("div",{className:"form-check custom-checkbox bs_exam_topper_all",style:{marginRight:"10px"},onClick:e=>e.stopPropagation(),children:(0,x.jsx)("input",{type:"checkbox",className:"form-check-input",id:"customCheckBox".concat(t),onChange:()=>((e,a,t,s)=>{var l=[...i];n[s]?(l[s]=[],c(l)):t.map((e=>l[s].push(e.id))),console.log(l)})(e.id,0,s,t),onClick:()=>A(t),checked:n[t],required:!0})}),e.userName]}),0===s.length?(0,x.jsx)(o.A.Body,{className:"p-2 text-center fs-4 heading ",children:"No Record Found"}):s.map(((e,a)=>(0,x.jsx)(o.A.Body,{className:"accordian-body",eventKey:"".concat(t),children:(0,x.jsxs)("div",{onClick:()=>{m(r.concat(e.id))},className:"d-flex align-items-center border-bottom heading driver-select-object p-2",children:[(0,x.jsx)("div",{className:"form-check custom-checkbox ms-3 me-3 bs_exam_topper",children:(0,x.jsx)("input",{type:"checkbox",className:"form-check-input",onChange:()=>((e,a)=>{const t=[...i];if(t[a].includes(e)){const s=t[a].indexOf(e);t[a].splice(s,1),2===t[a].length&&A(a)}else t[a].push(e),3===t[a].length&&A(a);console.log(t),c(t)})(e.id,t),checked:i[t].includes(e.id),required:!0})}),(0,x.jsxs)("span",{className:"fs-4 ms-2",children:[e.firstName," ",e.lastName]})]},a)})))]},t)})}))}),(0,x.jsx)("div",{className:"mt-3 text-center",children:(0,x.jsx)(d.A,{className:"btn-md",variant:"primary",children:"Save Selection"})})]})},k=e=>{const a=JSON.parse(localStorage.getItem("geofenceData")),[t,n]=(0,s.useState)(a),[l,i]=(0,s.useState)([]),[c,r]=(0,s.useState)(""),o=(t.filter((e=>e.company.toLowerCase().includes(c.toLowerCase()))),t.reduce(((e,a)=>(e[a.company]||(e[a.company]=[]),e[a.company].push(a),e)),{})),d=t.map((e=>({id:e.id,name:e.name})));return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("div",{className:"d-flex mt-4 mb-4",children:(0,x.jsx)(h.ReactSearchAutocomplete,{items:d,className:"w-100",styling:{height:"30px",marginRight:"10px",fontSize:"12px",color:"#red"},onSelect:e=>{console.log("Search Query:",e);const t=a.filter((a=>a.id===e.id));n(t)}})}),(0,x.jsx)("div",{className:"d-flex flex-column p-2",style:{marginTop:".5rem",overflowY:"scroll"},children:(0,x.jsx)(f,{geoFences:o,handleToggleCardPositionHandler:e.handleToggleCardPosition})})]})},S=e=>{let{tabData:a,handleToggleCardPosition:t,isOutside:s}=e;const n={name:"Company1",drivers:[{name:"driver1",timeStamp:"22-02-2024 3:00 PM",status:"running"},{name:"driver2",timeStamp:"22-02-2024 3:00 PM",status:"idle"},{name:"driver3",timeStamp:"22-02-2024 3:00 PM",status:"inactive"},{name:"driver4",timeStamp:"22-02-2024 3:00 PM",status:"running"},{name:"driver5",timeStamp:"22-02-2024 3:00 PM",status:"stopped"},{name:"driver6",timeStamp:"22-02-2024 3:00 PM",status:"stopped"},{name:"driver7",timeStamp:"22-02-2024 3:00 PM"}],allocatedDriver:4,notAllocatedDriver:3,totalDriver:7},l=[j,N,k];return(0,x.jsx)(x.Fragment,{children:(0,x.jsxs)("div",{className:"default-tab outer-container ".concat(s?"toggleBarInside":"toggleBarOutside"),children:[(0,x.jsx)("button",{onClick:t,className:"driver_tracking_button",children:s?(0,x.jsx)(m.m6W,{}):(0,x.jsx)(m.OQo,{})}),(0,x.jsxs)(c.A.Container,{defaultActiveKey:a[0].name.toLowerCase(),children:[(0,x.jsx)(r.A,{as:"ul",className:"nav-tabs tracking_navTabs",children:a.map(((e,a)=>{const t=e.icon;return(0,x.jsx)(r.A.Item,{as:"li",children:(0,x.jsxs)(r.A.Link,{eventKey:e.name.toLowerCase(),children:[(0,x.jsx)(t,{className:"tab-icon"}),e.name]})},a)}))}),(0,x.jsx)(c.A.Content,{className:"p-2 py-4",style:{background:"#f5f5f5",overflow:"scroll",height:"100vh"},children:a.map(((e,a)=>{const s=l[a];return(0,x.jsx)(c.A.Pane,{eventKey:e.name.toLowerCase(),children:(0,x.jsx)(s,{data:n,handleToggleCardPosition:t})},a)}))})]})]})})};var y=t(60397),C=t(60184),b=t(6720);const A=()=>{const{currentPosition:e,setCurrentPosition:a}=(0,s.useContext)(i.D),[t,c]=(0,s.useState)(!0),r=[{name:"Object",icon:y.ETQ},{name:"Driver",icon:C.x$1},{name:"Geofence",icon:b.vVi}];return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(n.A,{mainTitle:"Vehicle Tracking",pageTitle:"Vehicle Tracking",parentTitle:"Tracking"}),(0,x.jsx)("div",{className:"backdrop ".concat(t?"d-none":"d-block"),onClick:()=>c(!0)}),(0,x.jsx)("div",{className:"p-2",children:(0,x.jsx)(l.A,{data:[{lat:30.7099475,lng:76.6900474},{lat:30.7333,lng:76.7794}]})}),(0,x.jsx)(S,{tabData:r,handleToggleCardPosition:()=>{c(!t)},isOutside:t})]})}}}]);
//# sourceMappingURL=5163.bfe94e9c.chunk.js.map