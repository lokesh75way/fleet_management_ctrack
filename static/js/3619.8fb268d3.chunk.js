"use strict";(self.webpackChunkFLEET=self.webpackChunkFLEET||[]).push([[3619],{23619:(e,a,s)=>{s.r(a),s.d(a,{default:()=>C});var l=s(65043),r=s(2364),t=(s(84391),s(99419)),n=s(12023),c=s(76036),o=s(13318),i=s(62559),d=s(15560),u=s(70579);const m=e=>{let{geofenceHanlder:a,setValue:s,getValues:r,defaultValues:m,errors:p}=e;const[x,g]=(0,l.useState)([]),[h,f]=(0,l.useState)([]),[v,b]=(0,l.useState)([]),[j,y]=(0,l.useState)([]),[N,A]=l.useState({type:"FeatureCollection",features:[]});return(0,l.useEffect)((()=>{null!==m&&void 0!==m&&m.location&&(g([]),b([]),f([]),y([]),null===m||void 0===m||m.location.map((e=>{"Circle"===e.type&&b((a=>[...a,e])),"Polygon"===e.type&&y((a=>[...a,{type:e.type,coordinates:e.coordinates}])),"Point"===e.type&&f((a=>[...a,e])),"LineString"===e.type&&g((a=>[...a,e]))})))}),[m]),(0,u.jsx)("div",{style:{display:"flex",height:"85vh",border:p.location?"3px solid #ff5e5e":null},children:(0,u.jsx)("div",{style:{width:"100%"},children:(0,u.jsxs)(t.W,{center:[25.2233,55.2869],zoom:14,zoomControl:!1,children:[(0,u.jsx)(n.e,{attribution:'\xa9 <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"http://{s}.tile.osm.org/{z}/{x}/{y}.png"}),(0,u.jsxs)(c.p,{styles:{background:"red"},position:[25.2233,55.2869],children:[(0,u.jsx)(o.z,{children:"Dubai Trade Center"}),(0,u.jsx)(i.m,{children:"Dubai Trade Center"})]}),(0,u.jsx)(d.A,{points:h,lineString:x,circles:v,polygon:j,setValues:s,geofenceHanlder:a,defaultValues:m})]})})})};var p=s(69367),x=s(24858),g=s(18403),h=s(87742),f=s(15075),v=s(14282),b=s(23764),j=s(42457),y=s(73216),N=s(7995),A=s(74117),S=s(12954);const C=()=>{const[e,a]=(0,l.useState)(null),[s,t]=(0,l.useState)(),[n,c]=(0,l.useState)(),[o,i]=(0,l.useState)(null),d=(0,y.Zp)(),{id:C}=(0,y.g)(),[I,V]=(0,l.useState)(),[k,w]=(0,l.useState)(!1),F=JSON.parse(localStorage.getItem("userDetails")),G={control:e=>({...e,padding:".25rem 0 "})};(0,l.useEffect)((()=>{"COMPANY"===F.user.role&&(console.log(F),L("businessGroupId",null===F||void 0===F?void 0:F.user.businessGroupId),i(null===F||void 0===F?void 0:F.user.businessGroupId),L("companyId",null===F||void 0===F?void 0:F.user.companyId),V(null===F||void 0===F?void 0:F.user.companyId),w(!0),console.log("companyId",null===F||void 0===F?void 0:F.user.businessGroupId)),"BUSINESS_GROUP"===F.user.role&&(L("businessGroupId",null===F||void 0===F?void 0:F.user.businessGroupId),i(null===F||void 0===F?void 0:F.user.businessGroupId)),C&&(async()=>{if(C){const{data:e}=await(0,N.LN)(C);t(e),L("company",e.company),L("name",e.name),L("category",e.category),L("contactNumber",e.contactNumber),L("tolerance",e.tolerance),L("geofenceAccess",e.geofenceAccess),a(e.geofenceAccess),L("description",e.description),L("address",e.address),L("location",e.location)}})()}),[C]);const{register:D,formState:{errors:E},setValue:L,getValues:P,control:O,handleSubmit:T}=(0,x.mN)({resolver:(0,g.t)(h._8),defaultValues:{category:f.rF[0].value,tolerance:f.gY[0].value}}),z=e=>{a(e.target.value),L("geofenceAccess",e.target.value)},U=async e=>{try{if(C){const{success:a}=await(0,N.ck)(C,e);return void(a&&((0,j.V)("Geofence updated successfully!"),d("/settings/geofence")))}{console.log(e);const{success:a}=await(0,N.vo)(e);return void(a&&((0,j.V)("New Geofence Created!"),d("/settings/geofence")))}}catch(a){return console.log(a),void(0,j.U)("Some error occured !!")}},B=JSON.parse(localStorage.getItem("geofenceData")).filter((e=>e.id==C)),[q,M]=(0,l.useState)(B),{t:R}=(0,A.Bd)();return(0,u.jsxs)("div",{children:[(0,u.jsx)("div",{style:{padding:"10px",backgroundColor:"#FFFDFD"},children:(0,u.jsxs)("h2",{style:{fontSize:"20px"},children:[R("geofenceDetail"),"l"]})}),(0,u.jsxs)("div",{className:"",style:{display:"flex",height:"88vh"},children:[(0,u.jsx)("div",{className:"col-md-3",style:{padding:"15px",boxShadow:"9px 0 4px rgba(0, 0, 0, 0.1)",backgroundColor:"#fff",overflow:"auto"},children:(0,u.jsx)(x.Op,{children:(0,u.jsxs)("form",{onSubmit:T(U),children:[(0,u.jsxs)("div",{className:"mb-2",children:[(0,u.jsxs)("label",{htmlFor:"company",className:"form-label",children:[R("company"),":",(0,u.jsx)("span",{className:"text-danger",children:"*"})]}),(0,u.jsx)(x.xI,{name:"company",control:O,rules:{required:!0},render:e=>{let{field:{onChange:a,value:s,name:l,ref:r}}=e;return(0,u.jsx)(S.A,{groupId:o,onChange:e=>{L("company",e.value),L("companyName",e.value),V(e.value)},value:s,customStyles:G,ref:r,isDisabled:k,name:l},o)}}),(0,u.jsx)(b.A,{errorName:E.company})]}),(0,u.jsxs)("div",{className:"mb-2",children:[(0,u.jsxs)("label",{htmlFor:"company",className:"form-label",children:[R("name"),":",(0,u.jsx)("span",{className:"text-danger",children:"*"})]}),(0,u.jsx)(p.A,{type:"text",label:"Name",register:D,name:"name",defaultValue:q[0]?q[0].name:""}),(0,u.jsx)(b.A,{errorName:E.name})]}),(0,u.jsxs)("div",{className:"mb-3",children:[(0,u.jsxs)("label",{className:"form-label",children:[R("category"),":",(0,u.jsx)("span",{className:"text-danger",children:"*"})]}),(0,u.jsx)(x.xI,{name:"category",control:O,rules:{required:!0},render:e=>{let{field:{onChange:a,value:s,name:l,ref:t}}=e;return(0,u.jsx)(r.Ay,{onChange:e=>{c(e.value),L("category",e.value)},options:f.rF,ref:t,name:l,styles:G,value:{value:s,label:s}})}}),!P("category")&&(0,u.jsx)(b.A,{errorName:E.category})]}),(0,u.jsxs)("div",{className:"mb-3",children:[(0,u.jsxs)("label",{className:"form-label",children:[R("geofenceAccess"),":",(0,u.jsx)("span",{className:"text-danger",children:"*"})]}),(0,u.jsxs)("div",{style:{display:"flex",flexDirection:"row",gap:"5rem"},children:[(0,u.jsxs)("div",{className:"form-check",children:[(0,u.jsx)("input",{type:"radio",className:"form-check-input",value:"PUBLIC",checked:"PUBLIC"===e,onChange:z}),(0,u.jsx)("label",{className:"form-check-label",children:R("public")})]}),(0,u.jsxs)("div",{className:"form-check",children:[(0,u.jsx)("input",{type:"radio",className:"form-check-input",value:"PRIVATE",checked:"PRIVATE"===e,onChange:z}),(0,u.jsx)("label",{className:"form-check-label",children:R("private")})]})]}),!P("geofenceAccess")&&(0,u.jsx)(b.A,{errorName:E.geofenceAccess})]}),(0,u.jsxs)("div",{className:"mb-3",children:[(0,u.jsxs)("label",{htmlFor:"contactNumber",className:"form-label",children:[R("contactNumber"),":",(0,u.jsx)("span",{className:"text-danger",children:"*"})]}),(0,u.jsx)(p.A,{type:"number",register:D,label:"Contact Number",name:"contactNumber",min:"0",onInput:e=>{const a=Math.max(0,e.target.value);e.target.value=a<1?"":a},defaultValue:q[0]?q[0].contactNumber:""}),(0,u.jsx)(b.A,{errorName:E.contactNumber})]}),(0,u.jsxs)("div",{className:"mb-3",children:[(0,u.jsxs)("label",{htmlFor:"address",className:"form-label",children:[R("address"),":"]}),(0,u.jsx)("textarea",{className:"form-control",...D("address"),label:"Address",name:"address",defaultValue:q[0]?q[0].address:""})]}),(0,u.jsxs)("div",{className:"mb-3",children:[(0,u.jsxs)("label",{className:"form-label",children:[R("tolerance"),":",(0,u.jsx)("span",{className:"text-danger",children:"*"})]}),(0,u.jsx)(x.xI,{name:"tolerance",control:O,rules:{required:!0},render:e=>{let{field:{onChange:a,value:s,name:l,ref:t}}=e;return(0,u.jsx)(r.Ay,{onChange:e=>{c(e.value),L("tolerance",e.value)},options:f.gY,ref:t,name:l,styles:G,value:{label:s,value:s}})}}),!P("tolerance")&&(0,u.jsx)(b.A,{errorName:E.tolerance})]}),(0,u.jsxs)("div",{className:"mb-3",children:[(0,u.jsxs)("label",{className:"form-label",children:[R("description"),":"]}),(0,u.jsx)("textarea",{className:"form-control",...D("description"),name:"description",label:"Description",defaultValue:q[0]?q[0].description:""})]}),!P("location")&&(0,u.jsx)(b.A,{errorName:E.location}),(0,u.jsx)("div",{style:{width:"100%",display:"flex",justifyContent:"center",margin:"2rem 0"},children:(0,u.jsxs)(v.A,{type:"submit",onClick:T(U),children:[" ",R("submit")]})})]})})}),(0,u.jsx)("div",{className:"col-md-9",style:{paddingLeft:"15px"},children:(0,u.jsx)(m,{setValue:L,getValues:P,defaultValues:s,errors:E})})]})]})}},7995:(e,a,s)=>{s.d(a,{LN:()=>c,bx:()=>r,ck:()=>o,mG:()=>t,vo:()=>n});var l=s(77154);const r=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;return(await l.A.get("/geofences?page=".concat(e,"&limit=").concat(a))).data.data},t=async e=>{const{data:a}=await l.A.delete("/geofences/".concat(e));return a},n=async e=>{const{data:a}=await l.A.post("/geofences",e);return a},c=async e=>{const{data:a}=await l.A.get("/geofences/".concat(e));return a},o=async(e,a)=>{const{data:s}=await l.A.patch("/geofences/".concat(e),a);return s}}}]);
//# sourceMappingURL=3619.8fb268d3.chunk.js.map