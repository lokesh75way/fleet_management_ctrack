"use strict";(self.webpackChunkFLEET=self.webpackChunkFLEET||[]).push([[8995],{85539:(e,a,s)=>{s.d(a,{A:()=>i});var n=s(65043),t=s(66948),l=s(2364),r=s(94692),c=s(70579);const i=e=>{let{onChange:a,value:s,customStyles:i,name:o,companyId:d,isDisabled:h,ref:m}=e;const[u,p]=(0,n.useState)([]),[x,b]=(0,n.useState)(s),{page:g}=(0,r.A)();return(0,n.useEffect)((()=>{(async()=>{const e=await(0,t.e3)(void 0,d||void 0),a=e.data.data.map((e=>({value:null===e||void 0===e?void 0:e._id,label:null===e||void 0===e?void 0:e.branchName})));console.log(e.data,"this is Branch data"),console.log(a,"this is Branch options"),p(a)})()}),[]),(0,n.useEffect)((()=>{const e=u.filter((e=>s&&s.includes(e.value)));b(e)}),[s,u]),(0,c.jsx)(l.Ay,{options:u,value:x,onChange:e=>a(e),styles:i,name:o,ref:m,isDisabled:h||!d,isMulti:!0})}},48995:(e,a,s)=>{s.r(a),s.d(a,{default:()=>S});var n=s(65043),t=s(73216),l=s(35475),r=s(9866),c=s(6720),i=s(60184),o=s(51359),d=(s(71232),s(59167),s(10966)),h=s(70579);const m=e=>{let{onConfirmDelete:a,params:s,tempValue:n,tempValue2:t,tableData:r,editDrawerOpen:m,setDataLength:u}=e;var p=r;const{can:x}=(0,d.S)(),b=x("branch","modify"),g=x("branch","delete");"All Companies"!==n&&(p=r.filter((e=>"branch"===e.role&&e.parentCompany===n))),"All Branches"!==t&&(p=r.filter((e=>"branch"===e.role&&e.parentBranch===t)));for(var j=[],f=0;f<p.length;f++){const e=p[f].userName;j[f]=p.filter((a=>a.parentBranch===e)).length}return(0,h.jsx)(h.Fragment,{children:p.map(((e,s)=>{var n,t,r,d,u,p;return(0,h.jsxs)("tr",{children:[(0,h.jsx)("td",{children:(0,h.jsx)("span",{children:s+1})}),(0,h.jsx)("td",{children:(0,h.jsx)("span",{className:"text-primary",children:e.branchName})}),(0,h.jsx)("td",{children:(0,h.jsx)("span",{children:null!==(n=e.parentBranchId)&&void 0!==n&&n.branchName?null===(t=e.parentBranchId)||void 0===t?void 0:t.branchName:(0,h.jsx)("span",{className:"ps-4",children:"-"})})}),(0,h.jsx)("td",{children:(0,h.jsx)("span",{children:null!==(r=e.companyId)&&void 0!==r&&r.companyName?null===(d=e.companyId)||void 0===d?void 0:d.companyName:(0,h.jsx)("span",{className:"ps-4",children:"-"})})}),(0,h.jsx)("td",{children:(0,h.jsx)("span",{children:null!==(u=e.businessGroupId)&&void 0!==u&&u.groupName?null===(p=e.businessGroupId)||void 0===p?void 0:p.groupName:(0,h.jsx)("span",{className:"ps-4",children:"-"})})}),(0,h.jsx)("td",{children:(0,h.jsx)("span",{children:e.city})}),(0,h.jsx)("td",{children:(0,h.jsx)(l.N_,{to:"/branch/bid/".concat(e.id),className:"text-primary badge light border-0 badge-count",children:j[s]})}),(b||g)&&(0,h.jsx)("td",{children:(0,h.jsxs)("span",{className:"d-flex justify-content-center",children:[b&&(0,h.jsx)("span",{className:"cursor-pointer",onClick:()=>m(e._id),children:(0,h.jsx)(i.uO9,{style:{color:"green",fontSize:"1.2rem"}})}),g&&(0,h.jsx)(o.A,{className:"cursor-pointer ",onConfirmDelete:a,id:e._id,children:(0,h.jsx)(c.b6i,{style:{color:"red",fontSize:"1.2rem"}})})]})})]},s)}))})};var u=s(24858),p=(s(55229),s(74117)),x=s(58387),b=s(33723),g=s(66948),j=s(42457),f=s(94692),v=s(12954),N=s(85539),y=s(272);s(83700);const S=()=>{const{isRtl:e}=(0,n.useContext)(b.D),a=(0,x.$)({"fa-solid fa-angle-right":e,"fa-solid fa-angle-left":!e}),s=(0,x.$)({"fa-solid fa-angle-left":e,"fa-solid fa-angle-right":!e}),{can:c,setUserPermission:i}=(0,d.S)(),{t:o}=(0,p.Bd)(),S=(0,t.Zp)(),[C,_]=((0,t.g)(),(0,n.useState)({value:"All Companies",label:"All Companies"})),[B,I]=(0,n.useState)({value:"All Branches",label:"All Branches"}),[w,D]=(0,n.useState)("All Companies"),[A,k]=(0,n.useState)("All Branches"),[E,T]=(0,n.useState)(document.querySelectorAll("#employee-tbl_wrapper tbody tr")),V={control:e=>({...e,marginRight:"1rem",marginLeft:"1rem",width:"15rem",height:"0.6rem",menuPortal:e=>({...e,zIndex:9999}),menu:e=>({...e,zIndex:9999})})},O=localStorage.getItem("loginDetails-name"),P=localStorage.getItem("role"),{control:J,setValue:z,getValues:F,watch:G}=(0,u.mN)(),L=JSON.parse(localStorage.getItem("userJsonData")).filter((e=>"branch"===e.role)),[q,M]=(0,n.useState)(null),[R,$]=(0,n.useState)([]),[H,U]=(0,n.useState)({id:0,reseller:"",contact:0,username:"",status:"",location:"",usergroup:"",branches:0}),[Z,K]=(0,n.useState)([]),[Q,W]=(0,n.useState)([]),[X,Y]=(0,n.useState)(null),{page:ee,nextPage:ae,prevPage:se,goToPage:ne,setCount:te,totalCount:le,setPage:re}=((0,y.Bc)(),(0,f.A)()),ce=async(e,a)=>{try{var s;console.log({id:a});const{data:n,success:t}=await(0,g.e3)(e,a),l=JSON.parse(localStorage.getItem("permission"));i(null===l||void 0===l||null===(s=l[0])||void 0===s?void 0:s.permission),$(n.data),te(n.totalCount),W(n.data)}catch(n){console.log("Error in fetching data",n)}};(0,n.useEffect)((()=>{ce(ee)}),[ee]);const ie=Q.filter((e=>X&&e.companyId._id===X.value));console.log({filteredBranches:ie});ie.map((e=>({value:e._id,label:e.branchName}))),JSON.parse(localStorage.getItem("userJsonData"));return(0,n.useEffect)((()=>{if("admin"!==P)if("businessgroup"===P){const e=L.filter((e=>e.parentBusinessGroup===O));$(e)}else if("company"===P){const e=L.filter((e=>e.parentCompany===O));$(e)}}),[O,P,L]),(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(r.A,{mainTitle:"Branch",pageTitle:"Branch",parentTitle:"Home"}),(0,h.jsx)("div",{className:"container-fluid",children:(0,h.jsx)("div",{className:"row",children:(0,h.jsx)("div",{className:"col-xl-12",children:(0,h.jsx)("div",{className:"card",children:(0,h.jsx)("div",{className:"card-body p-0",children:(0,h.jsxs)("div",{className:"table-responsive active-projects style-1 ItemsCheckboxSec shorting",children:[(0,h.jsxs)("div",{className:"tbl-caption d-flex justify-content-between text-wrap align-items-center",children:[(0,h.jsx)("h4",{className:"heading mb-0",children:o("branches")}),(0,h.jsxs)("div",{className:"d-flex align-items-center",children:[(0,h.jsx)(u.xI,{name:"company",control:J,rules:{required:!0},render:e=>{let{field:{onChange:a,value:s,name:n,ref:t}}=e;return(0,h.jsx)(v.A,{onChange:async e=>{var a;z("company",e.value),M(e.value),a=e,console.log("Selected branch:",a.value),_(a),re(1),ce(1,a.value)},value:s,customStyles:V,name:n,ref:t,isDisabled:!1})}}),(0,h.jsx)(u.xI,{name:"parent",control:J,rules:{required:!0},render:e=>{let{field:{onChange:a,value:s,name:n,ref:t}}=e;return(0,h.jsx)(N.A,{onChange:e=>{const a=e.map((e=>e.value));z("parent",a),z("branchIds",a)},companyId:q,value:s,customStyles:V,ref:t,name:n,isDisabled:!1},q)}}),c("branch","add")&&(0,h.jsxs)(l.N_,{to:"/branch/create",className:"btn btn-primary btn-sm ms-1",style:{paddingBlock:"9px"},"data-bs-toggle":"offcanvas",children:["+ ",o("addBranch")]})," "]})]}),(0,h.jsxs)("div",{id:"employee-tbl_wrapper",className:"dataTables_wrapper no-footer",children:[(0,h.jsxs)("table",{id:"empoloyees-tblwrapper",className:"table ItemsCheckboxSec dataTable no-footer mb-0",children:[(0,h.jsx)("thead",{children:(0,h.jsxs)("tr",{children:[(0,h.jsx)("th",{children:o("id")}),(0,h.jsx)("th",{children:o("branchName")}),(0,h.jsx)("th",{children:o("parentBranch")}),(0,h.jsx)("th",{children:o("companyName")}),(0,h.jsx)("th",{children:o("businessGroup")}),(0,h.jsx)("th",{children:o("location")}),(0,h.jsx)("th",{children:o("childBranches")}),(c("branch","modify")||c("branch","delete"))&&(0,h.jsx)("th",{children:o("action")})]})}),(0,h.jsx)("tbody",{children:(0,h.jsx)(m,{tempValue:w,tempValue2:A,editData:H,tableData:R,onConfirmDelete:async e=>{await(0,g.SN)(e),(0,j.V)("Branch Deleted"),await ce()},editDrawerOpen:e=>{const a=R.filter((a=>a._id===e));S("edit/".concat(e),{state:a})},setEditData:U},R)})]}),(0,h.jsxs)("div",{className:"d-sm-flex text-center justify-content-between align-items-center",children:[(0,h.jsxs)("div",{className:"dataTables_info",children:[o("showing")," ",10*(ee-1)+1," ",o("to")," ",Math.min(10*ee,le)," ",o("of")," ",le," ",o("entries")]}),(0,h.jsxs)("div",{className:"dataTables_paginate paging_simple_numbers",id:"example2_paginate",children:[(0,h.jsx)(l.N_,{className:"paginate_button ".concat(1===ee?"previous disabled":"previous"),to:"/branch",onClick:()=>se(ee-1),children:(0,h.jsx)("i",{className:a})}),(0,h.jsx)("span",{children:[...Array(Math.ceil(le/10)).keys()].map((e=>(0,h.jsx)(l.N_,{className:"paginate_button ".concat(ee===e+1?"current":""),onClick:()=>ne(e+1),children:e+1},e)))}),(0,h.jsx)(l.N_,{className:"paginate_button ".concat(10*ee>=le?"next disabled":"next"),to:"/branch",onClick:()=>ae(ee+1),children:(0,h.jsx)("i",{className:s})})]})]})]})]})})})})})})]})}}}]);
//# sourceMappingURL=8995.9ed933bb.chunk.js.map