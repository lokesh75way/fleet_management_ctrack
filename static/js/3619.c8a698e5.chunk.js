"use strict";(self.webpackChunkFLEET=self.webpackChunkFLEET||[]).push([[3619],{23619:(e,a,s)=>{s.r(a),s.d(a,{default:()=>S});var l=s(65043),r=s(2364),t=s(99419),n=s(12023),c=s(76036),o=s(13318),d=s(62559),i=s(15560),u=s(70579);const m=e=>{var a,s;let{geofenceHanlder:r,setValue:m,watch:x,getValues:h,errors:g}=e;const[p,f]=l.useState({type:"FeatureCollection",features:[]}),v=null!==(a=null===(s=x("location"))||void 0===s?void 0:s.length)&&void 0!==a?a:0;return(0,u.jsx)("div",{style:{display:"flex",height:"85vh",border:g.location?"3px solid #ff5e5e":null},children:(0,u.jsx)("div",{style:{width:"100%"},children:(0,u.jsxs)(t.W,{center:[25.2233,55.2869],zoom:14,zoomControl:!1,children:[(0,u.jsx)(n.e,{attribution:'\xa9 <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"http://{s}.tile.osm.org/{z}/{x}/{y}.png"}),(0,u.jsxs)(c.p,{styles:{background:"red"},position:[25.2233,55.2869],children:[(0,u.jsx)(o.z,{children:"Dubai Trade Center"}),(0,u.jsx)(d.m,{children:"Dubai Trade Center"})]}),(0,u.jsx)(i.A,{setValues:m,geofenceHanlder:r,watch:x,getValues:h},v)]})})})};var x=s(69367),h=s(24858),g=s(18403),p=s(87742),f=s(15075),v=s(14282),b=s(23764),j=s(42457),N=s(73216),y=s(7995),A=s(74117),C=s(12954);const S=()=>{const[e,a]=(0,l.useState)(null),[s,t]=(0,l.useState)(),[n,c]=(0,l.useState)(),[o,d]=(0,l.useState)(null),i=(0,N.Zp)(),{id:S}=(0,N.g)(),[I,w]=(0,l.useState)(),[k,V]=(0,l.useState)(!1),F=JSON.parse(localStorage.getItem("userDetails")),D={control:e=>({...e,padding:".25rem 0 "})};(0,l.useEffect)((()=>{"COMPANY"===F.user.role&&(L("businessGroupId",null===F||void 0===F?void 0:F.user.businessGroupId),d(null===F||void 0===F?void 0:F.user.businessGroupId),L("companyId",null===F||void 0===F?void 0:F.user.companyId),w(null===F||void 0===F?void 0:F.user.companyId),V(!0)),"BUSINESS_GROUP"===F.user.role&&(L("businessGroupId",null===F||void 0===F?void 0:F.user.businessGroupId),d(null===F||void 0===F?void 0:F.user.businessGroupId)),S&&(async()=>{if(S){const{data:e}=await(0,y.LN)(S);t(e),U(e),a(e.geofenceAccess)}})()}),[S]);const{register:G,formState:{errors:E},setValue:L,watch:O,getValues:P,control:T,handleSubmit:z,reset:U}=(0,h.mN)({resolver:(0,g.t)(p._8),defaultValues:{category:f.rF[0].value,tolerance:f.gY[0].value}}),B=e=>{a(e.target.value),L("geofenceAccess",e.target.value)},q=async e=>{try{if(S){const{success:a}=await(0,y.ck)(S,e);return void(a&&((0,j.V)("Geofence updated successfully!"),i("/settings/geofence")))}{const{success:a}=await(0,y.vo)(e);return void(a&&((0,j.V)("New Geofence Created!"),i("/settings/geofence")))}}catch(a){return console.log(a),void(0,j.U)("Some error occured !!")}},M=JSON.parse(localStorage.getItem("geofenceData")).filter((e=>e.id==S)),[R,Y]=(0,l.useState)(M),{t:H}=(0,A.Bd)();return(0,u.jsxs)("div",{children:[(0,u.jsx)("div",{style:{padding:"10px",backgroundColor:"#FFFDFD"},children:(0,u.jsxs)("h2",{style:{fontSize:"20px"},children:[H("geofenceDetail"),"l"]})}),(0,u.jsxs)("div",{className:"",style:{display:"flex",height:"88vh"},children:[(0,u.jsx)("div",{className:"col-md-3",style:{padding:"15px",boxShadow:"9px 0 4px rgba(0, 0, 0, 0.1)",backgroundColor:"#fff",overflow:"auto"},children:(0,u.jsx)(h.Op,{children:(0,u.jsxs)("form",{onSubmit:z(q),children:[(0,u.jsxs)("div",{className:"mb-2",children:[(0,u.jsxs)("label",{htmlFor:"company",className:"form-label",children:[H("company"),":",(0,u.jsx)("span",{className:"text-danger",children:"*"})]}),(0,u.jsx)(h.xI,{name:"company",control:T,rules:{required:!0},render:e=>{let{field:{onChange:a,value:s,name:l,ref:r}}=e;return(0,u.jsx)(C.A,{groupId:o,onChange:e=>{L("company",e.value),L("companyName",e.value),w(e.value)},value:s,customStyles:D,ref:r,isDisabled:k,name:l},o)}}),(0,u.jsx)(b.A,{errorName:E.company})]}),(0,u.jsxs)("div",{className:"mb-2",children:[(0,u.jsxs)("label",{htmlFor:"company",className:"form-label",children:[H("name"),":",(0,u.jsx)("span",{className:"text-danger",children:"*"})]}),(0,u.jsx)(x.A,{type:"text",label:"Name",register:G,name:"name",defaultValue:R[0]?R[0].name:""}),(0,u.jsx)(b.A,{errorName:E.name})]}),(0,u.jsxs)("div",{className:"mb-3",children:[(0,u.jsxs)("label",{className:"form-label",children:[H("category"),":",(0,u.jsx)("span",{className:"text-danger",children:"*"})]}),(0,u.jsx)(h.xI,{name:"category",control:T,rules:{required:!0},render:e=>{let{field:{onChange:a,value:s,name:l,ref:t}}=e;return(0,u.jsx)(r.Ay,{onChange:e=>{c(e.value),L("category",e.value)},options:f.rF,ref:t,name:l,styles:D,value:{value:s,label:s}})}}),!P("category")&&(0,u.jsx)(b.A,{errorName:E.category})]}),(0,u.jsxs)("div",{className:"mb-3",children:[(0,u.jsxs)("label",{className:"form-label",children:[H("geofenceAccess"),":",(0,u.jsx)("span",{className:"text-danger",children:"*"})]}),(0,u.jsxs)("div",{style:{display:"flex",flexDirection:"row",gap:"5rem"},children:[(0,u.jsxs)("div",{className:"form-check",children:[(0,u.jsx)("input",{type:"radio",className:"form-check-input",value:"PUBLIC",checked:"PUBLIC"===e,onChange:B}),(0,u.jsx)("label",{className:"form-check-label",children:H("public")})]}),(0,u.jsxs)("div",{className:"form-check",children:[(0,u.jsx)("input",{type:"radio",className:"form-check-input",value:"PRIVATE",checked:"PRIVATE"===e,onChange:B}),(0,u.jsx)("label",{className:"form-check-label",children:H("private")})]})]}),!P("geofenceAccess")&&(0,u.jsx)(b.A,{errorName:E.geofenceAccess})]}),(0,u.jsxs)("div",{className:"mb-3",children:[(0,u.jsxs)("label",{htmlFor:"contactNumber",className:"form-label",children:[H("contactNumber"),":",(0,u.jsx)("span",{className:"text-danger",children:"*"})]}),(0,u.jsx)(x.A,{type:"number",register:G,label:"Contact Number",name:"contactNumber",min:"0",onInput:e=>{const a=Math.max(0,e.target.value);e.target.value=a<1?"":a},defaultValue:R[0]?R[0].contactNumber:""}),(0,u.jsx)(b.A,{errorName:E.contactNumber})]}),(0,u.jsxs)("div",{className:"mb-3",children:[(0,u.jsxs)("label",{htmlFor:"address",className:"form-label",children:[H("address"),":"]}),(0,u.jsx)("textarea",{className:"form-control",...G("address"),label:"Address",name:"address",defaultValue:R[0]?R[0].address:""})]}),(0,u.jsxs)("div",{className:"mb-3",children:[(0,u.jsxs)("label",{className:"form-label",children:[H("tolerance"),":",(0,u.jsx)("span",{className:"text-danger",children:"*"})]}),(0,u.jsx)(h.xI,{name:"tolerance",control:T,rules:{required:!0},render:e=>{let{field:{onChange:a,value:s,name:l,ref:t}}=e;return(0,u.jsx)(r.Ay,{onChange:e=>{c(e.value),L("tolerance",e.value)},options:f.gY,ref:t,name:l,styles:D,value:{label:s,value:s}})}}),!P("tolerance")&&(0,u.jsx)(b.A,{errorName:E.tolerance})]}),(0,u.jsxs)("div",{className:"mb-3",children:[(0,u.jsxs)("label",{className:"form-label",children:[H("description"),":"]}),(0,u.jsx)("textarea",{className:"form-control",...G("description"),name:"description",label:"Description",defaultValue:R[0]?R[0].description:""})]}),!P("location")&&(0,u.jsx)(b.A,{errorName:E.location}),(0,u.jsx)("div",{style:{width:"100%",display:"flex",justifyContent:"center",margin:"2rem 0"},children:(0,u.jsxs)(v.A,{type:"submit",onClick:z(q),children:[" ",H("submit")]})})]})})}),(0,u.jsx)("div",{className:"col-md-9",style:{paddingLeft:"15px"},children:(0,u.jsx)(m,{setValue:L,watch:O,getValues:P,defaultValues:s,errors:E})})]})]})}},7995:(e,a,s)=>{s.d(a,{LN:()=>c,bx:()=>r,ck:()=>o,mG:()=>t,vo:()=>n});var l=s(77154);const r=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;return(await l.A.get("/geofences?page=".concat(e,"&limit=").concat(a))).data.data},t=async e=>{const{data:a}=await l.A.delete("/geofences/".concat(e));return a},n=async e=>{const{data:a}=await l.A.post("/geofences",e);return a},c=async e=>{const{data:a}=await l.A.get("/geofences/".concat(e));return a},o=async(e,a)=>{const{data:s}=await l.A.patch("/geofences/".concat(e),a);return s}}}]);
//# sourceMappingURL=3619.c8a698e5.chunk.js.map