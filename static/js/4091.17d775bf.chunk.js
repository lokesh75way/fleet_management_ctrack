"use strict";(self.webpackChunkFLEET=self.webpackChunkFLEET||[]).push([[4091],{61613:(e,s,t)=>{t.d(s,{A:()=>i});var a=t(78109),n=t(74563),r=t(7695),l=t(47337);const i=e=>{let{onChange:s,value:t,customStyles:i,ref:c,isDisabled:d,name:o}=e;const[m,h]=(0,a.useState)([]),[x,j]=(0,a.useState)(t);return(0,a.useEffect)((()=>{(async()=>{const e=(await(0,r.K$)()).data.map((e=>({label:null===e||void 0===e?void 0:e.firstName,value:null===e||void 0===e?void 0:e._id})));h(e)})()}),[]),(0,a.useEffect)((()=>{const e=m.find((e=>e.value===t));j(e)}),[t,m]),(0,l.jsx)(n.Ay,{options:m,value:x,onChange:e=>s(e),styles:i,ref:c,name:o})}},4091:(e,s,t)=>{t.r(s),t.d(s,{default:()=>P});var a=t(78109),n=t(67236),r=t(78292),l=(t(7618),t(35145),t(32343)),i=(t(16236),t(86554)),c=t(53252),d=t(44988),o=t(36145),m=t(93576),h=t(15985),x=t(70529),j=t(27515),p=t(25255),u=t(32449),f=t(87321),v=t(38686),g=t.n(v),b=t(47337);const N=e=>{let{tableData:s,onConfirmDelete:t,editDrawerOpen:a,active:n,currentPage:l,itemsPerPage:i}=e;const c=e=>g()(e).format("YYYY-MM-DD HH:MM");return(0,b.jsx)(b.Fragment,{children:s.map(((e,s)=>(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{children:(0,b.jsx)("span",{children:e._id})}),(0,b.jsx)("td",{children:(0,b.jsx)("span",{children:c(e.startTime)})}),(0,b.jsx)("td",{children:(0,b.jsx)("span",{children:e.startLocation})}),(0,b.jsx)("td",{children:(0,b.jsx)("span",{children:c(e.reachTime)})}),(0,b.jsx)("td",{children:(0,b.jsx)("span",{children:e.reachLocation})}),(0,b.jsx)("td",{children:(0,b.jsx)("span",{className:"text-primary",children:e.distance})}),(0,b.jsx)("td",{children:(0,b.jsx)("span",{children:e.fuelConsumption})}),(0,b.jsx)("td",{children:(0,b.jsx)("span",{children:e.driver})}),(0,b.jsx)("td",{children:(0,b.jsxs)("span",{className:"d-flex justify-content-center",children:[n&&(0,b.jsx)("span",{className:"cursor-pointer",title:"tracking",children:(0,b.jsx)(r.N_,{to:`/vehicle-tracking/${e.tripId}`,children:(0,b.jsx)(f.sIY,{style:{color:"#ff9f00",fontSize:"18px"}})})}),(0,b.jsx)("span",{className:"cursor-pointer",style:{marginRight:"3px",marginLeft:"7px"},onClick:()=>a(e._id),children:(0,b.jsx)(p.uO9,{style:{color:"green",fontSize:"1.2rem"}})}),(0,b.jsx)(u.A,{className:"cursor-pointer ",onConfirmDelete:t,id:e._id,children:(0,b.jsx)(j.b6i,{style:{color:"red",fontSize:"1.2rem"}})})]})})]},s)))})};var y=t(35651),C=t(97804),T=t(34571),S=(t(43157),t(71980)),D=t(72555);const w=e=>{let{tableData1:s,tabType:t}=e;const[r,l]=(0,a.useState)(s),[o,m]=(0,a.useState)(!1);(0,a.useEffect)((()=>{l(s)}),[s]);const{register:j,setValue:p,getValues:u,handleSubmit:f,formState:{errors:v},control:g}=(0,i.mN)({resolver:(0,c.t)(d.M0)}),[w,A]=(0,a.useState)({id:0,status:"",title:"",contact:0,age:0,drivingExperience:0,gender:"",location:""}),{isRtl:_}=(0,a.useContext)(y.D),{t:E}=(0,T.Bd)(),I=(0,n.Zp)(),{page:k,nextPage:P,prevPage:L,goToPage:$,setCount:M,totalCount:O,setPage:V}=(0,C.A)();(0,a.useEffect)((()=>{let e="";"Active Trips"===t?e="ONGOING":"Planned Trips"===t?e="JUST_STARTED":"Completed Trips"===t&&(e="COMPLETED"),R(e)}),[t,k]);const R=async e=>{try{m(!0);const{data:s,success:t,totalLength:a}=await(0,h.nH)(k,e);l(s),M(a)}catch(s){console.log("Error",s)}finally{m(!1)}};(0,a.useRef)(),(0,a.useRef)();return console.log(r),(0,b.jsx)("div",{className:"container-fluid",children:(0,b.jsx)("div",{className:"row",children:(0,b.jsx)("div",{className:"col-xl-12",children:(0,b.jsx)("div",{className:"card",children:(0,b.jsx)("div",{className:"card-body p-0",children:(0,b.jsx)("div",{className:"table-responsive active-projects style-1 ItemsCheckboxSec shorting",children:(0,b.jsxs)("div",{id:"employee-tbl_wrapper",className:"dataTables_wrapper no-footer",children:[!r.length&&o?(0,b.jsx)(D.A,{}):(0,b.jsxs)("table",{id:"empoloyees-tblwrapper",className:"table ItemsCheckboxSec dataTable no-footer mb-0",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{children:E("tripId")}),(0,b.jsx)("th",{children:E("startTime")}),(0,b.jsx)("th",{children:E("startLocation")}),(0,b.jsx)("th",{children:E("reachTime")}),(0,b.jsx)("th",{children:E("reachLocation")}),(0,b.jsx)("th",{children:E("distance")}),(0,b.jsx)("th",{children:E("fuelConsumption")}),(0,b.jsx)("th",{children:E("driver")}),(0,b.jsx)("th",{children:E("action")})]})}),(0,b.jsx)("tbody",{children:(0,b.jsx)(N,{active:!0,editData:w,tableData:r,onConfirmDelete:async e=>{await(0,h.BG)(e),l((s=>s.filter((s=>s._id!==e)))),(0,x.V)("Trip Deleted")},editDrawerOpen:e=>{const s=r.filter((s=>s._id===e));I(`edit/${e}`,{state:s})},setEditData:A,currentPage:k,itemsPerPage:10})})]}),(0,b.jsxs)("div",{className:"d-sm-flex text-center justify-content-between align-items-center",children:[(0,b.jsxs)("div",{className:"dataTables_info",children:[E("showing")," ",10*(k-1)+1," ",E("to")," ",Math.min(10*k,O)," ",E("of")," ",O," ",E("entries")]}),(0,b.jsx)("div",{className:"dataTables_paginate paging_simple_numbers",id:"example2_paginate",children:(0,b.jsx)(S.A,{totalCount:O,itemsPerPage:10,handlePageClick:e=>{let{selected:s}=e;$(s+1)}})})]})]})})})})})})})};t(7804);var A=t(85129),_=t(75889),E=t.n(_),I=(t(1682),t(75542),t(20460),t(91197),t(61613));const k=(0,a.forwardRef)(((e,s)=>{let{Title:t,filterData:r}=e;const[l,o]=(0,a.useState)(!1),[m,x]=(0,a.useState)();(0,a.useImperativeHandle)(s,(()=>({showModal(){o(!0)}})));(0,n.Zp)();const j={control:e=>({...e,padding:".25rem 0 "})},{register:p,handleSubmit:u,setValue:f,getValues:v,control:g,formState:{errors:N}}=(0,i.mN)({resolver:(0,c.t)(d.$q)});return(0,b.jsx)(b.Fragment,{children:(0,b.jsxs)(A.A,{show:l,onHide:o,className:"offcanvas-end customeoff classy_filter",placement:"end",children:[(0,b.jsxs)("div",{className:"offcanvas-header",children:[(0,b.jsx)("h5",{className:"modal-title",id:"#gridSystemModal",children:t}),(0,b.jsx)("button",{type:"button",className:"btn-close",onClick:()=>o(!1),children:(0,b.jsx)("i",{className:"fa-solid fa-xmark"})})]}),(0,b.jsx)("div",{className:"offcanvas-body",children:(0,b.jsx)("div",{className:"container-fluid",children:(0,b.jsx)(i.Op,{children:(0,b.jsx)("form",{onSubmit:u((async e=>{const{driverId:s,startDate:t,endDate:a}=e,n=new Date(t),l=new Date(a);if(isNaN(n.getTime())||isNaN(l.getTime()))console.error("Invalid startDate or endDate");else{const e=n.toISOString(),t=l.toISOString(),{data:a}=await(0,h.nH)(void 0,void 0,s,e,t);r(a)}})),children:(0,b.jsxs)("div",{className:"container",children:[(0,b.jsxs)("div",{className:"row ",children:[(0,b.jsxs)("div",{className:"col-xl-12 mb-3 ",children:[(0,b.jsx)("label",{className:"form-label",children:"Driver"}),(0,b.jsx)(i.xI,{name:"driverId",control:g,render:e=>{let{field:{onChange:s,value:t,name:a,ref:n}}=e;return(0,b.jsx)(I.A,{onChange:e=>{f("driverId",e.value)},value:t,customStyles:j,ref:n,name:a})}})]}),(0,b.jsxs)("div",{className:"col-xl-12 mb-3 d-flex flex-column",children:[(0,b.jsx)("label",{className:"form-label",children:"Start Date"}),(0,b.jsx)(i.xI,{name:"startDate",control:g,render:e=>{let{field:s}=e;return(0,b.jsx)(E(),{selected:s.value,className:"form-control",onChange:e=>s.onChange(e)})}})]}),(0,b.jsxs)("div",{className:"col-xl-12 mb-3 d-flex flex-column",children:[(0,b.jsx)("label",{className:"form-label",children:"End Date"}),(0,b.jsx)(i.xI,{name:"endDate",control:g,render:e=>{let{field:s}=e;return(0,b.jsx)(E(),{selected:s.value,className:"form-control",onChange:e=>s.onChange(e)})}})]})]}),(0,b.jsx)("div",{className:"row",children:(0,b.jsx)("div",{className:"col-12",children:(0,b.jsx)("div",{className:"mb-4",children:(0,b.jsx)("button",{type:"submit",onClick:()=>o(!1),className:"btn btn-primary me-4 w-100",children:"Apply"})})})})]})})})})})]})})})),P=e=>{const{t:s}=(0,T.Bd)(),t=[s("activeTrips"),s("plannedTrips"),s("completedTrips")],j=[w,w,w],[p,u]=(0,a.useState)([]),{register:f,setValue:v,getValues:g,handleSubmit:N,clearErrors:y,formState:{errors:C},control:S}=(0,i.mN)({resolver:(0,c.t)(d.M0)}),[D,A]=(0,a.useState)({id:0,status:"",title:"",contact:0,age:0,drivingExperience:0,gender:"",location:""}),_=(0,n.Zp)(),E=((0,a.useRef)(),(0,a.useRef)()),I=async e=>{try{await(0,h.C$)(e),(0,x.V)("New Trip Created!"),_("/settings/classifyTrips")}catch(s){console.log("Error",s)}},[P,L]=(0,a.useState)(0);return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(l.A,{mainTitle:s("classifyTrip"),pageTitle:s("classifyTrip"),parentTitle:s("settings")}),(0,b.jsx)("div",{className:"m-2 p-2 classify_trip-container",children:(0,b.jsx)(i.Op,{children:(0,b.jsxs)("form",{onSubmit:N(I),children:[(0,b.jsxs)(o.A.Container,{defaultActiveKey:t[0].toLowerCase(),children:[(0,b.jsxs)(m.A,{as:"ul",className:"nav-tabs classify-trips",children:[(0,b.jsx)("div",{children:t.map(((e,s)=>(0,b.jsx)(m.A.Item,{as:"li",children:(0,b.jsx)(m.A.Link,{style:{padding:".5rem 2rem"},eventKey:e.toLowerCase(),active:s===P,onClick:()=>L(s),children:e})},s)))}),(0,b.jsxs)("div",{className:"",children:[(0,b.jsxs)(r.N_,{to:"#",className:"btn btn-primary btn-sm ms-1","data-bs-toggle":"offcanvas",onClick:()=>E.current.showModal(),children:["+ ",s("filter")]})," ",(0,b.jsxs)(r.N_,{to:"/settings/classifyTrips/create",className:"btn btn-primary btn-sm ms-1","data-bs-toggle":"offcanvas",children:["+ ",s("addTrips")]})," "]})]}),(0,b.jsx)(o.A.Content,{className:"pt-4",children:t.map(((e,s)=>{const a=j[s];return(0,b.jsx)(o.A.Pane,{eventKey:e.toLowerCase(),active:s===P,children:(0,b.jsx)(a,{tableData1:p,data:t,control:S,setValue:v,register:f,getValues:g,tableData:!0,errors:C,handleSubmit:N,onSubmit:I,tabType:e})},s)}))})]}),(0,b.jsx)(k,{ref:E,Title:"Add Filter",filterData:e=>{u(e)}})]})})})]})}},15985:(e,s,t)=>{t.d(s,{BG:()=>i,C$:()=>r,nH:()=>n,pj:()=>l});var a=t(74763);(0,t(95441).A)();const n=async function(){let e=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0,t=arguments.length>4?arguments[4]:void 0,n=`/trips?page=${arguments.length>0&&void 0!==arguments[0]?arguments[0]:1}&limit=10`;n+=e&&s&&t?`&driverId=${e}&start=${s}&end=${t}`:`&status=${arguments.length>1?arguments[1]:void 0}`;const r=await a.A.get(n);return{data:r.data.data.data,totalLength:r.data.data.count}},r=async e=>a.A.post("/trips",e),l=async(e,s)=>a.A.patch(`/trips/${e}`,s),i=async e=>a.A.delete(`/trips/${e}`)}}]);
//# sourceMappingURL=4091.17d775bf.chunk.js.map